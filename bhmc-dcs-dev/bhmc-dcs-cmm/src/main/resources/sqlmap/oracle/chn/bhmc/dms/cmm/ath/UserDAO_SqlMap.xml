<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : UserDao_SqlMap.xml
    Description : 사용자계정에 관한 데이터처리
    author Kang Seok Han
    since 2015. 12. 30.
    version 1.0
    Modification Information
       since          author              description
    ===========    =============    ===========================
    2016. 01. 05.     Kang Seok Han     최초 생성
-->

<mapper namespace="chn.bhmc.dms.cmm.ath.service.dao.UserDAO">

    <!-- 사용자계정 정보를 등록한다. -->
    <insert id="insertUser" parameterType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.insertUser] */
        INSERT INTO CM_0801T(
             USR_ID
            ,USR_NM
            ,USR_PW
            ,ENABLED_YN
            ,LANG_CD
            ,EMP_NO
            ,DEL_YN
            ,THEME_ID
            ,REG_USR_ID
            ,REG_DT
            ,UPDT_USR_ID
            ,UPDT_DT
            ,CMPN_ID
            ,DLR_CD
            ,DEPT_CD
            ,PSTN_CD
            ,DUTY_CD
            ,TSK_CD
            ,EMAIL
            ,HP_NO
            ,TEL_NO1
            ,USR_PWD_CHG_DT
            ,USR_ID_NO
            ,JOIN_DT
            ,RETIRE_DT
            ,ZIP_NO
            ,ADDR1
            ,ADDR2
            ,ADDR3
            ,BIZ_CD
            ,SERV_YN
            ,SALE_YN
            ,CORP_CD
            ,TEL_NO2
            ,CLAIM_REQ_PERM_YN
            ,BIRTHDAY
            ,GNDR_CD
            ,TSK_DETL
            ,DSS_USR_YN
        )VALUES(
             #{usrId}
            ,#{usrNm}
            ,#{usrPw}
            ,#{enabledYn}
            ,#{langCd}
            ,#{empNo}
            ,#{delYn}
            ,#{themeId}
            ,#{regUsrId}
            ,SYSDATE
            ,#{updtUsrId}
            ,SYSDATE
            ,#{cmpnId}
            ,#{dlrCd}
            ,#{deptCd}
            ,#{pstnCd}
            ,#{dutyCd}
            ,#{tskCd}
            ,#{email}
            ,#{hpNo}
            ,#{telNo1}
            ,#{usrPwdChgDt}
            ,#{usrIdNo}
            ,#{joinDt}
            ,#{retireDt}
            ,#{zipNo}
            ,#{addr1}
            ,#{addr2}
            ,#{addr3}
            ,#{bizCd}
            ,#{servYn}
            ,#{saleYn}
            ,#{corpCd}
            ,#{telNo2}
            ,#{claimReqPermYn}
            ,#{birthday}
            ,#{gndrCd}
            ,#{tskDetl}
            ,#{dssUsrYn}
        )
    </insert>

	<!-- 사용자계정 정보를 수정한다. -->
	<update id="updateUser" parameterType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.updateUser] */
		UPDATE CM_0801T SET
             USR_NM = #{usrNm}
            <if test='usrPw != null and usrPw != ""'>
            ,USR_PW = #{usrPw}
            </if>
            ,ENABLED_YN = #{enabledYn}
            ,LANG_CD = #{langCd}
            ,EMP_NO = #{empNo}
            ,DEL_YN = #{delYn}
            ,THEME_ID = #{themeId}
            ,UPDT_USR_ID = #{updtUsrId}
            ,UPDT_DT = SYSDATE
            ,CMPN_ID = #{cmpnId}
            ,DLR_CD = #{dlrCd}
            ,DEPT_CD = #{deptCd}
            ,PSTN_CD = #{pstnCd}
            ,DUTY_CD = #{dutyCd}
            ,TSK_CD = #{tskCd}
            ,EMAIL = #{email}
            ,HP_NO = #{hpNo}
            ,TEL_NO1 = #{telNo1}
            ,USR_PWD_CHG_DT = #{usrPwdChgDt}
            ,USR_ID_NO = #{usrIdNo}
            ,JOIN_DT = #{joinDt}
            ,RETIRE_DT = #{retireDt}
            ,ZIP_NO = #{zipNo}
            ,ADDR1 = #{addr1}
            ,ADDR2 = #{addr2}
            ,ADDR3 = #{addr3}
            ,BIZ_CD = #{bizCd}
            ,SERV_YN = #{servYn}
            ,SALE_YN = #{saleYn}
            ,CORP_CD = #{corpCd}
            ,TEL_NO2 = #{telNo2}
            ,CLAIM_REQ_PERM_YN = #{claimReqPermYn}
            ,BIRTHDAY = #{birthday}
            ,GNDR_CD = #{gndrCd}
            ,TSK_DETL = #{tskDetl}
            ,DSS_USR_YN = #{dssUsrYn}
		WHERE USR_ID = #{usrId}
	</update>

    <!-- 사용자계정 정보를 수정한다. -->
    <update id="updateUserIF" parameterType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.updateUserIF] */
        MERGE INTO CM_0801IS T1
    	USING (
	        SELECT
	             USR_ID         	<!-- 사용자ID -->
	            ,USR_NM         	<!-- 사용자명 -->
	            ,USR_PW         	<!-- 사용자비밀번호 -->
	            ,ENABLED_YN     	<!-- 활성여부 -->
	            ,LANG_CD        	<!-- 언어코드 -->
	            ,EMP_NO         	<!-- 사원번호 -->
	            ,DEL_YN         	<!-- 삭제여부 -->
	            ,THEME_ID       	<!-- 테마 -->
	            ,REG_USR_ID     	<!-- 등록자ID -->
	            ,REG_DT         	<!-- 등록일자 -->
	            ,UPDT_USR_ID    	<!-- 수정자ID -->
	            ,UPDT_DT        	<!-- 수정일자 -->
	            ,CMPN_ID        	<!-- 회사구분코드 -->
	            ,DLR_CD         	<!-- 딜러코드 -->
	            ,DEPT_CD        	<!-- 부서코드 -->
	            ,PSTN_CD        	<!-- 직급코드 -->
	            ,DUTY_CD        	<!-- 직책코드 -->
	            ,TSK_CD         	<!-- 직무코드 -->
	            ,EMAIL          	<!-- 이메일명 -->
	            ,HP_NO          	<!-- 휴대폰번호 -->
	            ,TEL_NO1        	<!-- 전화번호1 -->
	            ,USR_PWD_CHG_DT 	<!-- 사용자비밀번호변경일자 -->
	            ,USR_ID_NO      	<!-- 사용자ID번호 -->
	            ,JOIN_DT        	<!-- 입사일자 -->
	            ,RETIRE_DT      	<!-- 퇴사일자 -->
	            ,ZIP_NO         	<!-- 우편번호 -->
	            ,ADDR1          	<!-- 주소1 -->
	            ,ADDR2          	<!-- 주소2 -->
	            ,ADDR3          	<!-- 주소3 -->
	            ,BIZ_CD         	<!-- 담당업무구분코드 -->
	            ,SERV_YN        	<!-- 정비업무여부 -->
	            ,SALE_YN        	<!-- 판매업무여부 -->
	            ,CORP_CD        	<!-- 법인코드 -->
	            ,TEL_NO2        	<!-- 전화번호2 -->
	            ,CLAIM_REQ_PERM_YN	<!-- 클레임신청 권한 여부 -->
                ,BIRTHDAY           <!-- 생일 -->
                ,GNDR_CD            <!-- 성별 -->
                ,TSK_DETL           <!-- 직무상세 -->
	        FROM CM_0801T
	        WHERE USR_ID = #{usrId}
	    ) T2 ON (
	        T1.USR_ID = T2.USR_ID
	    )
	    WHEN MATCHED THEN
	        UPDATE SET
	             T1.USR_NM              = T2.USR_NM
	            ,T1.USR_PW              = T2.USR_PW
	            ,T1.ENABLED_YN          = T2.ENABLED_YN
	            ,T1.LANG_CD             = T2.LANG_CD
	            ,T1.EMP_NO              = T2.EMP_NO
	            ,T1.DEL_YN              = T2.DEL_YN
	            ,T1.THEME_ID            = NVL(T2.THEME_ID, 'default')
	            ,T1.REG_USR_ID          = T2.REG_USR_ID
	            ,T1.REG_DT              = T2.REG_DT
	            ,T1.UPDT_USR_ID         = T2.UPDT_USR_ID
	            ,T1.UPDT_DT             = T2.UPDT_DT
	            ,T1.CMPN_ID             = T2.CMPN_ID
	            ,T1.DLR_CD              = T2.DLR_CD
	            ,T1.DEPT_CD             = T2.DEPT_CD
	            ,T1.PSTN_CD             = T2.PSTN_CD
	            ,T1.DUTY_CD             = T2.DUTY_CD
	            ,T1.TSK_CD              = T2.TSK_CD
	            ,T1.EMAIL               = T2.EMAIL
	            ,T1.HP_NO               = T2.HP_NO
	            ,T1.TEL_NO1             = T2.TEL_NO1
	            ,T1.USR_PWD_CHG_DT      = T2.USR_PWD_CHG_DT
	            ,T1.USR_ID_NO           = T2.USR_ID_NO
	            ,T1.JOIN_DT             = T2.JOIN_DT
	            ,T1.RETIRE_DT           = T2.RETIRE_DT
	            ,T1.ZIP_NO              = T2.ZIP_NO
	            ,T1.ADDR1               = T2.ADDR1
	            ,T1.ADDR2               = T2.ADDR2
	            ,T1.ADDR3               = T2.ADDR3
	            ,T1.BIZ_CD              = T2.BIZ_CD
	            ,T1.SERV_YN             = T2.SERV_YN
	            ,T1.SALE_YN             = T2.SALE_YN
	            ,T1.CORP_CD             = T2.CORP_CD
	            ,T1.TEL_NO2             = T2.TEL_NO2
	            ,T1.CLAIM_REQ_PERM_YN   = T2.CLAIM_REQ_PERM_YN
	            ,T1.BIRTHDAY            = T2.BIRTHDAY
	            ,T1.GNDR_CD             = T2.GNDR_CD
	            ,T1.TSK_DETL            = T2.TSK_DETL
	            ,T1.IFRESULT            = 'N'
	    WHEN NOT MATCHED THEN
	        INSERT(
	             T1.USR_ID
	            ,T1.USR_NM
	            ,T1.USR_PW
	            ,T1.ENABLED_YN
	            ,T1.LANG_CD
	            ,T1.EMP_NO
	            ,T1.DEL_YN
	            ,T1.THEME_ID
	            ,T1.REG_USR_ID
	            ,T1.REG_DT
	            ,T1.UPDT_USR_ID
	            ,T1.UPDT_DT
	            ,T1.CMPN_ID
	            ,T1.DLR_CD
	            ,T1.DEPT_CD
	            ,T1.PSTN_CD
	            ,T1.DUTY_CD
	            ,T1.TSK_CD
	            ,T1.EMAIL
	            ,T1.HP_NO
	            ,T1.TEL_NO1
	            ,T1.USR_PWD_CHG_DT
	            ,T1.USR_ID_NO
	            ,T1.JOIN_DT
	            ,T1.RETIRE_DT
	            ,T1.ZIP_NO
	            ,T1.ADDR1
	            ,T1.ADDR2
	            ,T1.ADDR3
	            ,T1.BIZ_CD
	            ,T1.SERV_YN
	            ,T1.SALE_YN
	            ,T1.CORP_CD
	            ,T1.TEL_NO2
	            ,T1.CLAIM_REQ_PERM_YN
                ,T1.BIRTHDAY
                ,T1.GNDR_CD
                ,T1.TSK_DETL
	            ,T1.IFRESULT
	        )VALUES(
	            T2.USR_ID
	            ,T2.USR_NM
	            ,T2.USR_PW
	            ,T2.ENABLED_YN
	            ,T2.LANG_CD
	            ,T2.EMP_NO
	            ,T2.DEL_YN
	            ,NVL(T2.THEME_ID, 'default')
	            ,T2.REG_USR_ID
	            ,T2.REG_DT
	            ,T2.UPDT_USR_ID
	            ,T2.UPDT_DT
	            ,T2.CMPN_ID
	            ,T2.DLR_CD
	            ,T2.DEPT_CD
	            ,T2.PSTN_CD
	            ,T2.DUTY_CD
	            ,T2.TSK_CD
	            ,T2.EMAIL
	            ,T2.HP_NO
	            ,T2.TEL_NO1
	            ,T2.USR_PWD_CHG_DT
	            ,T2.USR_ID_NO
	            ,T2.JOIN_DT
	            ,T2.RETIRE_DT
	            ,T2.ZIP_NO
	            ,T2.ADDR1
	            ,T2.ADDR2
	            ,T2.ADDR3
	            ,T2.BIZ_CD
	            ,T2.SERV_YN
	            ,T2.SALE_YN
	            ,T2.CORP_CD
	            ,T2.TEL_NO2
	            ,T2.CLAIM_REQ_PERM_YN
                ,T2.BIRTHDAY
                ,T2.GNDR_CD
                ,T2.TSK_DETL
	            ,'N'
	        )
    </update>

    <!-- 사용자 비밀번호가 유효한지 여부를 반환한다. -->
    <select id="isValidPassword" parameterType="map" resultType="boolean">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUserByKey] */
        SELECT
        	CASE WHEN COUNT(USR_ID) > 0 THEN 1 ELSE 0 END AS VALUE  FROM CM_0801T
        WHERE
        	USR_ID = #{usrId}
        	AND USR_PW = #{usrPw}
    </select>

	<!-- 사용자계정를 조회한다. -->
	<select id="selectUserByKey" parameterType="string" resultType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUserByKey] */
        SELECT V1.*, V2.DEPT_NM, V3.TSK_NM
        FROM CM_0801T V1
        LEFT JOIN CM_3401T V2 ON V1.DEPT_CD = V2.DEPT_CD AND V2.CMP_TP = '20'
        LEFT JOIN CM_2801T V3 ON V1.TSK_CD = V3.TSK_CD AND V3.CMP_TP = '20'
		WHERE USR_ID = #{usrId}
	</select>

    <select id="selectUsersForSuggest" parameterType="map" resultType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUsersForSuggest] */
        <bind name='query' value='query+"%"' />
        SELECT T1.* FROM (
            SELECT USR_ID, USR_NM, EMP_NO
            FROM CM_0801T
            WHERE
                DLR_CD = #{dlrCd}
                AND (USR_ID LIKE #{query} OR USR_NM LIKE #{query})
            ORDER BY USR_NM ASC
        ) T1
        WHERE ROWNUM <![CDATA[<=]]> #{maxRows}
    </select>

	<!-- 사용자계정 목록을 조회한다. -->
	<select id="selectUsersByCondition" parameterType="UserSearchVO" resultType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUsersByCondition] */
		SELECT * FROM (
            SELECT ROWNUM AS RNUM,T1.* FROM (
                SELECT V1.*, V2.DEPT_NM, V3.TSK_NM
                FROM CM_0801T V1
                LEFT JOIN CM_3401T V2 ON V1.DEPT_CD = V2.DEPT_CD
                LEFT JOIN CM_2801T V3 ON V1.TSK_CD = V3.TSK_CD
                <where>
                    <if test='sText != null and sText != ""'>
                        <foreach collection="sFields" item="sField" open="(" close=")" separator="OR">
                            <choose>
                                <when test='sField == "USRID"'>
                                    V1.USR_ID LIKE '%'||#{sText}||'%'
                                </when>
                                <when test='sField == "USRNM"'>
                                    V1.USR_NM LIKE '%'||#{sText}||'%'
                                </when>
                                <when test='sField == "EMPNO"'>
                                    V1.EMP_NO LIKE '%'||#{sText}||'%'
                                </when>
                            </choose>
                        </foreach>
                    </if>
                    <if test='sDlrCd != null and sDlrCd != ""'>
                        AND V1.DLR_CD = #{sDlrCd}
                    </if>
                    <if test='sExcludeDlrCd != null and sExcludeDlrCd != ""'>
                        AND V1.DLR_CD != #{sExcludeDlrCd}
                    </if>
                    <if test='sEnabledYn != null and sEnabledYn != ""'>
                        AND V1.ENABLED_YN = #{sEnabledYn}
                    </if>
                    <if test='sDelYn != null and sDelYn != ""'>
                        AND V1.DEL_YN = #{sDelYn}
                    </if>
                    <if test='sDeptCd != null and sDeptCd != ""'>
                        AND V1.DEPT_CD = #{sDeptCd}
                    </if>
                    <if test='sTskCd != null and sTskCd != ""'>
                        AND V1.TSK_CD = #{sTskCd}
                    </if>
                    <if test='sTskDetl != null and sTskDetl != ""'>
                        AND V1.TSK_DETL = #{sTskDetl}
                    </if>
                    <if test='sUsrId != null and sUsrId != ""'>
                        AND V1.USR_ID LIKE '%'||#{sUsrId}||'%'
                    </if>
                    <if test='sUsrNm != null and sUsrNm != ""'>
                        AND V1.USR_NM LIKE '%'||#{sUsrNm}||'%'
                    </if>
                    <if test='sEmpNo != null and sEmpNo != ""'>
                        AND V1.EMP_NO LIKE '%'||#{sEmpNo}||'%'
                    </if>
                    <if test='sClaimReqPermYn != null and sClaimReqPermYn != ""'>
                        AND V1.CLAIM_REQ_PERM_YN = #{sClaimReqPermYn}
                    </if>
                    <if test='sDeptNm != null and sDeptNm != ""'>
                        AND V2.DEPT_NM = #{sDeptNm}
                    </if>
                    <if test='sTskNm != null and sTskNm != ""'>
                        AND V3.TSK_NM = #{sTskNm}
                    </if>
                </where>
                ORDER BY
                <choose>
                    <when test='sort != null'>
                        <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                            <choose>
                                <when test='item.field == "dlrCd"'>V1.DLR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "usrId"'>V1.USR_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "usrNm"'>V1.USR_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "empNo"'>V1.EMP_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "deptCd"'>V1.DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "deptNm"'>V2.DEPT_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "tskCd"'>V1.TSK_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "tskNm"'>V3.TSK_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "langCd"'>V1.LANG_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "enabledYn"'>V1.ENABLED_YN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "delYn"'>V1.DEL_YN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <when test='item.field == "claimReqPermYn"'>V1.CLAIM_REQ_PERM_YN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                <otherwise>
                                    V1.USR_ID ASC
                                </otherwise>
                            </choose>
                        </foreach>
                    </when>
                    <otherwise>
                        V1.USR_ID ASC
                    </otherwise>
                </choose>
            ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

	<!-- 사용자계정 목록수를 조회한다. -->
	<select id="selectUsersByConditionCnt" parameterType="UserSearchVO" resultType="int">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUsersByConditionCnt] */
		SELECT COUNT(*) AS VALUE
        FROM CM_0801T V1
        LEFT JOIN CM_3401T V2 ON V1.DEPT_CD = V2.DEPT_CD
        LEFT JOIN CM_2801T V3 ON V1.TSK_CD = V3.TSK_CD
		<where>
            <if test='sText != null and sText != ""'>
                <foreach collection="sFields" item="sField" open="(" close=")" separator="OR">
                    <choose>
                        <when test='sField == "USRID"'>
                            V1.USR_ID LIKE '%'||#{sText}||'%'
                        </when>
                        <when test='sField == "USRNM"'>
                            V1.USR_NM LIKE '%'||#{sText}||'%'
                        </when>
                        <when test='sField == "EMPNO"'>
                            V1.EMP_NO LIKE '%'||#{sText}||'%'
                        </when>
                    </choose>
                </foreach>
            </if>
            <if test='sDlrCd != null and sDlrCd != ""'>
                AND V1.DLR_CD = #{sDlrCd}
            </if>
            <if test='sExcludeDlrCd != null and sExcludeDlrCd != ""'>
                AND V1.DLR_CD != #{sExcludeDlrCd}
            </if>
            <if test='sEnabledYn != null and sEnabledYn != ""'>
                AND V1.ENABLED_YN = #{sEnabledYn}
            </if>
            <if test='sDelYn != null and sDelYn != ""'>
                AND V1.DEL_YN = #{sDelYn}
            </if>
            <if test='sDeptCd != null and sDeptCd != ""'>
                AND V1.DEPT_CD = #{sDeptCd}
            </if>
            <if test='sTskCd != null and sTskCd != ""'>
                AND V1.TSK_CD = #{sTskCd}
            </if>
            <if test='sTskDetl != null and sTskDetl != ""'>
                AND V1.TSK_DETL = #{sTskDetl}
            </if>
            <if test='sUsrId != null and sUsrId != ""'>
                AND V1.USR_ID LIKE '%'||#{sUsrId}||'%'
            </if>
            <if test='sUsrNm != null and sUsrNm != ""'>
                AND V1.USR_NM LIKE '%'||#{sUsrNm}||'%'
            </if>
            <if test='sEmpNo != null and sEmpNo != ""'>
                AND V1.EMP_NO LIKE '%'||#{sEmpNo}||'%'
            </if>
            <if test='sClaimReqPermYn != null and sClaimReqPermYn != ""'>
                AND V1.CLAIM_REQ_PERM_YN = #{sClaimReqPermYn}
            </if>
            <if test='sDeptNm != null and sDeptNm != ""'>
                AND V2.DEPT_NM = #{sDeptNm}
            </if>
            <if test='sTskNm != null and sTskNm != ""'>
                AND V3.TSK_NM = #{sTskNm}
            </if>
        </where>
	</select>

    <!-- 역할에 해당하는 사용자 목록을 조회한다.
    <select id="selectUsersByRoleId" parameterType="map" resultType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUsersByRoleId] */
        SELECT T1.*
        FROM CM_0801T T1, CM_0803T T2
        WHERE
            T1.DLR_CD=#{dlrCd}
            AND T1.DEL_YN='N'
            AND T1.ENABLED_YN='Y'
            AND T1.TSK_CD=T2.REF_ID
            AND T2.ROLE_ID=#{roleId}
            AND T2.REF_TP='T'
            AND T2.SYS_CD=#{sysCd}

        UNION

        SELECT T1.*
        FROM CM_0801T T1, CM_0803T T2
        WHERE
            T1.DLR_CD=#{dlrCd}
            AND T1.DEL_YN='N'
            AND T1.ENABLED_YN='Y'
            AND T1.USR_ID=T2.REF_ID
            AND T2.ROLE_ID=#{roleId}
            AND T2.REF_TP='U'
            AND T2.SYS_CD=#{sysCd}
    </select>
    -->

    <!-- 직무코드에 해당하는 사용자 목록을 조회한다. -->
    <select id="selectUsersByTskCd" parameterType="map" resultType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUsersByTskCd] */
        SELECT * FROM CM_0801T
        WHERE
            DLR_CD=#{dlrCd}
            AND DEL_YN='N'
            AND ENABLED_YN='Y'
            AND TSK_CD=#{tskCd}
    </select>
    
    <select id="selectUsersByTskCdAndUsrId" parameterType="UserSearchVO" resultType="UserVO">
        /* [chn.bhmc.dms.cmm.sci.service.dao.UserDAO.selectUsersByTskCd] */
        SELECT * FROM CM_0801T
        WHERE DEL_YN='N'
            AND ENABLED_YN='Y'
            <if test='sTskCd != null and sTskCd != ""'>
           	 AND TSK_CD=#{sTskCd}
            </if>
            <if test='sUsrId != null and sUsrId != ""'>
	         AND USR_ID=#{sUsrId}
            </if>
            <if test='sDeptCd != null and sDeptCd != ""'>
	         AND DEPT_CD=#{sDeptCd}
            </if>
    </select>
</mapper>