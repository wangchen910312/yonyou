<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : MarketingCampaignDAO_SqlMap.xml
    Description : 마케팅 캠페인에 관한 데이터처리
    author hyoung jun an
    since 2016. 03. 04.
    version 1.0
    Modification Information
       since          author              description
    ===========    =============    ===========================
    2016.03.04     hyoung jun an    최초 생성
-->

<mapper namespace="chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO">

    <!-- VOC 정보를 등록한다. -->
    <insert id="insertVocMgmt" parameterType="VocMgmtVO" >
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.insertVocMgmt] */
        INSERT INTO DMSDB.CR_0601T    --VOC마스터
        (
         DLR_CD                         --딜러코드
        ,VOC_NO                         --VOC번호
        ,VOC_STAT_CD                    --VOC상태코드
        ,VOC_TP_CD                      --VOC유형코드
        ,TEND_CD                        --성향코드
        ,VOC_TP_SUB1_CD                 --VOC유형하위1코드
        ,VOC_TP_SUB2_CD                 --VOC유형하위2코드
        ,VOC_TP_SUB3_CD                 --VOC유형하위3코드
        ,ACPT_SRC_CD                    --접수출처코드
        ,ACTIVE_GAIN_PATH_CD            --활동획득경로코드
        ,CMPL_CAU_CD                    --불만원인코드
        ,PROR_CD                        --우선순위코드
        ,PROC_LMT_CD                    --처리시한코드
        ,EMGC_CALL_CD                   --긴급콜코드
        ,EMGC_RESC_START_YN             --긴급구조시작여부
        ,CAU_CD                         --원인코드
        ,EMGC_RESC_STSF_CD              --긴급구조만족도코드
        ,VOC_END_DT                     --VOC종료일자
        ,RECEIVE_TEL_NO                 --수신전화번호
        ,CUST_NM                        --고객명
        ,CUST_NO                        --고객번호
        ,CUST_PREF_COMM_NO              --고객선호연락번호
        ,HP_NO                          --휴대폰번호
        ,HOME_TEL_NO                    --집전화번호
        ,OFFICE_TEL_NO                  --직장전화번호
        ,PCON_CUST_NM                   --연계인고객명
        ,PCON_CUST_NO                   --연계인고객번호
        ,PCON_CUST_MJR_TEL_NO           --연계인고객주요전화번호
        ,PCON_CUST_HP_NO                --연계인고객휴대폰번호
        ,PCON_CUST_HOME_TEL_NO          --연계인고객집전화번호
        ,PCON_CUST_OFFICE_TEL_NO        --연계인고객직장전화번호
        ,RESV_DT                        --예약일자
        ,SEND_TEL_NO                    --발신전화번호
        ,PCON_REL_CD                    --연계인관계코드
        ,PPROC_DEPT_NM                  --처리부서명
        ,PPROC_ID                       --처리인ID
        ,COOP_DEPT_NM                   --협조부서명
        ,BIZ_DEPT_NM                    --사업부서명
        ,OFFICE_NM                      --사무소명
        ,SUNG_CD                        --성코드
        ,SUNG_NM                        --성명
        ,CITY_CD                        --도시코드
        ,CITY_NM                        --도시명
        ,VIN_NO                         --차대번호
        ,CAR_REG_NO                     --차량등록번호
        ,CARLINE_CD                     --차종코드
        ,CARLINE_NM                     --차종명
        ,MODEL_CD                       --모델코드
        ,MODEL_NM                       --모델명
        ,OCN_CD                         --OCN코드
        ,OCN_NM                         --OCN명
        ,RUN_DIST_VAL                   --주행거리값
        ,ACPT_DEPT_NM                   --접수부서
        ,PACPT_ID                       --접수자ID
        ,ACPT_DT                        --접수일자
        ,CUST_REQ_CONT                  --고객요청내용
        ,CUST_RESC_LOC_CONT             --고객구조위치내용
        ,PEVAL_ID                       --심사인ID
        ,EVAL_ALLOC_DT                  --심사배정일자
        ,CALL_CEN_OPN_CONT              --콜센터의견내용
        ,RETURN_CAU_CONT                --반송원인내용
        ,PMO_CAU_CD                     --승급원인코드
        ,PMO_DT                         --승급일자
        ,REV_MTH_CONT                   --검토방안내용
        ,REAL_PPROC_ID                  --실처리인ID
        ,PROC_DT                        --처리일자
        ,PPROC_TEL_NO                   --처리인전화번호
        ,PPROC_EMAIL_NM                 --처리인이메일명
        ,PROC_RSLT_CONT                 --처리결과내용
        ,STSF_IVST_EMP_ID               --만족도조사인ID
        ,STSF_IVST_DT                   --만족도조사일자
        ,STSF_IVST_RSLT_CONT            --만족도조사결과내용
        ,MTH_ACHV_HM                    --방안달성시간
        ,CMPL_STSF_CD                   --불만만족도코드
        ,CMPL_RE_ACPT_YN                --불만재접수여부
        ,CMPL_RE_ACPT_CNT               --불만재접수횟수
        ,SER_REQ_NO                     --서비스요청번호
        ,CMPL_DL_DEPT_NM                --불만전달부서명
        ,CMPL_DL_EMP_ID                 --불만전달자ID
        ,SALE_DT                        --판매일자
        ,DSTB_NO                        --물류번호
        ,PAR_ORD_YN                     --부품오더여부
        ,PAR_ORD_DT                     --부품오더일자
        ,PAR_ARRV_DT                    --부품도착일자
        ,ITEM_CD                        --품목코드
        ,BHMC_YN                        --BHMC여부
        ,BHMC_VOC_NO                    --BHMCVOC번호
        ,REPAIR_BOOK_ID                 --정비예약ID
        ,MANUFACTURER                   --제조사/특약점
        ,DATA_SHIP_STAT_CD              --자료배송상태
        ,REG_USR_ID                     --등록자ID
        ,REG_DT                         --등록일자
        ,UPDT_USR_ID                    --수정자ID
        ,UPDT_DT                        --수정일자
        )
        VALUES
        (
         #{dlrCd}                         --딜러코드
        ,#{vocNo}                         --VOC번호
        ,#{vocStatCd}                     --VOC상태코드
        ,#{vocTpCd}                       --VOC유형코드
        ,#{tendCd}                        --성향코드
        ,#{vocTpSub1Cd}                   --VOC유형하위1코드
        ,#{vocTpSub2Cd}                   --VOC유형하위2코드
        ,#{vocTpSub3Cd}                   --VOC유형하위3코드
        ,#{acptSrcCd}                     --접수출처코드
        ,#{activeGainPathCd}              --활동획득경로코드
        ,#{cmplCauCd}                     --불만원인코드
        ,#{prorCd}                        --우선순위코드
        ,#{procLmtCd}                     --처리시한코드
        ,#{emgcCallCd}                    --긴급콜코드
        ,#{emgcRescStartYn}               --긴급구조시작여부
        ,#{cauCd}                         --원인코드
        ,#{emgcRescStsfCd}                --긴급구조만족도코드
        ,#{vocEndDt}                      --VOC종료일자
        ,#{receiveTelNo}                  --수신전화번호
        ,#{custNm}                        --고객명
        ,#{custNo}                        --고객번호
        ,#{custPrefCommNo}                --고객선호연락번호
        ,#{hpNo}                          --휴대폰번호
        ,#{homeTelNo}                     --집전화번호
        ,#{officeTelNo}                   --직장전화번호
        ,#{pconCustNm}                    --연계인고객명
        ,#{pconCustNo}                    --연계인고객번호
        ,#{pconCustMjrTelNo}              --연계인고객주요전화번호
        ,#{pconCustHpNo}                  --연계인고객휴대폰번호
        ,#{pconCustHomeTelNo}             --연계인고객집전화번호
        ,#{pconCustOfficeTelNo}           --연계인고객직장전화번호
        ,#{resvDt}                        --예약일자
        ,#{sendTelNo}                     --발신전화번호
        ,#{pconRelCd}                     --연계인관계코드
        ,#{pprocDeptNm}                   --처리부서명
        ,#{pprocId}                       --처리인ID
        ,#{coopDeptNm}                    --협조부서명
        ,#{bizDeptNm}                     --사업부서명
        ,#{officeNm}                      --사무소명
        ,#{sungCd}                        --성코드
        ,#{sungNm}                        --성명
        ,#{cityCd}                        --도시코드
        ,#{cityNm}                        --도시명
        ,#{vinNo}                         --차대번호
        ,#{carRegNo}                      --차량등록번호
        ,#{carlineCd}                     --차종코드
        ,#{carlineNm}                     --차종명
        ,#{modelCd}                       --모델코드
        ,#{modelNm}                       --모델명
        ,#{ocnCd}                         --OCN코드
        ,#{ocnNm}                         --OCN명
        ,#{runDistVal}                    --주행거리값
        ,#{acptDeptNm}                    --접수부서
        ,#{pacptId}                       --접수자ID
        ,#{acptDt}                        --접수일자
        ,#{custReqCont}                   --고객요청내용
        ,#{custRescLocCont}               --고객구조위치내용
        ,#{pevalId}                       --심사인ID
        ,#{evalAllocDt}                   --심사배정일자
        ,#{callCenOpnCont}                --콜센터의견내용
        ,#{returnCauCont}                 --반송원인내용
        ,#{pmoCauCd}                      --승급원인코드
        ,#{pmoDt}                         --승급일자
        ,#{revMthCont}                    --검토방안내용
        ,#{realPprocId}                   --실처리인ID
        ,#{procDt}                        --처리일자
        ,#{pprocTelNo}                    --처리인전화번호
        ,#{pprocEmailNm}                  --처리인이메일명
        ,#{procRsltCont}                  --처리결과내용
        ,#{stsfIvstEmpId}                 --만족도조사인ID
        ,#{stsfIvstDt}                    --만족도조사일자
        ,#{stsfIvstRsltCont}              --만족도조사결과내용
        ,#{mthAchvHm}                     --방안달성시간
        ,#{cmplStsfCd}                    --불만만족도코드
        ,#{cmplReAcptYn}                  --불만재접수여부
        ,#{cmplReAcptCnt}                 --불만재접수횟수
        ,#{serReqNo}                      --서비스요청번호
        ,#{cmplDlDeptNm}                  --불만전달부서명
        ,#{cmplDlEmpId}                   --불만전달자ID
        ,#{saleDt}                        --판매일자
        ,#{dstbNo}                        --물류번호
        ,#{parOrdYn}                      --부품오더여부
        ,#{parOrdDt}                      --부품오더일자
        ,#{parArrvDt}                     --부품도착일자
        ,#{itemCd}                        --품목코드
        ,#{bhmcYn}                        --BHMC여부
        ,#{bhmcVocNo}                     --BHMCVOC번호
        ,#{repairBookId}                  --정비예약ID
        ,#{manufacturer}                  --제조사/특약점
        ,#{dataShipStatCd}                --자료배송상태
        ,#{regUsrId}                      --등록자ID
        ,SYSDATE                          --등록일자
        ,#{updtUsrId}                     --수정자ID
        ,SYSDATE                          --수정일자
        )
    </insert>


    <!-- VOC 정보를 수정한다. -->
    <update id="updateVocMgmt" parameterType="VocMgmtVO" >
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.updateVocMgmt] */
        UPDATE DMSDB.CR_0601T    --VOC마스터
        SET
         VOC_STAT_CD             = #{vocStatCd}                     --VOC상태코드
        ,VOC_TP_CD               = #{vocTpCd}                       --VOC유형코드
        ,TEND_CD                 = #{tendCd}                        --성향코드
        ,VOC_TP_SUB1_CD          = #{vocTpSub1Cd}                   --VOC유형하위1코드
        ,VOC_TP_SUB2_CD          = #{vocTpSub2Cd}                   --VOC유형하위2코드
        ,VOC_TP_SUB3_CD          = #{vocTpSub3Cd}                   --VOC유형하위3코드
        ,ACPT_SRC_CD             = #{acptSrcCd}                     --접수출처코드
        ,ACTIVE_GAIN_PATH_CD     = #{activeGainPathCd}              --활동획득경로코드
        ,CMPL_CAU_CD             = #{cmplCauCd}                     --불만원인코드
        ,PROR_CD                 = #{prorCd}                        --우선순위코드
        ,PROC_LMT_CD             = #{procLmtCd}                     --처리시한코드
        ,EMGC_CALL_CD            = #{emgcCallCd}                    --긴급콜코드
        ,EMGC_RESC_START_YN      = #{emgcRescStartYn}               --긴급구조시작여부
        ,CAU_CD                  = #{cauCd}                         --원인코드
        ,EMGC_RESC_STSF_CD       = #{emgcRescStsfCd}                --긴급구조만족도코드
        ,VOC_END_DT              = #{vocEndDt}                      --VOC종료일자
        ,RECEIVE_TEL_NO          = #{receiveTelNo}                  --수신전화번호
        ,CUST_NM                 = #{custNm}                        --고객명
        ,CUST_NO                 = #{custNo}                        --고객번호
        ,CUST_PREF_COMM_NO       = #{custPrefCommNo}                --고객선호연락번호
        ,HP_NO                   = #{hpNo}                          --휴대폰번호
        ,HOME_TEL_NO             = #{homeTelNo}                     --집전화번호
        ,OFFICE_TEL_NO           = #{officeTelNo}                   --직장전화번호
        ,PCON_CUST_NM            = #{pconCustNm}                    --연계인고객명
        ,PCON_CUST_NO            = #{pconCustNo}                    --연계인고객번호
        ,PCON_CUST_MJR_TEL_NO    = #{pconCustMjrTelNo}              --연계인고객주요전화번호
        ,PCON_CUST_HP_NO         = #{pconCustHpNo}                  --연계인고객휴대폰번호
        ,PCON_CUST_HOME_TEL_NO   = #{pconCustHomeTelNo}             --연계인고객집전화번호
        ,PCON_CUST_OFFICE_TEL_NO = #{pconCustOfficeTelNo}           --연계인고객직장전화번호
        ,RESV_DT                 = #{resvDt}                        --예약일자
        ,SEND_TEL_NO             = #{sendTelNo}                     --발신전화번호
        ,PCON_REL_CD             = #{pconRelCd}                     --연계인관계코드
        ,PPROC_DEPT_NM           = #{pprocDeptNm}                   --처리부서
        ,PPROC_ID                = #{pprocId}                       --처리인ID
        ,COOP_DEPT_NM            = #{coopDeptNm}                    --협조부서명
        ,BIZ_DEPT_NM             = #{bizDeptNm}                     --사업부서명
        ,OFFICE_NM               = #{officeNm}                      --사무소명
        ,SUNG_CD                 = #{sungCd}                        --성코드
        ,SUNG_NM                 = #{sungNm}                        --성명
        ,CITY_CD                 = #{cityCd}                        --도시코드
        ,CITY_NM                 = #{cityNm}                        --도시명
        ,VIN_NO                  = #{vinNo}                         --차대번호
        ,CAR_REG_NO              = #{carRegNo}                      --차량등록번호
        ,CARLINE_CD              = #{carlineCd}                     --차종코드
        ,CARLINE_NM              = #{carlineNm}                     --차종명
        ,MODEL_CD                = #{modelCd}                       --모델코드
        ,MODEL_NM                = #{modelNm}                       --모델명
        ,OCN_CD                  = #{ocnCd}                         --OCN코드
        ,OCN_NM                  = #{ocnNm}                         --OCN명
        ,RUN_DIST_VAL            = #{runDistVal}                    --주행거리값
        ,ACPT_DEPT_NM            = #{acptDeptNm}                    --접수부서
        ,PACPT_ID                = #{pacptId}                       --접수자ID
        ,ACPT_DT                 = #{acptDt}                        --접수일자
        ,CUST_REQ_CONT           = #{custReqCont}                   --고객요청내용
        ,CUST_RESC_LOC_CONT      = #{custRescLocCont}               --고객구조위치내용
        ,PEVAL_ID                = #{pevalId}                       --심사인ID
        ,EVAL_ALLOC_DT           = #{evalAllocDt}                   --심사배정일자
        ,CALL_CEN_OPN_CONT       = #{callCenOpnCont}                --콜센터의견내용
        ,RETURN_CAU_CONT         = #{returnCauCont}                 --반송원인내용
        ,PMO_CAU_CD              = #{pmoCauCd}                      --승급원인코드
        ,PMO_DT                  = #{pmoDt}                         --승급일자
        ,REV_MTH_CONT            = #{revMthCont}                    --검토방안내용
        ,REAL_PPROC_ID           = #{realPprocId}                   --실처리인ID
        ,PROC_DT                 = #{procDt}                        --처리일자
        ,PPROC_TEL_NO            = #{pprocTelNo}                    --처리인전화번호
        ,PPROC_EMAIL_NM          = #{pprocEmailNm}                  --처리인이메일명
        ,PROC_RSLT_CONT          = #{procRsltCont}                  --처리결과내용
        ,STSF_IVST_EMP_ID        = #{stsfIvstEmpId}                 --만족도조사인ID
        ,STSF_IVST_DT            = #{stsfIvstDt}                    --만족도조사일자
        ,STSF_IVST_RSLT_CONT     = #{stsfIvstRsltCont}              --만족도조사결과내용
        ,MTH_ACHV_HM             = #{mthAchvHm}                     --방안달성시간
        ,CMPL_STSF_CD            = #{cmplStsfCd}                    --불만만족도코드
        ,CMPL_RE_ACPT_YN         = #{cmplReAcptYn}                  --불만재접수여부
        ,CMPL_RE_ACPT_CNT        = #{cmplReAcptCnt}                 --불만재접수횟수
        ,SER_REQ_NO              = #{serReqNo}                      --서비스요청번호
        ,CMPL_DL_DEPT_NM         = #{cmplDlDeptNm}                  --불만전달부서명
        ,CMPL_DL_EMP_ID          = #{cmplDlEmpId}                   --불만전달자ID
        ,SALE_DT                 = #{saleDt}                        --판매일자
        ,DSTB_NO                 = #{dstbNo}                        --물류번호
        ,PAR_ORD_YN              = #{parOrdYn}                      --부품오더여부
        ,PAR_ORD_DT              = #{parOrdDt}                      --부품오더일자
        ,PAR_ARRV_DT             = #{parArrvDt}                     --부품도착일자
        ,ITEM_CD                 = #{itemCd}                        --품목코드
        ,BHMC_YN                 = #{bhmcYn}                        --BHMC여부
        ,BHMC_VOC_NO             = #{bhmcVocNo}                     --BHMCVOC번호
        ,REPAIR_BOOK_ID          = #{repairBookId}                  --정비예약ID
        ,MANUFACTURER            = #{manufacturer}                  --제조사/특약점
        ,DATA_SHIP_STAT_CD       = #{dataShipStatCd}                --자료배송상태
        ,UPDT_USR_ID             = #{updtUsrId}                     --수정자ID
        ,UPDT_DT                 = SYSDATE                          --수정일자
        WHERE 1 = 1
        AND DLR_CD               = #{dlrCd}                         --딜러코드
        AND VOC_NO               = #{vocNo}                         --VOC번호
    </update>

    <!-- VOC 정보 목록을 조회한다. -->
    <select id="selectVocMgmtsByCondition" parameterType="VocMgmtSearchVO" resultType="VocMgmtVO">
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.selectVocMgmtsByCondition] */
        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                 SELECT
                         CR_0601T.DLR_CD                         --딜러코드
                        ,CR_0601T.VOC_NO                         --VOC번호
                        ,CR_0601T.VOC_STAT_CD                    --VOC상태코드
                        ,(SELECT CMM_CD_NM FROM CM_0303T WHERE CMM_GRP_CD IN ('CRM610','CRM611','CRM612','CRM613','CRM614') AND USE_YN = 'Y' AND CMM_CD = CR_0601T.VOC_STAT_CD AND REMARK1 = CR_0601T.VOC_TP_CD)
                         AS VOC_STAT_NM
                        ,CR_0601T.VOC_TP_CD                      --VOC유형코드
                        ,(SELECT NVL(B.CMM_CD_TXT, A.CMM_CD_NM)
                            FROM CM_0303T A, CM_0304T B
                           WHERE A.CMM_GRP_CD = B.CMM_GRP_CD
                             AND A.CMM_CD = B.CMM_CD
                             AND B.LANG_CD = #{langCd}
                             AND A.CMM_GRP_CD = 'CRM604'
                             AND A.USE_YN = 'Y'
                             AND A.CMM_CD = CR_0601T.VOC_TP_CD)
                         AS VOC_TP_NM
                        ,CR_0601T.TEND_CD                        --성향코드
                        ,CR_0601T.VOC_TP_SUB1_CD                 --VOC유형하위1코드
                        ,CR_0601T.VOC_TP_SUB2_CD                 --VOC유형하위2코드
                        ,CR_0601T.VOC_TP_SUB3_CD                 --VOC유형하위3코드
                        ,CR_0601T.ACPT_SRC_CD                    --접수출처코드
                        ,CR_0601T.ACTIVE_GAIN_PATH_CD            --활동획득경로코드
                        ,CR_0601T.CMPL_CAU_CD                    --불만원인코드
                        ,CR_0601T.PROR_CD                        --우선순위코드
                        ,CR_0601T.PROC_LMT_CD                    --처리시한코드
                        ,CR_0601T.EMGC_CALL_CD                   --긴급콜코드
                        ,CR_0601T.EMGC_RESC_START_YN             --긴급구조시작여부
                        ,CR_0601T.CAU_CD                         --원인코드
                        ,CR_0601T.EMGC_RESC_STSF_CD              --긴급구조만족도코드
                        ,CR_0601T.VOC_END_DT                     --VOC종료일자
                        ,CR_0601T.RECEIVE_TEL_NO                 --수신전화번호
                        ,CR_0601T.CUST_NM                        --고객명
                        ,CR_0601T.CUST_NO                        --고객번호
                        ,CR_0601T.CUST_PREF_COMM_NO              --고객선호연락번호
                        ,CR_0601T.HP_NO                          --휴대폰번호
                        ,CR_0601T.HOME_TEL_NO                    --집전화번호
                        ,CR_0601T.OFFICE_TEL_NO                  --직장전화번호
                        ,CR_0601T.PCON_CUST_NM                   --연계인고객명
                        ,CR_0601T.PCON_CUST_NO                   --연계인고객번호
                        ,CR_0601T.PCON_CUST_MJR_TEL_NO           --연계인고객주요전화번호
                        ,CR_0601T.PCON_CUST_HP_NO                --연계인고객휴대폰번호
                        ,CR_0601T.PCON_CUST_HOME_TEL_NO          --연계인고객집전화번호
                        ,CR_0601T.PCON_CUST_OFFICE_TEL_NO        --연계인고객직장전화번호
                        ,CR_0601T.RESV_DT                        --예약일자
                        ,CR_0601T.SEND_TEL_NO                    --발신전화번호
                        ,CR_0601T.PCON_REL_CD                    --연계인관계코드
                        ,CR_0601T.PPROC_DEPT_NM                  --처리부서
                        ,CR_0601T.PPROC_ID                       --처리인ID
                        ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = CR_0601T.PPROC_ID) AS PPROC_NM
                        ,CR_0601T.COOP_DEPT_NM                   --협조부서명
                        ,CR_0601T.BIZ_DEPT_NM                    --사업부서명
                        ,CR_0601T.OFFICE_NM                      --사무소명
                        ,CR_0601T.SUNG_CD                        --성코드
                        ,CR_0601T.SUNG_NM                        --성명
                        ,CR_0601T.CITY_CD                        --도시코드
                        ,CR_0601T.CITY_NM                        --도시명
                        ,CR_0601T.VIN_NO                         --차대번호
                        ,CR_0601T.CAR_REG_NO                     --차량등록번호
                        ,CR_0601T.CARLINE_CD                     --차종코드
                        ,CR_0601T.CARLINE_NM                     --차종명
                        ,CR_0601T.MODEL_CD                       --모델코드
                        ,CR_0601T.MODEL_NM                       --모델명
                        ,CR_0601T.OCN_CD                         --OCN코드
                        ,CR_0601T.OCN_NM                         --OCN명
                        ,CR_0601T.RUN_DIST_VAL                   --주행거리값
                        ,CR_0601T.ACPT_DEPT_NM                   --접수부서
                        ,CR_0601T.PACPT_ID                       --접수자ID
                        ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = CR_0601T.PACPT_ID) AS PACPT_NM
                        ,CR_0601T.ACPT_DT                        --접수일자
                        ,CR_0601T.CUST_REQ_CONT                  --고객요청내용
                        ,CR_0601T.CUST_RESC_LOC_CONT             --고객구조위치내용
                        ,CR_0601T.PEVAL_ID                       --심사인ID
                        ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = CR_0601T.PEVAL_ID) AS PEVAL_NM
                        ,CR_0601T.EVAL_ALLOC_DT                  --심사배정일자
                        ,CR_0601T.CALL_CEN_OPN_CONT              --콜센터의견내용
                        ,CR_0601T.RETURN_CAU_CONT                --반송원인내용
                        ,CR_0601T.PMO_CAU_CD                     --승급원인코드
                        ,CR_0601T.PMO_DT                         --승급일자
                        ,CR_0601T.REV_MTH_CONT                   --검토방안내용
                        ,CR_0601T.REAL_PPROC_ID                  --실처리인ID
                        ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = CR_0601T.REAL_PPROC_ID) AS REAL_PPROC_NM
                        ,CR_0601T.PROC_DT                        --처리일자
                        ,CR_0601T.PPROC_TEL_NO                   --처리인전화번호
                        ,CR_0601T.PPROC_EMAIL_NM                 --처리인이메일명
                        ,CR_0601T.PROC_RSLT_CONT                 --처리결과내용
                        ,CR_0601T.STSF_IVST_EMP_ID               --만족도조사인ID
                        ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = CR_0601T.STSF_IVST_EMP_ID) AS STSF_IVST_EMP_NM
                        ,CR_0601T.STSF_IVST_DT                   --만족도조사일자
                        ,CR_0601T.STSF_IVST_RSLT_CONT            --만족도조사결과내용
                        ,CR_0601T.MTH_ACHV_HM                    --방안달성시간
                        ,CR_0601T.CMPL_STSF_CD                   --불만만족도코드
                        ,CR_0601T.CMPL_RE_ACPT_YN                --불만재접수여부
                        ,CR_0601T.CMPL_RE_ACPT_CNT               --불만재접수횟수
                        ,CR_0601T.SER_REQ_NO                     --서비스요청번호
                        ,CR_0601T.CMPL_DL_DEPT_NM                --불만전달부서명
                        ,CR_0601T.CMPL_DL_EMP_ID                 --불만전달자ID
                        ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = CR_0601T.CMPL_DL_EMP_ID) AS CMPL_DL_EMP_NM
                        ,CR_0601T.SALE_DT                        --판매일자
                        ,CR_0601T.DSTB_NO                        --물류번호
                        ,CR_0601T.PAR_ORD_YN                     --부품오더여부
                        ,CR_0601T.PAR_ORD_DT                     --부품오더일자
                        ,CR_0601T.PAR_ARRV_DT                    --부품도착일자
                        ,CR_0601T.ITEM_CD                        --품목코드
                        ,CR_0601T.BHMC_YN                        --BHMC여부
                        ,CR_0601T.BHMC_VOC_NO                    --BHMCVOC번호
                        ,CR_0601T.REPAIR_BOOK_ID                 --정비예약ID
                        ,CR_0601T.MANUFACTURER                   --제조사/특약점
                        ,CR_0601T.DATA_SHIP_STAT_CD              --자료배송상태
                        ,CR_0601T.REG_USR_ID                     --등록자ID
                        ,CR_0601T.REG_DT                         --등록일자
                        ,CR_0601T.UPDT_USR_ID                    --수정자ID
                        ,CR_0601T.UPDT_DT                        --수정일자
                        ,(SELECT COUNT(DECODE(VOC_TP_CD,'01',1))
                            FROM CR_0601T
                           WHERE 1 = 1
                           <if test='sRegStartDt != null and sRegEndDt != null'>
                               AND REG_DT <![CDATA[>=]]> #{sRegStartDt}
                               AND REG_DT <![CDATA[<=]]> #{sRegEndDt}
                           </if>
                           <if test='sVocTpCd   != null and sVocTpCd   != ""'> AND VOC_TP_CD   = #{sVocTpCd}   </if>
                           <if test='sVocStatCd != null and sVocStatCd != ""'> AND VOC_STAT_CD = #{sVocStatCd} </if>
                           <if test='sCmplCauCd != null and sCmplCauCd != ""'> AND CMPL_CAU_CD = #{sCmplCauCd} </if>) AS VOC_CNT1
                        ,(SELECT COUNT(DECODE(VOC_TP_CD,'02',1))
                            FROM CR_0601T
                           WHERE 1 = 1
                           <if test='sRegStartDt != null and sRegEndDt != null'>
                               AND REG_DT <![CDATA[>=]]> #{sRegStartDt}
                               AND REG_DT <![CDATA[<=]]> #{sRegEndDt}
                           </if>
                           <if test='sVocTpCd   != null and sVocTpCd   != ""'> AND VOC_TP_CD   = #{sVocTpCd}   </if>
                           <if test='sVocStatCd != null and sVocStatCd != ""'> AND VOC_STAT_CD = #{sVocStatCd} </if>
                           <if test='sCmplCauCd != null and sCmplCauCd != ""'> AND CMPL_CAU_CD = #{sCmplCauCd} </if>) AS VOC_CNT2
                        ,(SELECT COUNT(DECODE(VOC_TP_CD,'03',1))
                            FROM CR_0601T
                           WHERE 1 = 1
                           <if test='sRegStartDt != null and sRegEndDt != null'>
                               AND REG_DT <![CDATA[>=]]> #{sRegStartDt}
                               AND REG_DT <![CDATA[<=]]> #{sRegEndDt}
                           </if>
                           <if test='sVocTpCd   != null and sVocTpCd   != ""'> AND VOC_TP_CD   = #{sVocTpCd}   </if>
                           <if test='sVocStatCd != null and sVocStatCd != ""'> AND VOC_STAT_CD = #{sVocStatCd} </if>
                           <if test='sCmplCauCd != null and sCmplCauCd != ""'> AND CMPL_CAU_CD = #{sCmplCauCd} </if>) AS VOC_CNT3
                        ,(SELECT COUNT(DECODE(VOC_TP_CD,'04',1))
                            FROM CR_0601T
                           WHERE 1 = 1
                           <if test='sRegStartDt != null and sRegEndDt != null'>
                               AND REG_DT <![CDATA[>=]]> #{sRegStartDt}
                               AND REG_DT <![CDATA[<=]]> #{sRegEndDt}
                           </if>
                           <if test='sVocTpCd   != null and sVocTpCd   != ""'> AND VOC_TP_CD   = #{sVocTpCd}   </if>
                           <if test='sVocStatCd != null and sVocStatCd != ""'> AND VOC_STAT_CD = #{sVocStatCd} </if>
                           <if test='sCmplCauCd != null and sCmplCauCd != ""'> AND CMPL_CAU_CD = #{sCmplCauCd} </if>) AS VOC_CNT4
                        ,(SELECT COUNT(DECODE(VOC_TP_CD,'05',1))
                            FROM CR_0601T
                           WHERE 1 = 1
                           <if test='sRegStartDt != null and sRegEndDt != null'>
                               AND REG_DT <![CDATA[>=]]> #{sRegStartDt}
                               AND REG_DT <![CDATA[<=]]> #{sRegEndDt}
                           </if>
                           <if test='sVocTpCd   != null and sVocTpCd   != ""'> AND VOC_TP_CD   = #{sVocTpCd}   </if>
                           <if test='sVocStatCd != null and sVocStatCd != ""'> AND VOC_STAT_CD = #{sVocStatCd} </if>
                           <if test='sCmplCauCd != null and sCmplCauCd != ""'> AND CMPL_CAU_CD = #{sCmplCauCd} </if>) AS VOC_CNT5
             FROM DMSDB.CR_0601T CR_0601T    --VOC마스터
            <where>
                AND CR_0601T.DLR_CD = #{sDlrCd}
                <if test='sRegStartDt != null and sRegEndDt != null'>
                    AND CR_0601T.REG_DT <![CDATA[>=]]> #{sRegStartDt}
                    AND CR_0601T.REG_DT <![CDATA[<=]]> #{sRegEndDt}
                </if>
                <if test='sVocTpCd   != null and sVocTpCd   != ""'> AND CR_0601T.VOC_TP_CD   = #{sVocTpCd}   </if>
                <if test='sVocStatCd != null and sVocStatCd != ""'> AND CR_0601T.VOC_STAT_CD = #{sVocStatCd} </if>
                <if test='sCmplCauCd != null and sCmplCauCd != ""'> AND CR_0601T.CMPL_CAU_CD = #{sCmplCauCd} </if>
                <if test='sPprocDeptNm != null and sPprocDeptNm != ""'> AND CR_0601T.PPROC_DEPT_NM = #{sPprocDeptNm} </if>
                <if test='sAssignYn != null and sAssignYn != ""'>
                    <if test='sAssignYn == "Y"'>
                         AND CR_0601T.PPROC_ID IS NOT NULL           -- 처리담당자 배정
                    </if >
                    <if test='sAssignYn == "N"'>
                         AND CR_0601T.PPROC_ID IS NULL               -- 처리담당자 미배정
                    </if>
                </if>
            </where>
            ORDER BY
            <choose>
                <when test='sort != null'>
                    <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                        <choose>
                            <when test='item.field == "vocNo"'>                  CR_0601T.VOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                 </when>
                            <when test='item.field == "vocStatCd"'>              CR_0601T.VOC_STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "vocTpCd"'>                CR_0601T.VOC_TP_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>              </when>
                            <when test='item.field == "tendCd"'>                 CR_0601T.TEND_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "vocTpSub1Cd"'>            CR_0601T.VOC_TP_SUB1_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "vocTpSub2Cd"'>            CR_0601T.VOC_TP_SUB2_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "vocTpSub3Cd"'>            CR_0601T.VOC_TP_SUB3_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "acptSrcCd"'>              CR_0601T.ACPT_SRC_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "activeGainPathCd"'>       CR_0601T.ACTIVE_GAIN_PATH_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                            <when test='item.field == "cmplCauCd"'>              CR_0601T.CMPL_CAU_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "prorCd"'>                 CR_0601T.PROR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "procLmtCd"'>              CR_0601T.PROC_LMT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "emgcCallCd"'>             CR_0601T.EMGC_CALL_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "emgcRescStartYn"'>        CR_0601T.EMGC_RESC_START_YN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                            <when test='item.field == "cauCd"'>                  CR_0601T.CAU_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                 </when>
                            <when test='item.field == "emgcRescStsfCd"'>         CR_0601T.EMGC_RESC_STSF_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                            <when test='item.field == "vocEndDt"'>               CR_0601T.VOC_END_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "receiveTelNo"'>           CR_0601T.RECEIVE_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "custNm"'>                 CR_0601T.CUST_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "custNo"'>                 CR_0601T.CUST_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "custPrefCommNo"'>         CR_0601T.CUST_PREF_COMM_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                            <when test='item.field == "hpNo"'>                   CR_0601T.HP_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                  </when>
                            <when test='item.field == "homeTelNo"'>              CR_0601T.HOME_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "officeTelNo"'>            CR_0601T.OFFICE_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "pconCustNm"'>             CR_0601T.PCON_CUST_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "pconCustNo"'>             CR_0601T.PCON_CUST_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "pconCustMjrTelNo"'>       CR_0601T.PCON_CUST_MJR_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                            <when test='item.field == "pconCustHpNo"'>           CR_0601T.PCON_CUST_HP_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                            <when test='item.field == "pconCustHomeTelNo"'>      CR_0601T.PCON_CUST_HOME_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>  </when>
                            <when test='item.field == "pconCustOfficeTelNo"'>    CR_0601T.PCON_CUST_OFFICE_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                            <when test='item.field == "resvDt"'>                 CR_0601T.RESV_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "sendTelNo"'>              CR_0601T.SEND_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "pconRelCd"'>              CR_0601T.PCON_REL_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "pprocDeptNm"'>            CR_0601T.PPROC_DEPT_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "pprocId"'>                CR_0601T.PPROC_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>               </when>
                            <when test='item.field == "coopDeptNm"'>             CR_0601T.COOP_DEPT_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "bizDeptNm"'>              CR_0601T.BIZ_DEPT_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "officeNm"'>               CR_0601T.OFFICE_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>              </when>
                            <when test='item.field == "sungCd"'>                 CR_0601T.SUNG_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "sungNm"'>                 CR_0601T.SUNG_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "cityCd"'>                 CR_0601T.CITY_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "cityNm"'>                 CR_0601T.CITY_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "vinNo"'>                  CR_0601T.VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                 </when>
                            <when test='item.field == "carRegNo"'>               CR_0601T.CAR_REG_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "carlineCd"'>              CR_0601T.CARLINE_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "carlineNm"'>              CR_0601T.CARLINE_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "modelCd"'>                CR_0601T.MODEL_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>               </when>
                            <when test='item.field == "modelNm"'>                CR_0601T.MODEL_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>               </when>
                            <when test='item.field == "ocnCd"'>                  CR_0601T.OCN_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                 </when>
                            <when test='item.field == "ocnNm"'>                  CR_0601T.OCN_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                 </when>
                            <when test='item.field == "runDistVal"'>             CR_0601T.RUN_DIST_VAL <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "acptDeptNm"'>             CR_0601T.ACPT_DEPT_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "pacptId"'>                CR_0601T.PACPT_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>               </when>
                            <when test='item.field == "acptDt"'>                 CR_0601T.ACPT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "custReqCont"'>            CR_0601T.CUST_REQ_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "custRescLocCont"'>        CR_0601T.CUST_RESC_LOC_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                            <when test='item.field == "pevalId"'>                CR_0601T.PEVAL_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>               </when>
                            <when test='item.field == "evalAllocDt"'>            CR_0601T.EVAL_ALLOC_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "callCenOpnCont"'>         CR_0601T.CALL_CEN_OPN_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                            <when test='item.field == "returnCauCont"'>          CR_0601T.RETURN_CAU_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                            <when test='item.field == "pmoCauCd"'>               CR_0601T.PMO_CAU_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "pmoDt"'>                  CR_0601T.PMO_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                 </when>
                            <when test='item.field == "revMthCont"'>             CR_0601T.REV_MTH_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "realPprocId"'>            CR_0601T.REAL_PPROC_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "procDt"'>                 CR_0601T.PROC_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "pprocTelNo"'>             CR_0601T.PPROC_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "pprocEmailNm"'>           CR_0601T.PPROC_EMAIL_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "procRsltCont"'>           CR_0601T.PROC_RSLT_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "stsfIvstEmpId"'>          CR_0601T.STSF_IVST_EMP_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                            <when test='item.field == "stsfIvstDt"'>             CR_0601T.STSF_IVST_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "stsfIvstRsltCont"'>       CR_0601T.STSF_IVST_RSLT_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                            <when test='item.field == "mthAchvHm"'>              CR_0601T.MTH_ACHV_HM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "cmplStsfCd"'>             CR_0601T.CMPL_STSF_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                            <when test='item.field == "cmplReAcptYn"'>           CR_0601T.CMPL_RE_ACPT_YN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                            <when test='item.field == "cmplReAcptCnt"'>          CR_0601T.CMPL_RE_ACPT_CNT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                            <when test='item.field == "serReqNo"'>               CR_0601T.SER_REQ_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "cmplDlDeptNm"'>           CR_0601T.CMPL_DL_DEPT_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                            <when test='item.field == "cmplDlEmpId"'>            CR_0601T.CMPL_DL_EMP_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "saleDt"'>                 CR_0601T.SALE_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "dstbNo"'>                 CR_0601T.DSTB_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "parOrdYn"'>               CR_0601T.PAR_ORD_YN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "parOrdDt"'>               CR_0601T.PAR_ORD_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "parArrvDt"'>              CR_0601T.PAR_ARRV_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "itemCd"'>                 CR_0601T.ITEM_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "bhmcYn"'>                 CR_0601T.BHMC_YN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <when test='item.field == "bhmcVocNo"'>              CR_0601T.BHMC_VOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "regUsrId"'>               CR_0601T.REG_USR_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                            <when test='item.field == "regDt"'>                  CR_0601T.REG_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                 </when>
                            <when test='item.field == "updtUsrId"'>              CR_0601T.UPDT_USR_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                            <when test='item.field == "updtDt"'>                 CR_0601T.UPDT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>                </when>
                            <otherwise>
                            CR_0601T.VOC_NO ASC
                            </otherwise>
                        </choose>
                    </foreach>
                </when>
                <otherwise>
                CR_0601T.VOC_NO ASC
                </otherwise>
            </choose>
            ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- VOC 정보 목록수를 조회한다. -->
    <select id="selectVocMgmtsByConditionCnt" parameterType="VocMgmtSearchVO" resultType="int">
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.selectVocMgmtsByConditionCnt] */
        SELECT COUNT(*) AS VALUE
        FROM DMSDB.CR_0601T CR_0601T    --VOC마스터
        <where>
            AND CR_0601T.DLR_CD = #{sDlrCd}
            <if test='sRegStartDt != null and sRegEndDt != null'>
                AND CR_0601T.REG_DT <![CDATA[>=]]> #{sRegStartDt}
                AND CR_0601T.REG_DT <![CDATA[<=]]> #{sRegEndDt}
            </if>
            <if test='sVocTpCd   != null and sVocTpCd   != ""'> AND CR_0601T.VOC_TP_CD   = #{sVocTpCd}   </if>
            <if test='sVocStatCd != null and sVocStatCd != ""'> AND CR_0601T.VOC_STAT_CD = #{sVocStatCd} </if>
            <if test='sCmplCauCd != null and sCmplCauCd != ""'> AND CR_0601T.CMPL_CAU_CD = #{sCmplCauCd} </if>
            <if test='sPprocDeptNm != null and sPprocDeptNm != ""'> AND CR_0601T.PPROC_DEPT_NM = #{sPprocDeptNm} </if>
            <if test='sAssignYn != null and sAssignYn != ""'>
                <if test='sAssignYn == "Y"'>
                     AND CR_0601T.PPROC_ID IS NOT NULL           -- 처리담당자 배정
                </if >
                <if test='sAssignYn == "N"'>
                     AND CR_0601T.PPROC_ID IS NULL               -- 처리담당자 미배정
                </if>
            </if>
        </where>
    </select>

    <!-- 상태 데이터를 조회한다. 공통으로 DropdownList에서 쓰기위함. (중복 모델 display 방지)  -->
    <select id="selectVocTpCdListByCondition" parameterType="VocMgmtSearchVO" resultType="VocMgmtVO">
        SELECT CMM_CD, CMM_CD_NM
          FROM CM_0303T
         WHERE CMM_GRP_CD IN ('CRM610','CRM611','CRM612','CRM613','CRM614')
           AND USE_YN = 'Y'
           AND REMARK1 = #{cmmCd}
         ORDER BY SORT_ORDER
    </select>

    <!-- 성코드 데이터를 조회한다. 공통으로 DropdownList에서 쓰기위함. (중복 모델 display 방지)  -->
    <select id="selectSungCdListByCondition" parameterType="VocMgmtSearchVO" resultType="VocMgmtVO">
        SELECT SUNG_CD, SUNG_NM
          FROM CM_0205T
         WHERE USE_YN = 'Y'
         GROUP BY SUNG_CD, SUNG_NM
         ORDER BY SUNG_CD, SUNG_NM
    </select>

    <!-- 도시코드 데이터를 조회한다. 공통으로 DropdownList에서 쓰기위함. (중복 모델 display 방지)  -->
    <select id="selectCityCdListByCondition" parameterType="VocMgmtSearchVO" resultType="VocMgmtVO">
        SELECT CITY_CD, CITY_NM
          FROM CM_0205T
         WHERE USE_YN = 'Y'
           AND SUNG_CD = #{cmmCd}
         GROUP BY CITY_CD, CITY_NM
         ORDER BY CITY_CD, CITY_NM
    </select>



    <!-- VOC활동 정보 목록을 조회한다. -->
    <select id="selectActivesByCondition" parameterType="VocMgmtSearchVO" resultType="VocMgmtVO">
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.selectActivesByCondition] */
        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT
                         CR_0602T.DLR_CD                  --딜러코드
                        ,CR_0602T.VOC_ACTIVE_NO           --VOC활동번호
                        ,CR_0602T.VOC_NO                  --VOC번호
                        ,CR_0602T.CUST_NO                 --고객번호
                        ,(SELECT CUST_NM FROM CR_0101T WHERE DLR_CD = CR_0602T.DLR_CD AND CUST_NO = CR_0602T.CUST_NO) AS CUST_NM
                        ,CR_0602T.PCON_CUST_NO            --연계인고객번호
                        ,(SELECT CUST_NM FROM CR_0101T WHERE DLR_CD = CR_0602T.DLR_CD AND CUST_NO = CR_0602T.PCON_CUST_NO) AS PCON_CUST_NM
                        ,CR_0602T.ACTIVE_STAT_CD          --활동상태코드
                        ,CR_0602T.ACTIVE_TP_CD            --활동유형코드
                        ,CR_0602T.ACTIVE_TP_SUB_CD        --활동유형하위코드
                        ,CR_0602T.ACTIVE_RSLT_CONT        --활동결과내용
                        ,CR_0602T.ACTIVE_CD               --활동코드
                        ,CR_0602T.START_DT                --시작일자
                        ,CR_0602T.END_DT                  --종료일자
                        ,CR_0602T.PGSS_HM                 --진행시간
                        ,CR_0602T.EXPC_START_DT           --예정시작일자
                        ,CR_0602T.EXPC_END_DT             --예정종료일자
                        ,CR_0602T.PROR_CD                 --우선순위코드
                        ,CR_0602T.REG_DEPT_NM             --등록부서명
                        ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = CR_0602T.REG_USR_ID) AS REG_USR_ID --등록자ID
                        ,CR_0602T.REG_DT                  --등록일자
                        ,CR_0602T.UPDT_USR_ID             --수정자ID
                        ,CR_0602T.UPDT_DT                 --수정일자
            FROM DMSDB.CR_0602T CR_0602T    --VOC활동처리정보
            <where>
                AND CR_0602T.DLR_CD = #{sDlrCd}           --딜러코드
                AND CR_0602T.VOC_NO = #{sVocNo}           --VOC번호
            </where>
            ORDER BY
            <choose>
                <when test='sort != null'>
                    <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                        <choose>
                            <when test='item.field == "vocActiveNo"'>     CR_0602T.VOC_ACTIVE_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                            <when test='item.field == "vocNo"'>           CR_0602T.VOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "custNo"'>          CR_0602T.CUST_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "pconCustNo"'>      CR_0602T.PCON_CUST_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                            <when test='item.field == "activeStatCd"'>    CR_0602T.ACTIVE_STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>  </when>
                            <when test='item.field == "activeTpCd"'>      CR_0602T.ACTIVE_TP_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                            <when test='item.field == "activeTpSubCd"'>   CR_0602T.ACTIVE_TP_SUB_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                            <when test='item.field == "activeRsltCont"'>  CR_0602T.ACTIVE_RSLT_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                            <when test='item.field == "activeCd"'>        CR_0602T.ACTIVE_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                            <when test='item.field == "startDt"'>         CR_0602T.START_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                            <when test='item.field == "endDt"'>           CR_0602T.END_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "pgssHm"'>          CR_0602T.PGSS_HM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "expcStartDt"'>     CR_0602T.EXPC_START_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                            <when test='item.field == "expcEndDt"'>       CR_0602T.EXPC_END_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                            <when test='item.field == "prorCd"'>          CR_0602T.PROR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <when test='item.field == "regDeptNm"'>       CR_0602T.REG_DEPT_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                            <when test='item.field == "regUsrId"'>        CR_0602T.REG_USR_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                            <when test='item.field == "regDt"'>           CR_0602T.REG_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                            <when test='item.field == "updtUsrId"'>       CR_0602T.UPDT_USR_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                            <when test='item.field == "updtDt"'>          CR_0602T.UPDT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                            <otherwise>
                            CR_0602T.VOC_ACTIVE_NO ASC
                            </otherwise>
                        </choose>
                    </foreach>
                </when>
                <otherwise>
                CR_0602T.VOC_ACTIVE_NO ASC
                </otherwise>
            </choose>
            ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- VOC활동 정보 목록수를 조회한다. -->
    <select id="selectActivesByConditionCnt" parameterType="VocMgmtSearchVO" resultType="int">
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.selectActivesByConditionCnt] */
        SELECT COUNT(*) AS VALUE
        FROM DMSDB.CR_0602T CR_0602T    --VOC활동처리정보
        <where>
            AND CR_0602T.DLR_CD = #{sDlrCd}       --딜러코드
            AND CR_0602T.VOC_NO = #{sVocNo}       --VOC번호
        </where>
    </select>

    <!-- VOC활동 정보를 등록한다. -->
    <insert id="insertActive" parameterType="VocMgmtVO" >
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.insertActive] */
        INSERT INTO DMSDB.CR_0602T    --VOC활동처리정보
        (
         DLR_CD                  --딜러코드
        ,VOC_ACTIVE_NO           --VOC활동번호
        ,VOC_NO                  --VOC번호
        ,CUST_NO                 --고객번호
        ,PCON_CUST_NO            --연계인고객번호
        ,ACTIVE_STAT_CD          --활동상태코드
        ,ACTIVE_TP_CD            --활동유형코드
        ,ACTIVE_TP_SUB_CD        --활동유형하위코드
        ,ACTIVE_RSLT_CONT        --활동결과내용
        ,ACTIVE_CD               --활동코드
        ,START_DT                --시작일자
        ,END_DT                  --종료일자
        ,PGSS_HM                 --진행시간
        ,EXPC_START_DT           --예정시작일자
        ,EXPC_END_DT             --예정종료일자
        ,PROR_CD                 --우선순위코드
        ,REG_DEPT_NM             --등록부서명
        ,REG_USR_ID              --등록자ID
        ,REG_DT                  --등록일자
        ,UPDT_USR_ID             --수정자ID
        ,UPDT_DT                 --수정일자
        )
        VALUES
        (
         #{dlrCd}                  --딜러코드
        ,SEQ_CR_0602T.NEXTVAL      --VOC활동번호
        ,#{vocNo}                  --VOC번호
        ,#{custNo}                 --고객번호
        ,#{pconCustNo}             --연계인고객번호
        ,#{activeStatCd}           --활동상태코드
        ,#{activeTpCd}             --활동유형코드
        ,#{activeTpSubCd}          --활동유형하위코드
        ,#{activeRsltCont}         --활동결과내용
        ,#{activeCd}               --활동코드
        ,#{startDt}                --시작일자
        ,#{endDt}                  --종료일자
        ,#{pgssHm}                 --진행시간
        ,#{expcStartDt}            --예정시작일자
        ,#{expcEndDt}              --예정종료일자
        ,#{prorCd}                 --우선순위코드
        ,#{regDeptNm}              --등록부서명
        ,#{regUsrId}               --등록자ID
        ,SYSDATE                   --등록일자
        ,#{updtUsrId}              --수정자ID
        ,SYSDATE                   --수정일자
        )
    </insert>

    <!-- VOC활동 정보를 수정한다. -->
    <update id="updateActive" parameterType="VocMgmtVO" >
        /* [chn.bhmc.dms.crm.crq.service.dao.VocMgmtDAO.updateActive] */
        UPDATE DMSDB.CR_0602T    --VOC활동처리정보
        SET
         CUST_NO          = #{custNo}                 --고객번호
        ,PCON_CUST_NO     = #{pconCustNo}             --연계인고객번호
        ,ACTIVE_STAT_CD   = #{activeStatCd}           --활동상태코드
        ,ACTIVE_TP_CD     = #{activeTpCd}             --활동유형코드
        ,ACTIVE_TP_SUB_CD = #{activeTpSubCd}          --활동유형하위코드
        ,ACTIVE_RSLT_CONT = #{activeRsltCont}         --활동결과내용
        ,ACTIVE_CD        = #{activeCd}               --활동코드
        ,START_DT         = #{startDt}                --시작일자
        ,END_DT           = #{endDt}                  --종료일자
        ,PGSS_HM          = #{pgssHm}                 --진행시간
        ,EXPC_START_DT    = #{expcStartDt}            --예정시작일자
        ,EXPC_END_DT      = #{expcEndDt}              --예정종료일자
        ,PROR_CD          = #{prorCd}                 --우선순위코드
        ,REG_DEPT_NM      = #{regDeptNm}              --등록부서명
        ,UPDT_USR_ID      = #{updtUsrId}              --수정자ID
        ,UPDT_DT          = SYSDATE                   --수정일자
        WHERE 1 = 1
        AND DLR_CD        = #{dlrCd}                  --딜러코드
        AND VOC_NO        = #{vocNo}                  --VOC번호
        AND VOC_ACTIVE_NO = #{vocActiveNo}            --VOC활동번호
    </update>

</mapper>