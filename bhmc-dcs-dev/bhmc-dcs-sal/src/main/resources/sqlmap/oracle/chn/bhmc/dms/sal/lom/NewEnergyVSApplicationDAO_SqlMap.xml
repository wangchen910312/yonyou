<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="chn.bhmc.dms.sal.lom.service.dao.NewEnergyVSApplicationDAO">

	<!-- 이월판매취소 목록  -->
	<select id="selectNewEnergyVSApplicationByCondition" parameterType="NewEnergyVSApplicationSearchVO" resultType="NewEnergyVSApplicationVO">
         SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT 
                  A.DLR_CD,
        A.APPLICATION_NO,
        A.CUST_NM,
        A.HP_NO,
        A.MATH_DOC_TP,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'CRM024'    
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.MATH_DOC_TP)MATH_DOC_TP_STR,
        A.SSN_CRN_NO,
        <!--  R19082701043 张伟丽提报：DCS新能源补贴审批画面，最后一列加一个“审批人“ 贾明 2019-8-28 start -->
        A.REVIEWER_ID,
        A.REVIEWER_NM,
        <!--  R19082701043 张伟丽提报：DCS新能源补贴审批画面，最后一列加一个“审批人“ 贾明 2019-8-28 end -->
        A.ADDR_DETL_CONT,
        <!--  R20032400090 张伟丽反馈：dcs新能源补贴申请审核画面，下载的excel中，车型代码 SQ EV 显示空白 2020-3-30 start -->
        FN_CMM_CD_NM('COM083',A.MODEL_CD, #{sLangCd} ,'N') AS MODEL_NM,
        <!--  R20032400090 张伟丽反馈：dcs新能源补贴申请审核画面，下载的excel中，车型代码 SQ EV 显示空白 2020-3-30  end -->
        <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 START -->
        (SELECT B.ORD_TP FROM SA_0121T B WHERE B.VIN_NO = A.VIN_NO) AS ORD_TP,
        (SELECT  FN_CMM_CD_NM('SAL137',B.ORD_TP, #{sLangCd} ,'Y')  FROM SA_0121T B WHERE B.VIN_NO = A.VIN_NO) AS ORD_TP_NM,
        <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 END -->
        A.OFFICE_NM,
        A.PERNAME,
        A.PERPHON,
        A.REG_NO,
        A.OFFICE_ADS,
        A.OWN_RGST_NM,
        A.OWN_RGST_TEL_NO,
        A.MODEL_CD,
        A.VIN_NO,
        A.WEHICLE_USE, 
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = (
                   decode(A.CUST_TP,'01','COM077','02','COM076')
                   )   
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.WEHICLE_USE)WEHICLE_USE_STR,
        A.CAR_REG_NO,
        A.CAR_REG_COLOR,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'COM080'   
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.CAR_REG_COLOR)CAR_REG_COLOR_STR,
        B.DLR_NM AS dlrNm,
        A.DLR_CD AS dlrCd,                     
        A.MAKER_CD,
        A.DRIVE_PERMIT_NO,
        A.CAR_REG_CITY,
        A.DRIV_LICENSE_DT,
        TO_CHAR(A.DRIV_LICENSE_DT,'YYYY-MM-DD') DRIV_LICENSE_DT_STR,
        A.PURC_PAY_NO,
        A.INSUR_NO,
        A.CAR_REGI_NO,
        A.CAR_REGI_DT,
        TO_CHAR(A.CAR_REGI_DT,'YYYY-MM-DD') CAR_REGI_DT_STR,
        A.INVO_CO,
        A.INVO_NO,
        A.INVO_MN,
        A.INVO_DT,
        TO_CHAR(A.INVO_DT,'YYYY-MM-DD') INVO_DT_STR,
        A.ENCL,
        A.REMAREK,
        A.REASON,
        A.APPL_DT,
        TO_CHAR(A.APPL_DT,'YYYY-MM-DD') APPL_DT_STR,
        A.STATUS_NO,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'COM079'    /*차량상태*/
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.STATUS_NO)STATUS_NO_STR,
        A.AUDIT_DT,
        TO_CHAR(A.AUDIT_DT,'YYYY-MM-DD') AUDIT_DT_STR,
        A.CAR_BUY_AREA,
        --(select CMM_CD_NM from CM_0303t where CMM_GRP_CD='COM081'  and CMM_CD = CAR_BUY_AREA)CAR_BUY_AREA_STR,
       (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'CRM001'    /*차량상태*/
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.CAR_BUY_AREA)CAR_BUY_AREA_STR,
        A.HEAD_FILE_DOCID,
        A.NEW_ENTER_FILE_NO,
        A.CUST_TP,
        A.ADDRESS_CHARGING_CAR,
        A.HUMAN_PROPERTY_TYPE,
        (SELECT DIVI_NM FROM  CM_2501T 
        WHERE DIVI_CD = (select SDPT_CD from cm_0101t where dlr_cd = A.dlr_cd))SYB_STAR,
        (SELECT ( SELECT OFF_NM FROM CM_2601T Y
	               WHERE Y.DIVI_CD = C.SDPT_CD
	               AND Y.OFF_CD = C.DIST_OFFICE_CD
                 )FROM cm_0101t C WHERE C.DLR_CD = A.DLR_CD ) BSC_STAR,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'COM082'    /*차량상태*/
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.HUMAN_PROPERTY_TYPE) HUMAN_PROPERTY_TYPE_STR,
                   A.EIGHT_FIELDS,                                                                <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015 -->
                   FN_CMM_CD_NM('SAL015',A.EIGHT_FIELDS,#{sLangCd},'N') AS  EIGHT_FIELDZ,         <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015 -->
                   A.WH_EIGHT_FIELDS,                                                             <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 是否八大领域 Y 是，N 否 -->
                   FN_CMM_CD_NM('COM020',A.WH_EIGHT_FIELDS,#{sLangCd},'N') AS  WH_EIGHT_FIELDZ   <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 是否八大领域 Y 是，N 否 -->
                  from SA_0506T A,CM_0101T B
		   <!-- chenming 2019-9-16 在审核画面增加每辆车的最新补贴状态 start   -->
                   <if test='appliRecode != null and appliRecode != "" and appliRecode == "LAST"'> 
                       ,(SELECT ROW_NUMBER() OVER(PARTITION BY VIN_NO ORDER BY APPLICATION_NO DESC) NO,
                               VIN_NO,
                               APPLICATION_NO
                          FROM SA_0506T) T
          			</if>
                 WHERE 1=1 and B.DLR_CD = A.DLR_CD 
                  <if test='appliRecode != null and appliRecode != "" and appliRecode == "LAST"'>  
                   AND A.VIN_NO = T.VIN_NO
                   AND A.APPLICATION_NO = T.APPLICATION_NO
                   AND T.NO = 1
                  </if>
		   <!-- chenming 2019-9-16 在审核画面增加每辆车的最新补贴状态 end   -->
                 <if test='sApplicationNo != null and sApplicationNo != ""'>
                  AND A.APPLICATION_NO LIKE '%' || #{sApplicationNo} || '%'  
                 </if>
                 <if test='custTp != null and custTp != ""'>
                  AND A.CUST_TP = #{custTp}
                 </if>
                 <if test='custNm != null and custNm != ""'>
                   AND (A.CUST_NM  LIKE  '%' || #{custNm} || '%' OR  A.PERNAME LIKE  '%' || #{custNm} || '%')
                 </if>
                 <if test='hpNo != null and hpNo != ""'>
                   AND (A.HP_NO LIKE '%' || #{hpNo} || '%' OR A.PERPHON LIKE '%' || #{hpNo} || '%')
                 </if>
                 <if test='applStart != null and applStart != ""'>
                   AND TO_CHAR(A.APPL_DT,'YYYYMMDD') <![CDATA[>=]]> #{applStart}
                 </if>
                 <if test='applEnd != null and applEnd != ""'>
                   AND TO_CHAR(A.APPL_DT,'YYYYMMDD') <![CDATA[<=]]> #{applEnd}
                 </if>
                 <if test='invoStart != null and invoStart != ""'>
                   AND TO_CHAR(A.INVO_DT,'YYYYMMDD') <![CDATA[>=]]> #{invoStart}
                 </if>
                 <if test='invoEnd != null and invoEnd != ""'>
                   AND TO_CHAR(A.INVO_DT,'YYYYMMDD') <![CDATA[<=]]> #{invoEnd}
                 </if>
                 <if test='statusNo != null and statusNo != ""'>
                   AND A.STATUS_NO = #{statusNo}
                 </if>
                 <if test='vinNo != null and vinNo != ""'>
                  AND A.VIN_NO    LIKE '%'|| #{vinNo}||'%' <!--  = #{vinNo} 张伟丽老师反馈希望DCS新能源车辆补贴申请界面新增查询条件车架号 R19081500618 贾明 2019-8-16 -->
                 </if>
                 <if test='dlrNm != null and dlrNm != ""'>
                   AND B.DLR_NM LIKE '%' || #{dlrNm} || '%' 
                 </if>
                 <if test='dlrCd != null and dlrCd != ""'>
                   AND A.DLR_CD LIKE '%' || #{dlrCd} || '%' 
                 </if>
                 <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 START -->
                 <if test='sDiviCd != null and sDiviCd != ""'>
                   AND B.SDPT_CD = #{sDiviCd}
                 </if>
                 <if test='sOffCd != null and sOffCd != ""'>
                   AND B.DIST_OFFICE_CD = #{sOffCd}
                 </if>
                 <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型 贾明 2020-3-30 end -->
                 
                 <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015  start -->
                 <if test='sEightFields != null and sEightFields != ""'>
                   AND A.EIGHT_FIELDS = #{sEightFields}
                 </if>
                 <if test='sWhEightFields != null and sWhEightFields != ""'>
                   AND A.WH_EIGHT_FIELDS = #{sWhEightFields}
                 </if>
                 <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015  end -->
        ORDER BY 
        <choose>
            <when test='sort != null'>
                <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                    <choose>
                        <when test='item.field == "applicationNo"'>A.APPLICATION_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "applDt"'>A.APPL_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "vinNo"'>A.VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "modelCd"'>A.MODEL_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "officeNm"'>A.OFFICE_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "dlrCd"'>A.DLR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "dlrNm"'>B.DLR_NM<choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "ownRgstNm"'>A.OWN_RGST_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "statusNo"'>A.STATUS_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "hpNo"'>A.HP_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "carBuyArea"'>A.CAR_BUY_AREA <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "wehicleUse"'>A.WEHICLE_USE <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "carRegCity"'>A.CAR_REG_COLOR <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "officeAds"'>A.OFFICE_ADS <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "invoMn"'>A.INVO_MN <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "carRegiDt"'>A.CAR_REGI_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "auditDt"'>A.AUDIT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "invoDt"'>A.INVO_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "ownRgstTelNo"'>A.OWN_RGST_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "custNm"'>A.CUST_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "addrDetlCont"'>A.ADDR_DETL_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "sybStar"'>SYB_STAR <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "reviewerNm"'>A.REVIEWER_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <otherwise>
                            A.APPLICATION_NO DESC NULLS LAST
                        </otherwise>
                    </choose>
                </foreach>
            </when>
            <otherwise>
                A.APPLICATION_NO DESC
            </otherwise>
        </choose>
             ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
	</select>

	<!-- 이월판매취소 목록 갯수  -->
	<select id="selectNewEnergyVSApplicationByConditionCnt" parameterType="NewEnergyVSApplicationSearchVO" resultType="int">
        SELECT COUNT(*) AS VALUE
          FROM SA_0506T A
           <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 START -->
          ,CM_0101T B
          <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 END -->
	   <!-- chenming 2019-9-16 在审核画面增加每辆车的最新补贴状态 start   -->
          <if test='appliRecode != null and appliRecode != "" and appliRecode == "LAST"'> 
                       ,(SELECT ROW_NUMBER() OVER(PARTITION BY VIN_NO ORDER BY APPLICATION_NO DESC) NO,
                               VIN_NO,
                               APPLICATION_NO
                          FROM SA_0506T) T
          </if>
         
         WHERE 1=1
         <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 START -->
         and B.DLR_CD = A.DLR_CD
         <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 END -->
        
                 <if test='appliRecode != null and appliRecode != "" and appliRecode == "LAST"'>  
                   AND A.VIN_NO = T.VIN_NO
                   AND A.APPLICATION_NO = T.APPLICATION_NO
                   AND T.NO = 1
                  </if> 
	 <!-- chenming 2019-9-16 在审核画面增加每辆车的最新补贴状态 end   -->	  
         <if test='sApplicationNo != null and sApplicationNo != ""'>
                  AND A.APPLICATION_NO LIKE '%' || #{sApplicationNo} || '%'  
                 </if>
                 <if test='custTp != null and custTp != ""'>
                  AND A.CUST_TP = #{custTp}
                 </if>
                 <if test='custNm != null and custNm != ""'>
                   AND (A.CUST_NM  LIKE  '%' || #{custNm} || '%' OR  A.PERNAME LIKE  '%' || #{custNm} || '%')
                 </if>
                 <if test='hpNo != null and hpNo != ""'>
                   AND (A.HP_NO LIKE '%' || #{hpNo} || '%' OR A.PERPHON LIKE '%' || #{hpNo} || '%')
                 </if>
                 <if test='applStart != null and applStart != ""'>
                   AND TO_CHAR(A.APPL_DT,'YYYYMMDD') <![CDATA[>=]]> #{applStart}
                 </if>
                 <if test='applEnd != null and applEnd != ""'>
                   AND TO_CHAR(A.APPL_DT,'YYYYMMDD') <![CDATA[<=]]> #{applEnd}
                 </if>
                 <if test='invoStart != null and invoStart != ""'>
                   AND TO_CHAR(A.INVO_DT,'YYYYMMDD') <![CDATA[>=]]> #{invoStart}
                 </if>
                 <if test='invoEnd != null and invoEnd != ""'>
                   AND TO_CHAR(A.INVO_DT,'YYYYMMDD') <![CDATA[<=]]> #{invoEnd}
                 </if>
                 <if test='statusNo != null and statusNo != ""'>
                   AND A.STATUS_NO = #{statusNo}
                 </if>
                 <if test='vinNo != null and vinNo != ""'>
                   AND A.VIN_NO    LIKE '%'|| #{vinNo}||'%' <!--  = #{vinNo} 张伟丽老师反馈希望DCS新能源车辆补贴申请界面新增查询条件车架号 R19081500618 贾明 2019-8-16 -->
                 </if>
                 <if test='dlrNm != null and dlrNm != ""'>
                   AND B.DLR_NM LIKE '%' || #{dlrNm} || '%' 
                 </if>
                 <if test='dlrCd != null and dlrCd != ""'>
                   AND A.DLR_CD LIKE '%' || #{dlrCd} || '%' 
                 </if>
                 <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型  贾明 2020-3-30 START -->
                 <if test='sDiviCd != null and sDiviCd != ""'>
                   AND B.SDPT_CD = #{sDiviCd}
                 </if>
                 <if test='sOffCd != null and sOffCd != ""'>
                   AND B.DIST_OFFICE_CD = #{sOffCd}
                 </if>
                 <!-- R20032400090 张伟丽反馈：DCS新能源补贴审核画面，1、查询条件中增加 事业部 、办事处  2、列表中在车架号后面增加  订单类型 贾明 2020-3-30 end -->
                 
                 <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015  start -->
                 <if test='sEightFields != null and sEightFields != ""'>
                   AND A.EIGHT_FIELDS = #{sEightFields}
                 </if>
                 <if test='sWhEightFields != null and sWhEightFields != ""'>
                   AND A.WH_EIGHT_FIELDS = #{sWhEightFields}
                 </if>
                 <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015  end -->
    </select>

    
    <insert id="insertNewEnVSApplication" parameterType="NewEnergyVSApplicationVO">
        /* [chn.bhmc.dms.crm.cif.service.dao.CustomerInfoDAO.insertCustomer] */
        insert into SA_0506T (
        DLR_CD,
        APPLICATION_NO,
        CUST_NM,HP_NO,
        MATH_DOC_TP,
        SSN_CRN_NO,
        ADDR_DETL_CONT,
        OFFICE_NM,
        PERNAME,
        PERPHON,
        REG_NO,
        OFFICE_ADS,
        OWN_RGST_NM,
        OWN_RGST_TEL_NO,MODEL_CD,VIN_NO,WEHICLE_USE, CAR_REG_NO,CAR_REG_COLOR,
        MAKER_CD,
        DRIVE_PERMIT_NO,
        CAR_REG_CITY,
        DRIV_LICENSE_DT,
        PURC_PAY_NO,
        INSUR_NO,
        CAR_REGI_NO,
        CAR_REGI_DT,
        INVO_CO,
        INVO_NO,
        INVO_MN,
        INVO_DT,
        ENCL,
        REMAREK,
        REASON,
        APPL_DT,
        STATUS_NO,
        AUDIT_DT,
        CAR_BUY_AREA,
        HEAD_FILE_DOCID,
        NEW_ENTER_FILE_NO,
        CUST_TP,
        ADDRESS_CHARGING_CAR,
        HUMAN_PROPERTY_TYPE)
 values( #{dlrCd}
         , #{applicationNo}
         , #{custNm}
         , #{hpNo}
         , #{mathDocTp}
         , #{ssnCrnNo}
         , #{addrDetlCont}
         , #{officeNm}
         , #{pername}
         , #{perphon}
         , #{regNo}
         , #{officeAds}
         , #{ownRgstNm}
         , #{ownRgstTelNo}
         , #{modelCd}
         , #{vinNo}
         , #{wehicleUse}
         , #{carRegNo}  
         , #{carRegColor}
         , #{makerCd}
         , #{drivePermitNo}
         , #{carRegCity}
         , #{drivLicenseDt}
         , #{purcPayNo}
         , #{insurNo}
         , #{carRegiNo}
         , #{carRegiDt}
         , #{invoCo}
         , #{invoNo}
         , #{invoMn}
         , #{invoDt}
         , #{encl}
         , #{remarek}
         , #{reason}
         , #{applDt}
         , #{statusNo}
         , #{auditDt}
         ,#{carBuyArea}
         ,#{headFileDocId}
         ,#{newEnterFileNo}
         ,#{custTp}
         ,#{addressChargingCar}
         ,#{humanPropertyType}
         )
    </insert>
    
    <insert id="insertNewEnVSApplicationIs" parameterType="NewEnergyVSApplicationVO">
        /* [chn.bhmc.dms.crm.cif.service.dao.CustomerInfoDAO.insertCustomer] */
        <!-- insert into SA_0506IS (
        DLR_CD,
        APPLICATION_NO,
        CUST_NM,HP_NO,
        MATH_DOC_TP,
        SSN_CRN_NO,
        ADDR_DETL_CONT,
        OFFICE_NM,
        PERNAME,
        PERPHON,
        REG_NO,
        OFFICE_ADS,
        OWN_RGST_NM,
        OWN_RGST_TEL_NO,MODEL_CD,VIN_NO,WEHICLE_USE, CAR_REG_NO,CAR_REG_COLOR,
        MAKER_CD,
        DRIVE_PERMIT_NO,
        CAR_REG_CITY,
        DRIV_LICENSE_DT,
        PURC_PAY_NO,
        INSUR_NO,
        CAR_REGI_NO,
        CAR_REGI_DT,
        INVO_CO,
        INVO_NO,
        INVO_MN,
        INVO_DT,
        ENCL,
        REMAREK,
        REASON,
        APPL_DT,
        STATUS_NO,
        AUDIT_DT,
        CAR_BUY_AREA,
        HEAD_FILE_DOCID,
        NEW_ENTER_FILE_NO,
        CUST_TP,
        ADDRESS_CHARGING_CAR,
        HUMAN_PROPERTY_TYPE,
        IFRESULT)
 values( #{dlrCd}
         , #{applicationNo}
         , #{custNm}
         , #{hpNo}
         , #{mathDocTp}
         , #{ssnCrnNo}
         , #{addrDetlCont}
         , #{officeNm}
         , #{pername}
         , #{perphon}
         , #{regNo}
         , #{officeAds}
         , #{ownRgstNm}
         , #{ownRgstTelNo}
         , #{modelCd}
         , #{vinNo}
         , #{wehicleUse}
         , #{carRegNo}  
         , #{carRegColor}
         , #{makerCd}
         , #{drivePermitNo}
         , #{carRegCity}
         , #{drivLicenseDt}
         , #{purcPayNo}
         , #{insurNo}
         , #{carRegiNo}
         , #{carRegiDt}
         , #{invoCo}
         , #{invoNo}
         , #{invoMn}
         , #{invoDt}
         , #{encl}
         , #{remarek}
         , #{reason}
         , #{applDt}
         , #{statusNo}
         , #{auditDt}
         ,#{carBuyArea}
         ,#{headFileDocId}
         ,#{newEnterFileNo}
         ,#{custTp}
         ,#{addressChargingCar}
         ,#{humanPropertyType}
         ,'N'
         ) -->
         
         MERGE INTO SA_0506IS A
			USING (SELECT DLR_CD,
			      #{applicationNo} APPLICATION_NO,
			      #{custNm} CUST_NM,
			      #{hpNo} HP_NO,
			      #{mathDocTp} MATH_DOC_TP,
			      #{ssnCrnNo} SSN_CRN_NO,
			      #{addrDetlCont} ADDR_DETL_CONT,
			      #{officeNm} OFFICE_NM,
			      #{pername} PERNAME,
			      #{perphon} PERPHON,
			      #{regNo} REG_NO,
			      #{officeAds} OFFICE_ADS,
			      #{ownRgstNm} OWN_RGST_NM,
			      #{ownRgstTelNo} OWN_RGST_TEL_NO,
			      #{modelCd} MODEL_CD,
			      #{vinNo} VIN_NO,
			      #{wehicleUse} WEHICLE_USE, 
			      #{carRegNo} CAR_REG_NO,
			      #{carRegColor} CAR_REG_COLOR,
			      #{makerCd} MAKER_CD,
			      #{drivePermitNo} DRIVE_PERMIT_NO,
			      #{carRegCity} CAR_REG_CITY,
			      #{drivLicenseDt} DRIV_LICENSE_DT,
			      #{purcPayNo} PURC_PAY_NO,
			      #{insurNo} INSUR_NO,
			      #{carRegiNo} CAR_REGI_NO,
			      #{carRegiDt} CAR_REGI_DT,
			      #{invoCo} INVO_CO,
			      #{invoNo} INVO_NO,
			      #{invoMn} INVO_MN,
			      #{invoDt} INVO_DT,
			      #{encl} ENCL,
			      #{remarek} REMAREK,
			      #{reason} REASON,
			      #{applDt} APPL_DT,
			      #{statusNo} STATUS_NO,
			      #{auditDt} AUDIT_DT,
			      #{carBuyArea} CAR_BUY_AREA,
			      #{headFileDocId} HEAD_FILE_DOCID,
			      #{newEnterFileNo} NEW_ENTER_FILE_NO,
			      #{custTp} CUST_TP,
			      #{addressChargingCar} ADDRESS_CHARGING_CAR,
			      #{humanPropertyType} HUMAN_PROPERTY_TYPE,
			      'N' IFRESULT
			      FROM SA_0506T C
			      WHERE C.APPLICATION_NO = #{applicationNo}
			      ) B
			ON (A.APPLICATION_NO = B.APPLICATION_NO)
			WHEN NOT MATCHED THEN
			  INSERT
			    (DLR_CD,
			     APPLICATION_NO,
			     CUST_NM,
			     HP_NO,
			     MATH_DOC_TP,
			     SSN_CRN_NO,
			     ADDR_DETL_CONT,
			     OFFICE_NM,
			     PERNAME,
			     PERPHON,
			     REG_NO,
			     OFFICE_ADS,
			     OWN_RGST_NM,
			     OWN_RGST_TEL_NO,
			     MODEL_CD,
			     VIN_NO,
			     WEHICLE_USE,
			     CAR_REG_NO,
			     CAR_REG_COLOR,
			     MAKER_CD,
			     DRIVE_PERMIT_NO,
			     CAR_REG_CITY,
			     DRIV_LICENSE_DT,
			     PURC_PAY_NO,
			     INSUR_NO,
			     CAR_REGI_NO,
			     CAR_REGI_DT,
			     INVO_CO,
			     INVO_NO,
			     INVO_MN,
			     INVO_DT,
			     ENCL,
			     REMAREK,
			     REASON,
			     APPL_DT,
			     STATUS_NO,
			     AUDIT_DT,
			     CAR_BUY_AREA,
			     HEAD_FILE_DOCID,
			     NEW_ENTER_FILE_NO,
			     CUST_TP,
			     ADDRESS_CHARGING_CAR,
			     HUMAN_PROPERTY_TYPE,
			     IFRESULT)
			  VALUES
			    (B.DLR_CD,
			     B.APPLICATION_NO,
			     B.CUST_NM,
			     HP_NO,
			     B.MATH_DOC_TP,
			     B.SSN_CRN_NO,
			     B.ADDR_DETL_CONT,
			     B.OFFICE_NM,
			     B.PERNAME,
			     B.PERPHON,
			     B.REG_NO,
			     B.OFFICE_ADS,
			     B.OWN_RGST_NM,
			     B.OWN_RGST_TEL_NO,
			     B.MODEL_CD,
			     VIN_NO,
			     B.WEHICLE_USE,
			     B.CAR_REG_NO,
			     B.CAR_REG_COLOR,
			     B.MAKER_CD,
			     B.DRIVE_PERMIT_NO,
			     B.CAR_REG_CITY,
			     B.DRIV_LICENSE_DT,
			     B.PURC_PAY_NO,
			     B.INSUR_NO,
			     B.CAR_REGI_NO,
			     B.CAR_REGI_DT,
			     B.INVO_CO,
			     B.INVO_NO,
			     B.INVO_MN,
			     B.INVO_DT,
			     B.ENCL,
			     B.REMAREK,
			     B.REASON,
			     B.APPL_DT,
			     B.STATUS_NO,
			     B.AUDIT_DT,
			     B.CAR_BUY_AREA,
			     B.HEAD_FILE_DOCID,
			     B.NEW_ENTER_FILE_NO,
			     B.CUST_TP,
			     B.ADDRESS_CHARGING_CAR,
			     B.HUMAN_PROPERTY_TYPE,
			     B.IFRESULT)
			WHEN MATCHED THEN
			  UPDATE
			     SET A.DLR_CD               = B.DLR_CD,
			         A.CUST_NM              = B.CUST_NM,
			         A.HP_NO                = B.HP_NO,
			         A.MATH_DOC_TP          = B.MATH_DOC_TP,
			         A.SSN_CRN_NO           = B.SSN_CRN_NO,
			         A.ADDR_DETL_CONT       = B.ADDR_DETL_CONT,
			         A.OFFICE_NM            = B.OFFICE_NM,
			         A.PERNAME              = B.PERNAME,
			         A.PERPHON              = B.PERPHON,
			         A.REG_NO               = B.REG_NO,
			         A.OFFICE_ADS           = B.OFFICE_ADS,
			         A.OWN_RGST_NM          = B.OWN_RGST_NM,
			         A.OWN_RGST_TEL_NO      = B.OWN_RGST_TEL_NO,
			         A.MODEL_CD             = B.MODEL_CD,
			         A.VIN_NO               = B.VIN_NO,
			         A.WEHICLE_USE          = B.WEHICLE_USE,
			         A.CAR_REG_NO           = B.CAR_REG_NO,
			         A.CAR_REG_COLOR        = B.CAR_REG_COLOR,
			         A.MAKER_CD             = B.MAKER_CD,
			         A.DRIVE_PERMIT_NO      = B.DRIVE_PERMIT_NO,
			         A.CAR_REG_CITY         = B.CAR_REG_CITY,
			         A.DRIV_LICENSE_DT      = B.DRIV_LICENSE_DT,
			         A.PURC_PAY_NO          = B.PURC_PAY_NO,
			         A.INSUR_NO             = B.INSUR_NO,
			         A.CAR_REGI_NO          = B.CAR_REGI_NO,
			         A.CAR_REGI_DT          = B.CAR_REGI_DT,
			         A.INVO_CO              = B.INVO_CO,
			         A.INVO_NO              = B.INVO_NO,
			         A.INVO_MN              = B.INVO_MN,
			         A.INVO_DT              = B.INVO_DT,
			         A.ENCL                 = B.ENCL,
			         A.REMAREK              = B.REMAREK,
			         A.REASON               = B.REASON,
			         A.APPL_DT              = B.APPL_DT,
			         A.STATUS_NO            = B.STATUS_NO,
			         A.AUDIT_DT             = B.AUDIT_DT,
			         A.CAR_BUY_AREA         = B.CAR_BUY_AREA,
			         A.HEAD_FILE_DOCID      = B.HEAD_FILE_DOCID,
			         A.NEW_ENTER_FILE_NO    = B.NEW_ENTER_FILE_NO,
			         A.CUST_TP              = B.CUST_TP,
			         A.ADDRESS_CHARGING_CAR = B.ADDRESS_CHARGING_CAR,
			         A.HUMAN_PROPERTY_TYPE  = B.HUMAN_PROPERTY_TYPE,
			         A.IFRESULT             = B.IFRESULT

    </insert>
    
    <update id="updateNewEnVSApplication" parameterType="NewEnergyVSApplicationVO">
    /* [chn.bhmc.dms.sal.cnt.service.dao.ContractMntDAO.updateContract] */
        UPDATE SA_0506T    --계약헤더
           SET 
        <!-- CUST_NM = #{custNm},
        HP_NO = #{hpNo},
        MATH_DOC_TP = #{mathDocTp},
        SSN_CRN_NO = #{ssnCrnNo},
        ADDR_DETL_CONT = #{addrDetlCont},
        OFFICE_NM = #{officeNm},
        PERNAME = #{pername},
        PERPHON = #{perphon},
        REG_NO = #{regNo},
        OFFICE_ADS = #{officeAds},
        OWN_RGST_NM = #{ownRgstNm},
        OWN_RGST_TEL_NO = #{ownRgstTelNo},
        MODEL_CD = #{modelCd},
        VIN_NO = #{vinNo},
        WEHICLE_USE = #{wehicleUse},
        CAR_REG_NO = #{carRegNo},
        CAR_REG_COLOR = #{carRegColor},
        MAKER_CD = #{makerCd},
        DRIVE_PERMIT_NO = #{drivePermitNo},
        CAR_REG_CITY = #{carRegCity},
        DRIV_LICENSE_DT = #{drivLicenseDt},
        PURC_PAY_NO = #{purcPayNo},
        INSUR_NO = #{insurNo},
        CAR_REGI_NO = #{carRegiNo},
        CAR_REGI_DT = #{carRegiDt},
        INVO_CO = #{invoCo},
        INVO_NO = #{invoNo},
        INVO_MN = #{invoMn},
        INVO_DT = #{invoDt},
        ENCL = #{encl},
        REMAREK = #{remarek},
        REASON = #{reason},
        APPL_DT = #{applDt},
        AUDIT_DT = #{auditDt},
        CAR_BUY_AREA = #{carBuyArea},
        HEAD_FILE_DOCID = #{headFileDocId},
        NEW_ENTER_FILE_NO = #{newEnterFileNo},
        CUST_TP = #{custTp},
        ADDRESS_CHARGING_CAR = #{addressChargingCar},
        HUMAN_PROPERTY_TYPE = #{humanPropertyType}, -->
        REASON = #{reason},
        <!-- R19082701043 张伟丽提报：DCS新能源补贴审批画面，最后一列加一个“审批人“ 贾明 2019-8-28 start -->
        REVIEWER_ID = #{reviewerId},
        REVIEWER_NM = #{reviewerNm},
        <!-- R19082701043 张伟丽提报：DCS新能源补贴审批画面，最后一列加一个“审批人“ 贾明 2019-8-28 end -->
        STATUS_NO = #{statusNo},AUDIT_DT = #{auditDt}
         WHERE 1 = 1
           AND APPLICATION_NO = #{applicationNo}                --계약번호
    </update>
    
    <update id="updateNewEnVSApplicationIs" parameterType="NewEnergyVSApplicationVO">
    /* [chn.bhmc.dms.sal.cnt.service.dao.ContractMntDAO.updateContract] */
        UPDATE SA_0506IS    --계약헤더
           SET 
        CUST_NM = #{custNm},
        HP_NO = #{hpNo},
        MATH_DOC_TP = #{mathDocTp},
        SSN_CRN_NO = #{ssnCrnNo},
        ADDR_DETL_CONT = #{addrDetlCont},
        OFFICE_NM = #{officeNm},
        PERNAME = #{pername},
        PERPHON = #{perphon},
        REG_NO = #{regNo},
        OFFICE_ADS = #{officeAds},
        OWN_RGST_NM = #{ownRgstNm},
        OWN_RGST_TEL_NO = #{ownRgstTelNo},
        MODEL_CD = #{modelCd},
        VIN_NO = #{vinNo},
        WEHICLE_USE = #{wehicleUse},
        CAR_REG_NO = #{carRegNo},
        CAR_REG_COLOR = #{carRegColor},
        MAKER_CD = #{makerCd},
        DRIVE_PERMIT_NO = #{drivePermitNo},
        CAR_REG_CITY = #{carRegCity},
        DRIV_LICENSE_DT = #{drivLicenseDt},
        PURC_PAY_NO = #{purcPayNo},
        INSUR_NO = #{insurNo},
        CAR_REGI_NO = #{carRegiNo},
        CAR_REGI_DT = #{carRegiDt},
        INVO_CO = #{invoCo},
        INVO_NO = #{invoNo},
        INVO_MN = #{invoMn},
        INVO_DT = #{invoDt},
        ENCL = #{encl},
        REMAREK = #{remarek},
        REASON = #{reason},
        APPL_DT = #{applDt},
        STATUS_NO = #{statusNo},
        AUDIT_DT = #{auditDt},
        CAR_BUY_AREA = #{carBuyArea},
        HEAD_FILE_DOCID = #{headFileDocId},
        NEW_ENTER_FILE_NO = #{newEnterFileNo},
        CUST_TP = #{custTp},
        ADDRESS_CHARGING_CAR = #{addressChargingCar},
        HUMAN_PROPERTY_TYPE = #{humanPropertyType},
        IFRESULT = 'N'
         WHERE 1 = 1
           AND DLR_CD              = #{dlrCd}                     --딜러코드
           AND APPLICATION_NO         = #{applicationNo}                --계약번호
    </update>
</mapper>