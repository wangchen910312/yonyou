<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO">

    <!-- 목록 갯수  -->
    <select id="selectGroupSalesApplicationByConditionCnt" parameterType="GroupSalesApplicationSearchVO" resultType="int">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplicationByConditionCnt] */
        SELECT COUNT(*) AS VALUE
          FROM (
          SELECT A.USR_ID || LPAD(A.REQ_SEQ, 4, 0) AS APPLY_NO    				--신청번호
             , A.CUST_NM AS CUST_NM                             				--고객명
             , A.ATC_DSTIN_CD AS ATC_DSTIN_CD                   				--항목구분 SAL151
             , NVL(COUNT(B.DLR_CD||B.USR_ID||B.REQ_SEQ),0) AS REQ_QTY           --수량
             , A.APPLY_DT AS APPLY_DT                           				--신청일자
             , NVL(SUM(C.CNT),0) AS ASSIGN_QTY                  				--배정수량
             , A.DLR_CD AS DLR_CD
             , A.USR_ID AS USR_ID
             , A.REQ_SEQ AS REQ_SEQ                             				--MSLH_APPSEQ
             , COUNT(1) OVER() AS TOT_CNT
             , MAX(D.EVAL_RSLT_YN) AS RSLT_YN
             , MAX(D.REMARK) AS REMARK
             , MAX(D.EVAL_DT) AS EVAL_DT
             , NVL(MAX(D.REQ_NO),0) AS REQ_NO
             , CASE  WHEN APPROVE_CD != 'A' AND MAX(D.EVAL_RSLT_YN) = 'N' THEN 'D'
                     WHEN APPROVE_CD != 'A' AND MAX(D.EVAL_RSLT_YN) = 'Y' AND NVL(MAX(D.REQ_NO),0) = 3 THEN 'C'
                     WHEN APPROVE_CD = 'A' THEN 'A' ELSE 'B' END AS APPROVE_CD
          FROM SA_0414T A    --SA_0414T 집단판매신청정보
             , SA_0415T B    --SA_0415T 집단판매신청서브헤더
             , ((SELECT X.DLR_CD,
                         X.USR_ID,
                         X.REQ_SEQ,
                         X.REQ_LOWER_SEQ,
                         SUM(Y.ORD_QTY) AS CNT
                      FROM (
                        SELECT DLR_CD,
                               USR_ID,
                               REQ_SEQ,
                               REQ_LOWER_SEQ,
                               ORD_NO,
                               ORD_YY_MM_DT,
                               ORD_PRID,
                               CARLINE_CD,
                               MODEL_CD,
                               OCN_CD,
                               EXT_COLOR_CD,
                               INT_COLOR_CD,
                               ORD_TP,
                               SEQ_NO,
                               T0417_YYMM,
                               T0417_WEEK,
                               T0414_YYMM,
                               T0414_WEEK
                         FROM (SELECT G.DLR_CD,  --딜러코드
                                      G.USR_ID,  --ID(사번)
                                      G.REQ_SEQ,  --신청번호
                                      G.REQ_LOWER_SEQ,  --SUBSEQ
                                      G.ORD_NO,  --오더번호
                                      SUBSTR(H.ORD_YY_MM_DT,3,6) AS ORD_YY_MM_DT,
                                      H.ORD_PRID,
                                      CASE WHEN SUBSTR(H.ORD_YY_MM_DT,3,6) = SUBSTR(FN_GET_ORD_WEEK('YYMM',H.ORD_YY_MM_DT),3,6)
                                           THEN SUBSTR(H.ORD_YY_MM_DT,3,6)
                                           ELSE SUBSTR(FN_GET_ORD_WEEK('YYMM',H.ORD_YY_MM_DT),3,6) END AS T0417_YYMM,
                                      CASE WHEN H.ORD_PRID = FN_GET_ORD_WEEK('WEEK',H.ORD_YY_MM_DT)
                                           THEN H.ORD_PRID
                                           ELSE FN_GET_ORD_WEEK('WEEK',H.ORD_YY_MM_DT) END AS T0417_WEEK,
                                      G.CARLINE_CD, --차종
                                      G.MODEL_CD,   --모델
                                      G.OCN_CD, --OCN
                                      G.EXT_COLOR_CD, --외색
                                      G.INT_COLOR_CD, --내색
                                      H.ORD_TP,
                                      G.USR_ID || LPAD(G.REQ_SEQ,4,0) AS SEQ_NO ,  --ID(사번)||신청번호
                                      (SELECT SUBSTR(FN_GET_ORD_WEEK('YYMM',TO_CHAR(G.LAST_APPROVE_DT,'YYYYMMDD')),3,6)  --최종승인일자
                                         FROM SA_0414T I  --SA_0414T
                                        WHERE I.DLR_CD  = G.DLR_CD
                                          AND I.USR_ID  = G.USR_ID
                                          AND I.REQ_SEQ  = G.REQ_SEQ) AS T0414_YYMM,
                                      (SELECT FN_GET_ORD_WEEK('WEEK',TO_CHAR(G.LAST_APPROVE_DT,'YYYYMMDD'))   --최종승인일자
                                         FROM SA_0414T  J --SA_0414T
                                        WHERE J.DLR_CD  = G.DLR_CD
                                          AND J.USR_ID  = G.USR_ID
                                          AND J.REQ_SEQ  = G.REQ_SEQ) AS T0414_WEEK
                             FROM SA_0413T G, --SA_0413T
                                  SA_0417T H  --SA_0417T
                            WHERE G.DLR_CD = H.DLR_CD
                              AND G.ORD_NO = H.ORD_NO
                              AND G.CARLINE_CD = H.CARLINE_CD
                              AND G.MODEL_CD = H.MODEL_CD
                              AND G.OCN_CD = H.OCN_CD
                              AND G.EXT_COLOR_CD = H.EXT_COLOR_CD
                              AND G.INT_COLOR_CD = H.INT_COLOR_CD
                              AND H.ORD_TP ='N3'
                              AND H.ORD_STAT_CD <![CDATA[ <> ]]> '1A'
                              AND G.DLR_CD = #{sDlrCd}
                            GROUP BY G.DLR_CD, G.USR_ID, G.REQ_SEQ, G.REQ_LOWER_SEQ,
                                     G.ORD_NO, H.ORD_YY_MM_DT, H.ORD_PRID, G.CARLINE_CD,
                                     G.MODEL_CD, G.OCN_CD, G.EXT_COLOR_CD, G.INT_COLOR_CD,
                                     H.ORD_TP, G.LAST_APPROVE_DT
                            )WHERE T0414_YYMM = T0417_YYMM
                               AND T0414_WEEK = T0417_WEEK
                     )X ,
                     SA_0416T Y
                    WHERE X.DLR_CD = Y.DLR_CD
                      AND X.ORD_NO = Y.SVNO
                      AND X.CARLINE_CD = Y.CARLINE_CD
                      AND X.MODEL_CD = Y.MODEL_CD
                      AND X.OCN_CD   = Y.OCN_CD
                      AND X.EXT_COLOR_CD = Y.EXT_COLOR_CD
                      AND X.INT_COLOR_CD = Y.INT_COLOR_CD
                      AND Y.SORD ='N3'
                      AND Y.ORD_STS IN ('C','D','E','P')
                      AND X.DLR_CD = #{sDlrCd}
                     GROUP BY X.DLR_CD, X.USR_ID, X.REQ_SEQ, X.REQ_LOWER_SEQ, X.SEQ_NO
                      UNION ALL
                     SELECT O.DLR_CD, O.USR_ID, O.REQ_LOWER_SEQ, O.REQ_SEQ,  SUM(P.ORD_QTY) AS CNT
                     FROM SA_0413T O,
                          SA_0416T P
                    WHERE O.ORD_NO = P.SALES_NO
                      AND O.DLR_CD = P.DLR_CD
                      AND O.CARLINE_CD = P.CARLINE_CD
                      AND O.MODEL_CD = P.MODEL_CD
                      AND O.EXT_COLOR_CD = P.EXT_COLOR_CD
                      AND O.INT_COLOR_CD = P.INT_COLOR_CD
                      AND P.SORD ='N3'
                      AND P.ORD_STS IN ('C','D','E','P')
                      AND O.DLR_CD = #{sDlrCd}
                    GROUP BY O.DLR_CD, O.USR_ID, O.REQ_SEQ, O.REQ_LOWER_SEQ
                    )
                 ) C
                ,(SELECT SA412.DLR_CD
                              , SA412.USR_ID
                              , SA412.REQ_SEQ
                              , SA412.REQ_NO
                              , SA412.EVAL_RSLT_YN
                              , SA412.EVAL_DT
                              , SA412.REMARK
                              , SA412.PEVAL_ID
                           FROM SA_0412T SA412
                              , (SELECT DLR_CD
                                      , USR_ID
                                      , REQ_SEQ
                                      , MAX(REQ_NO) AS REQ_NO
                                   FROM SA_0412T
                                  GROUP BY DLR_CD, USR_ID, REQ_SEQ) DD
                         WHERE SA412.DLR_CD = DD.DLR_CD
                           AND SA412.USR_ID = DD.USR_ID
                           AND SA412.REQ_SEQ = DD.REQ_SEQ
                           AND SA412.REQ_NO = DD.REQ_NO) D
         WHERE A.DLR_CD  = B.DLR_CD(+)
           AND A.USR_ID  = B.USR_ID(+)
           AND A.REQ_SEQ  = B.REQ_SEQ(+)
           AND B.DLR_CD  = C.DLR_CD(+)
           AND B.USR_ID  = C.USR_ID(+)
           AND B.REQ_SEQ  = C.REQ_SEQ(+)
           AND B.REQ_LOWER_SEQ  = C.REQ_LOWER_SEQ(+)
           AND A.DLR_CD = D.DLR_CD (+)
           AND A.USR_ID = D.USR_ID (+)
           AND A.REQ_SEQ = D.REQ_SEQ(+)
           AND A.DEL_YN='N'
        <if test='sApplyDtS != null and sApplyDtE != null' >
           AND TO_CHAR(A.APPLY_DT, 'YYYY-MM-DD') BETWEEN TO_CHAR(#{sApplyDtS}, 'YYYY-MM-DD') AND TO_CHAR(#{sApplyDtE}, 'YYYY-MM-DD')
        </if>
        <if test='sApplyNo != null and sApplyNo != ""'>
        <choose>
            <when test='@org.apache.commons.lang3.StringUtils@contains(sApplyNo,"*")'>
                <bind name='sApplyNo' value='@org.apache.commons.lang3.StringUtils@replace(sApplyNo, "*", "%")' />
           AND A.USR_ID||LPAD(A.REQ_SEQ,4,0) LIKE #{sApplyNo}
            </when>
            <otherwise>
           AND A.USR_ID||LPAD(A.REQ_SEQ,4,0) = #{sApplyNo}
            </otherwise>
        </choose>
        </if>
        <if test='sCustNm != null and sCustNm != ""'>
        <choose>
            <when test='@org.apache.commons.lang3.StringUtils@contains(sCustNm,"*")'>
                <bind name='sCustNm' value='@org.apache.commons.lang3.StringUtils@replace(sCustNm, "*", "%")' />
           AND A.CUST_NM LIKE #{sCustNm}
            </when>
            <otherwise>
           AND A.CUST_NM = #{sCustNm}
            </otherwise>
        </choose>
        </if>
           AND A.DLR_CD  = #{sDlrCd}
           AND A.USR_ID = #{sUsrId}
         GROUP BY SUBSTR(A.APPLY_DT,1,4)||LPAD(A.REQ_SEQ,5,0), A.CUST_NM, A.ATC_DSTIN_CD,
               A.APPLY_DT, A.APPROVE_CD, A.DLR_CD, A.USR_ID, A.REQ_SEQ
         ) AA
         WHERE 1=1
         <if test='sApproveCd != null and sApproveCd != ""'>
           AND AA.APPROVE_CD = #{sApproveCd}  -- 상태
        </if>
    </select>

    <!-- 조회 목록  -->
    <select id="selectGroupSalesApplicationByCondition" parameterType="GroupSalesApplicationSearchVO" resultType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplicationByCondition] */
        SELECT AA.*
         FROM(
        SELECT A.USR_ID || LPAD(A.REQ_SEQ, 4, 0) AS APPLY_NO    				--신청번호
             , A.CUST_NM AS CUST_NM                             				--고객명
             , A.ATC_DSTIN_CD AS ATC_DSTIN_CD                   				--항목구분 SAL151
             , NVL(COUNT(B.DLR_CD||B.USR_ID||B.REQ_SEQ),0) AS REQ_QTY           --수량
             , A.APPLY_DT AS APPLY_DT                           				--신청일자
             , NVL(SUM(C.CNT),0) AS ASSIGN_QTY                  				--배정수량
             , A.DLR_CD AS DLR_CD
             , A.USR_ID AS USR_ID
             , A.REQ_SEQ AS REQ_SEQ                             				--MSLH_APPSEQ
             , COUNT(1) OVER() AS TOT_CNT
             , MAX(D.EVAL_RSLT_YN) AS RSLT_YN
             , MAX(D.REMARK) AS REMARK
             , MAX(D.EVAL_DT) AS EVAL_DT
             , NVL(MAX(D.REQ_NO),0) AS REQ_NO
             , CASE  WHEN APPROVE_CD != 'A' AND MAX(D.EVAL_RSLT_YN) = 'N' THEN 'D'
                     WHEN APPROVE_CD != 'A' AND MAX(D.EVAL_RSLT_YN) = 'Y' AND NVL(MAX(D.REQ_NO),0) = 3 THEN 'C'
                     WHEN APPROVE_CD = 'A' THEN 'A' ELSE 'B' END AS APPROVE_CD
          FROM SA_0414T A    --SA_0414T 집단판매신청정보
             , SA_0415T B    --SA_0415T 집단판매신청서브헤더
             , ((SELECT X.DLR_CD,
                         X.USR_ID,
                         X.REQ_SEQ,
                         X.REQ_LOWER_SEQ,
                         SUM(Y.ORD_QTY) AS CNT
                      FROM (
                        SELECT DLR_CD,
                               USR_ID,
                               REQ_SEQ,
                               REQ_LOWER_SEQ,
                               ORD_NO,
                               ORD_YY_MM_DT,
                               ORD_PRID,
                               CARLINE_CD,
                               MODEL_CD,
                               OCN_CD,
                               EXT_COLOR_CD,
                               INT_COLOR_CD,
                               ORD_TP,
                               SEQ_NO,
                               T0417_YYMM,
                               T0417_WEEK,
                               T0414_YYMM,
                               T0414_WEEK
                         FROM (SELECT G.DLR_CD,  --딜러코드
                                      G.USR_ID,  --ID(사번)
                                      G.REQ_SEQ,  --신청번호
                                      G.REQ_LOWER_SEQ,  --SUBSEQ
                                      G.ORD_NO,  --오더번호
                                      SUBSTR(H.ORD_YY_MM_DT,3,6) AS ORD_YY_MM_DT,
                                      H.ORD_PRID,
                                      CASE WHEN SUBSTR(H.ORD_YY_MM_DT,3,6) = SUBSTR(FN_GET_ORD_WEEK('YYMM',H.ORD_YY_MM_DT),3,6)
                                           THEN SUBSTR(H.ORD_YY_MM_DT,3,6)
                                           ELSE SUBSTR(FN_GET_ORD_WEEK('YYMM',H.ORD_YY_MM_DT),3,6) END AS T0417_YYMM,
                                      CASE WHEN H.ORD_PRID = FN_GET_ORD_WEEK('WEEK',H.ORD_YY_MM_DT)
                                           THEN H.ORD_PRID
                                           ELSE FN_GET_ORD_WEEK('WEEK',H.ORD_YY_MM_DT) END AS T0417_WEEK,
                                      G.CARLINE_CD, --차종
                                      G.MODEL_CD,   --모델
                                      G.OCN_CD, --OCN
                                      G.EXT_COLOR_CD, --외색
                                      G.INT_COLOR_CD, --내색
                                      H.ORD_TP,
                                      G.USR_ID || LPAD(G.REQ_SEQ,4,0) AS SEQ_NO ,  --ID(사번)||신청번호
                                      (SELECT SUBSTR(FN_GET_ORD_WEEK('YYMM',TO_CHAR(G.LAST_APPROVE_DT,'YYYYMMDD')),3,6)  --최종승인일자
                                         FROM SA_0414T I  --SA_0414T
                                        WHERE I.DLR_CD  = G.DLR_CD
                                          AND I.USR_ID  = G.USR_ID
                                          AND I.REQ_SEQ  = G.REQ_SEQ) AS T0414_YYMM,
                                      (SELECT FN_GET_ORD_WEEK('WEEK',TO_CHAR(G.LAST_APPROVE_DT,'YYYYMMDD'))   --최종승인일자
                                         FROM SA_0414T  J --SA_0414T
                                        WHERE J.DLR_CD  = G.DLR_CD
                                          AND J.USR_ID  = G.USR_ID
                                          AND J.REQ_SEQ  = G.REQ_SEQ) AS T0414_WEEK
                             FROM SA_0413T G, --SA_0413T
                                  SA_0417T H  --SA_0417T
                            WHERE G.DLR_CD = H.DLR_CD
                              AND G.ORD_NO = H.ORD_NO
                              AND G.CARLINE_CD = H.CARLINE_CD
                              AND G.MODEL_CD = H.MODEL_CD
                              AND G.OCN_CD = H.OCN_CD
                              AND G.EXT_COLOR_CD = H.EXT_COLOR_CD
                              AND G.INT_COLOR_CD = H.INT_COLOR_CD
                              AND H.ORD_TP ='N3'
                              AND H.ORD_STAT_CD <![CDATA[ <> ]]> '1A'
                              AND G.DLR_CD = #{sDlrCd}
                            GROUP BY G.DLR_CD, G.USR_ID, G.REQ_SEQ, G.REQ_LOWER_SEQ,
                                     G.ORD_NO, H.ORD_YY_MM_DT, H.ORD_PRID, G.CARLINE_CD,
                                     G.MODEL_CD, G.OCN_CD, G.EXT_COLOR_CD, G.INT_COLOR_CD,
                                     H.ORD_TP, G.LAST_APPROVE_DT
                            )WHERE T0414_YYMM = T0417_YYMM
                               AND T0414_WEEK = T0417_WEEK
                     )X ,
                     SA_0416T Y
                    WHERE X.DLR_CD = Y.DLR_CD
                      AND X.ORD_NO = Y.SVNO
                      AND X.CARLINE_CD = Y.CARLINE_CD
                      AND X.MODEL_CD = Y.MODEL_CD
                      AND X.OCN_CD   = Y.OCN_CD
                      AND X.EXT_COLOR_CD = Y.EXT_COLOR_CD
                      AND X.INT_COLOR_CD = Y.INT_COLOR_CD
                      AND Y.SORD ='N3'
                      AND Y.ORD_STS IN ('C','D','E','P')
                      AND X.DLR_CD = #{sDlrCd}
                     GROUP BY X.DLR_CD, X.USR_ID, X.REQ_SEQ, X.REQ_LOWER_SEQ, X.SEQ_NO
                      UNION ALL
                     SELECT O.DLR_CD, O.USR_ID, O.REQ_LOWER_SEQ, O.REQ_SEQ,  SUM(P.ORD_QTY) AS CNT
                     FROM SA_0413T O,
                          SA_0416T P
                    WHERE O.ORD_NO = P.SALES_NO
                      AND O.DLR_CD = P.DLR_CD
                      AND O.CARLINE_CD = P.CARLINE_CD
                      AND O.MODEL_CD = P.MODEL_CD
                      AND O.EXT_COLOR_CD = P.EXT_COLOR_CD
                      AND O.INT_COLOR_CD = P.INT_COLOR_CD
                      AND P.SORD ='N3'
                      AND P.ORD_STS IN ('C','D','E','P')
                      AND O.DLR_CD = #{sDlrCd}
                    GROUP BY O.DLR_CD, O.USR_ID, O.REQ_SEQ, O.REQ_LOWER_SEQ
                    )
                 ) C
                ,(SELECT SA412.DLR_CD
                              , SA412.USR_ID
                              , SA412.REQ_SEQ
                              , SA412.REQ_NO
                              , SA412.EVAL_RSLT_YN
                              , SA412.EVAL_DT
                              , SA412.REMARK
                              , SA412.PEVAL_ID
                           FROM SA_0412T SA412
                              , (SELECT DLR_CD
                                      , USR_ID
                                      , REQ_SEQ
                                      , MAX(REQ_NO) AS REQ_NO
                                   FROM SA_0412T
                                  GROUP BY DLR_CD, USR_ID, REQ_SEQ) DD
                         WHERE SA412.DLR_CD = DD.DLR_CD
                           AND SA412.USR_ID = DD.USR_ID
                           AND SA412.REQ_SEQ = DD.REQ_SEQ
                           AND SA412.REQ_NO = DD.REQ_NO) D
         WHERE A.DLR_CD  = B.DLR_CD(+)
           AND A.USR_ID  = B.USR_ID(+)
           AND A.REQ_SEQ  = B.REQ_SEQ(+)
           AND B.DLR_CD  = C.DLR_CD(+)
           AND B.USR_ID  = C.USR_ID(+)
           AND B.REQ_SEQ  = C.REQ_SEQ(+)
           AND B.REQ_LOWER_SEQ  = C.REQ_LOWER_SEQ(+)
           AND A.DLR_CD = D.DLR_CD (+)
           AND A.USR_ID = D.USR_ID (+)
           AND A.REQ_SEQ = D.REQ_SEQ(+)
           AND A.DEL_YN='N'
        <if test='sApplyDtS != null and sApplyDtE != null' >
           AND TO_CHAR(A.APPLY_DT, 'YYYY-MM-DD') BETWEEN TO_CHAR(#{sApplyDtS}, 'YYYY-MM-DD') AND TO_CHAR(#{sApplyDtE}, 'YYYY-MM-DD')
        </if>
        <if test='sApplyNo != null and sApplyNo != ""'>
        <choose>
            <when test='@org.apache.commons.lang3.StringUtils@contains(sApplyNo,"*")'>
                <bind name='sApplyNo' value='@org.apache.commons.lang3.StringUtils@replace(sApplyNo, "*", "%")' />
           AND A.USR_ID||LPAD(A.REQ_SEQ,4,0) LIKE #{sApplyNo}
            </when>
            <otherwise>
           AND A.USR_ID||LPAD(A.REQ_SEQ,4,0) = #{sApplyNo}
            </otherwise>
        </choose>
        </if>
        <if test='sCustNm != null and sCustNm != ""'>
        <choose>
            <when test='@org.apache.commons.lang3.StringUtils@contains(sCustNm,"*")'>
                <bind name='sCustNm' value='@org.apache.commons.lang3.StringUtils@replace(sCustNm, "*", "%")' />
           AND A.CUST_NM LIKE #{sCustNm}
            </when>
            <otherwise>
           AND A.CUST_NM = #{sCustNm}
            </otherwise>
        </choose>
        </if>
           AND A.DLR_CD  = #{sDlrCd}
           AND A.USR_ID = #{sUsrId}
         GROUP BY SUBSTR(A.APPLY_DT,1,4)||LPAD(A.REQ_SEQ,5,0), A.CUST_NM, A.ATC_DSTIN_CD,
               A.APPLY_DT, A.APPROVE_CD, A.DLR_CD, A.USR_ID, A.REQ_SEQ
         ) AA
         WHERE 1=1
         <if test='sApproveCd != null and sApproveCd != ""'>
           AND AA.APPROVE_CD = #{sApproveCd}  -- 상태
         </if>
         ORDER BY
         <choose>
            <when test='sort != null'>
                <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                    <choose>
                        <when test='item.field == "applyNo"'>APPLY_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "custNm"'>CUST_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "atcDstinCd"'>ATC_DSTIN_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "reqQty"'>REQ_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "applyDt"'>APPLY_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "approveCd"'>APPROVE_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "assignQty"'>ASSIGN_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <otherwise>
                            REQ_SEQ DESC
                        </otherwise>
                    </choose>
                 </foreach>
            </when>
            <otherwise>
                    REQ_SEQ DESC
            </otherwise>
        </choose>
    </select>


    <!-- 집단오더 판매 상세 조회 -->
    <select id="selectGroupSalesApplicationDetailByKey" parameterType="GroupSalesApplicationSearchVO" resultType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplicationDetailByKey] */

            SELECT T1.*
                  ,(SELECT DLR_SHT_NM FROM CM_0101T X WHERE X.DLR_CD  = T1.DLR_CD) AS DLR_NM
                  ,(SELECT OFF_NM
                      FROM CM_2601T Y , CM_0101T C
                     WHERE Y.DIVI_CD = C.SDPT_CD
                       AND Y.OFF_CD  = C.DIST_OFFICE_CD
                       AND C.DLR_CD  = T1.DLR_CD
                   ) AS OFFICE_NM
             FROM (
             SELECT A.DLR_CD
                   ,A.USR_ID
                   ,A.REQ_SEQ
                   ,A.CUST_NM
                   ,A.PRSN_ID
                   ,A.ZIP_CD
                   ,A.ADDR
                   ,A.HP_NO
                   ,A.FAX_NO
                   ,A.ATC_DSTIN_CD
                   ,A.ATC_CONT
                   ,A.CAR_USE_TP
                   ,A.PRSN_DLR_CD
                   ,A.PRSN_DLR_TEL_NO
                   ,A.LONG_DCSS_YN
                   ,TO_DATE(A.CAR_ALLOC_HOPE_DT, 'YYYYMMDD') AS CAR_ALLOC_HOPE_DT
                   ,A.RETL_AMT
                   ,A.RCPT_AMT
                   ,A.DC_AMT
                   ,A.TEL_NO
                   ,A.APPROVE_CD
                   ,A.FILE_DOC_ID
                   ,(
                     SELECT EVAL_GRADE_CD
                       FROM SA_0156T
                      WHERE 1=1
                        AND DLR_CD       = #{sApporveDlrCd}
                        AND USR_ID       = #{sApporveUsrId}
                        AND WRK_DSTIN_CD = #{sWrkDstinCd}
                   )AS EVAL_USR_GRDE
                   ,NVL(MAX(CASE WHEN A.CONTRACT_DOC_SEQ = B.FILE_NO THEN FILE_NO END ) ,0) AS CONTRACT_FILE_NO
                   ,MAX(CASE WHEN A.CONTRACT_DOC_SEQ = B.FILE_NO THEN FILE_NM END ) AS CONTRACT_FILE_NM
                   ,NVL(MAX(CASE WHEN A.CRN_DOC_SEQ = B.FILE_NO THEN FILE_NO END ) ,0) AS BUSS_LICENCE_FILE_NO
                   ,MAX(CASE WHEN A.CRN_DOC_SEQ = B.FILE_NO THEN FILE_NM END ) AS BUSS_LICENCE_FILE_NM
                   ,NVL(MAX(CASE WHEN A.ETC_DOC_SEQ = B.FILE_NO THEN FILE_NO END ) ,0) AS ETC_FILE_NO
                   ,MAX(CASE WHEN A.ETC_DOC_SEQ = B.FILE_NO THEN FILE_NM END ) AS ETC_FILE_NM
                   ,NVL(MAX(CASE WHEN A.ADD_FILE_SEQ = B.FILE_NO THEN FILE_NO END ) ,0) AS ADD_FILE_NO
                   ,MAX(CASE WHEN A.ADD_FILE_SEQ = B.FILE_NO THEN FILE_NM END ) AS ADD_FILE_NM
              FROM SA_0414T A LEFT OUTER JOIN  CM_0902T B
               ON  B.FILE_DOC_NO = A.FILE_DOC_ID
             WHERE A.DLR_CD  = #{sDlrCd}
               AND A.USR_ID  = #{sUsrId}
               AND A.REQ_SEQ = #{sReqSeq}
               GROUP BY A.DLR_CD
                       ,A.USR_ID
                       ,A.REQ_SEQ
                       ,A.CUST_NM
                       ,A.PRSN_ID
                       ,A.ZIP_CD
                       ,A.ADDR
                       ,A.HP_NO
                       ,A.FAX_NO
                       ,A.ATC_DSTIN_CD
                       ,A.ATC_CONT
                       ,A.CAR_USE_TP
                       ,A.PRSN_DLR_CD
                       ,A.PRSN_DLR_TEL_NO
                       ,A.LONG_DCSS_YN
                       ,CAR_ALLOC_HOPE_DT
                       ,A.RETL_AMT
                       ,A.RCPT_AMT
                       ,A.DC_AMT
                       ,A.TEL_NO
                       ,A.APPROVE_CD
                       ,A.FILE_DOC_ID
             ) T1

    </select>

    <!-- 조회 목록  -->
    <select id="selectGroupSalesApplicationDetailByCondition" parameterType="GroupSalesApplicationVO" resultType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplicationDetailByCondition] */
        SELECT DLR_CD,USR_ID,REQ_SEQ,CUST_NM,PRSN_ID,ZIP_CD,ADDR,HP_NO,FAX_NO,ATC_DSTIN_CD,ATC_CONT
             , CAR_USE_TP,PRSN_DLR_CD,PRSN_DLR_TEL_NO,LONG_DCSS_YN,CAR_ALLOC_HOPE_DT,FILE_DOC_ID
             , RETL_AMT,RCPT_AMT,DC_AMT,APPROVE_CD,TEL_NO
             , MAX(CONTRACT_FILE_NM) AS CONTRACT_FILE_NM
             , MAX(BUSS_LICENCE_FILE_NM) AS BUSS_LICENCE_FILE_NM,MAX(ETC_FILE_NM) AS ETC_FILE_NM
             , MAX(ADD_FILE_NM) AS ADD_FILE_NM
             , NVL(MAX(CONTRACT_FILE_NO),0) AS CONTRACT_FILE_NO
             , NVL(MAX(BUSS_LICENCE_FILE_NO),0) AS BUSS_LICENCE_FILE_NO
             , NVL(MAX(ETC_FILE_NO),0) AS ETC_FILE_NO
             , NVL(MAX(ADD_FILE_NO),0) AS ADD_FILE_NO
        FROM (
                SELECT A.DLR_CD
                     , A.USR_ID
                     , A.REQ_SEQ
                     , A.CUST_NM
                     , A.PRSN_ID
                     , A.ZIP_CD
                     , A.ADDR
                     , A.HP_NO
                     , A.FAX_NO
                     , A.ATC_DSTIN_CD
                     , A.ATC_CONT
                     , A.CAR_USE_TP
                     , A.PRSN_DLR_CD
                     , A.PRSN_DLR_TEL_NO
                     , A.LONG_DCSS_YN
                     , TO_DATE(A.CAR_ALLOC_HOPE_DT, 'YYYYMMDD') AS CAR_ALLOC_HOPE_DT
                     , A.FILE_DOC_ID
                     , A.RETL_AMT
                     , A.RCPT_AMT
                     , A.DC_AMT
                     , A.TEL_NO
                     , A.APPROVE_CD
                     , CASE WHEN A.CONTRACT_DOC_SEQ = D.FILE_NO THEN FILE_NM END AS CONTRACT_FILE_NM
                     , CASE WHEN A.CRN_DOC_SEQ = D.FILE_NO THEN FILE_NM END AS BUSS_LICENCE_FILE_NM
                     , CASE WHEN A.ETC_DOC_SEQ = D.FILE_NO THEN FILE_NM END AS ETC_FILE_NM
                     , CASE WHEN A.ADD_FILE_SEQ = D.FILE_NO THEN FILE_NM END AS ADD_FILE_NM
                     , CASE WHEN A.CONTRACT_DOC_SEQ = D.FILE_NO THEN FILE_NO END AS CONTRACT_FILE_NO
                     , CASE WHEN A.CRN_DOC_SEQ = D.FILE_NO THEN FILE_NO END AS BUSS_LICENCE_FILE_NO
                     , CASE WHEN A.ETC_DOC_SEQ = D.FILE_NO THEN FILE_NO END AS ETC_FILE_NO
                     , CASE WHEN A.ADD_FILE_SEQ = D.FILE_NO THEN FILE_NO END AS ADD_FILE_NO
                  FROM SA_0414T A,
                       (SELECT B.FILE_DOC_NO,C.FILE_NO,C.FILE_TP,C.FILE_NM,C.FILE_SIZE,C.FILE_DATA
                          FROM CM_0901T B, CM_0902T C
                         WHERE 1=1
                           AND B.FILE_DOC_NO = C.FILE_DOC_NO
                       ) D
                 WHERE A.FILE_DOC_ID = D.FILE_DOC_NO(+)
                   AND A.DLR_CD = #{dlrCd}
                   AND A.USR_ID = #{usrId}
                   AND A.REQ_SEQ = #{reqSeq}
             )
       GROUP BY DLR_CD,USR_ID,REQ_SEQ,CUST_NM,PRSN_ID,ZIP_CD,ADDR,HP_NO,FAX_NO,ATC_DSTIN_CD,ATC_CONT
               ,CAR_USE_TP,PRSN_DLR_CD,PRSN_DLR_TEL_NO,LONG_DCSS_YN,CAR_ALLOC_HOPE_DT
               ,FILE_DOC_ID,RETL_AMT,RCPT_AMT,DC_AMT,APPROVE_CD,TEL_NO

    </select>

    <!-- 조회 목록  -->
    <select id="selectGroupSalesApplicationDetVehByCondition" parameterType="GroupSalesApplicationSearchVO" resultType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplicationDetVehByCondition] */
        SELECT DLR_CD,USR_ID,REQ_SEQ,CARLINE_CD,CARLINE_NM,MODEL_CD,MODEL_NM
             , COUNT(CARLINE_CD) AS CNT,REQ_QTY
          FROM (
                SELECT SA0414.DLR_CD AS DLR_CD
                     , SA0414.USR_ID AS USR_ID
                     , SA0414.REQ_SEQ AS REQ_SEQ
                     , SA0413.REQ_NO AS REQ_NO
                     , SA0415.CARLINE_CD AS CARLINE_CD
                     , FN_GET_CARLINE_NM(SA0415.CARLINE_CD) AS CARLINE_NM
                     , SA0415.MODEL_CD AS MODEL_CD
                     , FN_GET_MODEL_NM(SA0415.MODEL_CD) AS MODEL_NM
                     , SA0415.OCN_CD
                     , FN_GET_OCN_NM(SA0415.MODEL_CD,SA0415.OCN_CD) AS OCN_NM
                     , SA0415.EXT_COLOR_CD
                     , FN_GET_EXT_COLOR_NM(SA0415.EXT_COLOR_CD) AS EXT_COLOR_NM
                 	 , SA0415.INT_COLOR_CD
                 	 , FN_GET_INT_COLOR_NM(SA0415.INT_COLOR_CD) AS INT_COLOR_NM
                     , SA0415.REQ_QTY
                  FROM SA_0414T SA0414
                     , SA_0415T SA0415
                     , SA_0413T SA0413
                 WHERE SA0414.DLR_CD = #{sDlrCd}
                   AND SA0414.USR_ID = #{sUsrId}
                   AND SA0414.REQ_SEQ = #{sReqSeq}
                   AND SA0414.DLR_CD = SA0415.DLR_CD
                   AND SA0414.USR_ID = SA0415.USR_ID
                   AND SA0414.REQ_SEQ = SA0415.REQ_SEQ
                   AND SA0415.DLR_CD = SA0413.DLR_CD
                   AND SA0415.USR_ID = SA0413.USR_ID
                   AND SA0415.REQ_SEQ = SA0413.REQ_SEQ
                   AND SA0415.REQ_LOWER_SEQ = SA0413.REQ_LOWER_SEQ
               )
         GROUP BY DLR_CD,USR_ID,REQ_SEQ,CARLINE_CD,CARLINE_NM,MODEL_CD,MODEL_NM,REQ_QTY
    </select>

    <!-- 조회 목록  -->
    <select id="selectGroupSalesApplicationDetJdgByCondition" parameterType="GroupSalesApplicationSearchVO" resultType="GroupSalesApplicationJdgVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplicationDetJdgByCondition] */
        SELECT DLR_CD
             , USR_ID
             , REQ_SEQ
             , REQ_NO
             ,( SELECT B.USR_NM
                 FROM CM_0801T B
                WHERE B.USR_ID = PEVAL_ID) PEVAL_ID
             , EVAL_DT
             , FN_CMM_CD_NM('SAL131',EVAL_RSLT_YN, #{sLangCd},'N') AS EVAL_RSLT_YN
             , REMARK
          FROM SA_0412T
         WHERE DLR_CD = #{sDlrCd}
           AND USR_ID = #{sUsrId}
           AND REQ_SEQ = #{sReqSeq}
           <!-- 심사이력을 갖고 오는것 같은데, 마지막 이력을 갖고 오고 있어 주석처리함. 필요시 다시 해제,불필요시 삭제 (09.27 kim yewon)
           AND REQ_NO = ( SELECT MAX(REQ_NO) FROM SA_0412T
                           WHERE DLR_CD = #{sDlrCd}
                             AND USR_ID = #{sUsrId}
                             AND REQ_SEQ = #{sReqSeq}
                           GROUP BY DLR_CD, USR_ID, REQ_SEQ )
           -->
         ORDER BY REG_DT DESC
    </select>

    <!-- 법인 - 집단판매 신청 저장 -->
    <insert id="insertGroupSalesApplication" parameterType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.insertGroupSalesApplication] */
        <selectKey resultType="int" keyProperty="reqSeq" order="BEFORE">
            SELECT NVL(MAX(REQ_SEQ), 0) + 1 AS REQ_SEQ FROM SA_0414T
             WHERE DLR_CD = #{dlrCd}
               AND USR_ID = #{usrId}
        </selectKey>
        INSERT
          INTO SA_0414T(
               DLR_CD
             , USR_ID
             , REQ_SEQ
             , EVAL_GRADE_CD
             , CUST_NM
             , ZIP_CD
             , ADDR
             , PRSN_ID
             , HP_NO
             , FAX_NO
             , ATC_DSTIN_CD
             , CAR_USE_TP
             , ATC_CONT
             , PRSN_DLR_CD
             , PRSN_DLR_TEL_NO
             , APPROVE_CD
             , APPLY_DT
             , REG_USR_ID
             , REG_DT
             , UPDT_USR_ID
             , UPDT_DT
             , FILE_DOC_ID
             , CONTRACT_DOC_SEQ
             , CRN_DOC_SEQ
             , ETC_DOC_SEQ
             , ADD_FILE_SEQ
             , RETL_AMT
             , RCPT_AMT
             , DC_AMT
             , TEL_NO
         )VALUES(
               #{dlrCd}
             , #{usrId}
             , #{reqSeq}
             , (SELECT GRADE_CD FROM SA_0435T WHERE WRK_DSTIN_CD = '01')
             , #{custNm}
             , #{zipCd}
             , #{addr}
             , #{prsnId}
             , #{hpNo}
             , #{faxNo}
             , #{atcDstinCd}
             , #{carUseTp}
             , #{atcCont}
             , #{prsnDlrCd}
             , #{prsnDlrTelNo}
             , #{approveCd}
             , SYSDATE
             , #{regUsrId}
             , SYSDATE
             , #{updtUsrId}
             , SYSDATE
             , #{headFileDocId}
             , #{contractFileNo}
             , #{bussLicenceNo}
             , #{etcFileNo}
             , #{addFileNo}
             , #{retlAmt}
             , #{rcptAmt}
             , #{dcAmt}
             , #{telNo}
        )
    </insert>

    <!-- 법인 - 집단 판매 신청 확정 -->
    <update id="updateGroupSalesApplicationCnfrm" parameterType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.updateGroupSalesApplicationCnfrm] */
        UPDATE SA_0414T
           set APPROVE_CD = 'B'
             , APPLY_DT = SYSDATE
             , UPDT_USR_ID = #{updtUsrId}
             , UPDT_DT = SYSDATE
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
    </update>

    <!-- 법인 - 집단 판매 신청 수정 -->
    <update id="updateGroupSalesApplication" parameterType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.updateGroupSalesApplication] */
        UPDATE SA_0414T
           set CUST_NM = #{custNm}
             , ZIP_CD = #{zipCd}
             , ADDR = #{addr}
             , PRSN_ID = #{prsnId}
             , HP_NO = #{hpNo}
             , TEL_NO = #{telNo}
             , FAX_NO = #{faxNo}
             , ATC_DSTIN_CD = #{atcDstinCd}
             , CAR_USE_TP = #{carUseTp}
             , ATC_CONT = #{atcCont}
             , PRSN_DLR_CD = #{prsnDlrCd}
             , PRSN_DLR_TEL_NO = #{prsnDlrTelNo}
             , RETL_AMT = #{whPrc}
             , RCPT_AMT = #{rcptAmt}
             , DC_AMT = #{dcAmt}
             , FILE_DOC_ID = #{headFileDocId}
             , CONTRACT_DOC_SEQ = #{contractFileNo}
             , CRN_DOC_SEQ = #{bussLicenceNo}
             , ETC_DOC_SEQ = #{etcFileNo}
             , ADD_FILE_SEQ = #{addFileNo}
             , UPDT_USR_ID = #{updtUsrId}
             , UPDT_DT = SYSDATE
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
    </update>

    <!-- 법인 - 집단 판매신청 삭제 -->
    <delete id="deleteGroupSalesApplication" parameterType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.deleteGroupSalesApplication] */
        DELETE FROM SA_0414T
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
    </delete>

    <!-- 법인 - 집단판매 신청 차량정보 저장 -->
    <insert id="insertGroupSalesApplicationVeh" parameterType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.insertGroupSalesApplicationVeh] */
        <selectKey resultType="int" keyProperty="reqLowerSeq" order="BEFORE">
            SELECT NVL(MAX(REQ_LOWER_SEQ), 0) + 1 AS REQ_LOWER_SEQ FROM SA_0415T
             WHERE DLR_CD = #{dlrCd}
               AND USR_ID = #{usrId}
               AND REQ_SEQ = #{reqSeq}
        </selectKey>
        INSERT
          INTO SA_0415T(
               DLR_CD
             , USR_ID
             , REQ_SEQ
             , REQ_LOWER_SEQ
             , CARLINE_CD
             , MODEL_CD
             , OCN_CD
             , EXT_COLOR_CD
             , INT_COLOR_CD
             , REQ_QTY
             , REG_USR_ID
             , REG_DT
             , UPDT_USR_ID
             , UPDT_DT
         )VALUES(
               #{dlrCd}
             , #{usrId}
             , #{reqSeq}
             , #{reqLowerSeq}
             , #{carlineCd}
             , #{modelCd}
             , #{ocnCd}
             , #{extColorCd}
             , #{intColorCd}
             , 1
             , #{regUsrId}
             , SYSDATE
             , #{updtUsrId}
             , SYSDATE
         )
    </insert>

    <!-- 조회 목록  -->
    <select id="selectGroupSalesApplicationDetGrpByCondition" parameterType="GroupSalesApplicationVehVO" resultType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplicationDetGrpByCondition] */
        SELECT DLR_CD
             , USR_ID
             , REQ_SEQ
             , REQ_LOWER_SEQ
             , MAX(CARLINE_CD) AS CARLINE_CD
             , MAX(MODEL_CD) AS MODEL_CD
             , MAX(OCN_CD) AS OCN_CD
             , MAX(EXT_COLOR_CD) AS EXT_COLOR_CD
             , MAX(INT_COLOR_CD) AS INT_COLOR_CD
             , COUNT(*) AS REQ_QTY
             , #{regUsrId} AS REG_USR_ID
             , SYSDATE AS REG_DT
             , #{updtUsrId} AS UPDT_USR_ID
             , SYSDATE AS UPDT_DT
          FROM SA_0413T
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
           AND REQ_LOWER_SEQ = #{reqLowerSeq}
         GROUP BY DLR_CD, USR_ID, REQ_SEQ, REQ_LOWER_SEQ
    </select>

    <!-- 법인 - 집단판매 신청 차량정보 수정 -->
    <update id="updateGroupSalesApplicationVeh" parameterType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.updateGroupSalesApplicationVeh] */
        UPDATE SA_0415T
           set CARLINE_CD = #{carlineCd}
             , MODEL_CD = #{modelCd}
             , OCN_CD = #{ocnCd}
             , EXT_COLOR_CD = #{extColorCd}
             , INT_COLOR_CD = #{intColorCd}
             , REQ_QTY = #{reqQty}
             , UPDT_USR_ID = #{updtUsrId}
             , UPDT_DT = SYSDATE
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_NO = #{reqNo}
           AND REQ_SEQ = #{reqSeq}
           AND REQ_LOWER_SEQ = #{reqLowerSeq}
    </update>

    <!-- 법인 - 집단 판매신청 차량정보 삭제 -->
    <delete id="deleteGroupSalesApplicationVeh" parameterType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.deleteGroupSalesApplicationVeh] */
        DELETE FROM SA_0415T
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
    </delete>

    <!-- 법인 - 집단판매 신청 차량 상세정보 저장 -->
    <insert id="insertGroupSalesApplicationVehDet" parameterType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.insertGroupSalesApplicationVehDet] */
        <selectKey resultType="int" keyProperty="reqNo" order="BEFORE">
            SELECT NVL(MAX(REQ_NO), 0) + 1 AS REQ_NO FROM SA_0413T
             WHERE DLR_CD = #{dlrCd}
               AND USR_ID = #{usrId}
               AND REQ_SEQ = #{reqSeq}
               AND REQ_LOWER_SEQ = #{reqLowerSeq}
        </selectKey>
        INSERT
          INTO SA_0413T(
               DLR_CD
             , USR_ID
             , REQ_SEQ
             , REQ_LOWER_SEQ
             , REQ_NO
             , CARLINE_CD
             , MODEL_CD
             , OCN_CD
             , EXT_COLOR_CD
             , INT_COLOR_CD
             , STOCK_VIN_NO1
             , STOCK_VIN_NO2
             , FILE_DOC_ID
             , ENGIN_NO
             , REG_USR_ID
             , REG_DT
             , UPDT_USR_ID
             , UPDT_DT
         )VALUES(
               #{dlrCd}
             , #{usrId}
             , #{reqSeq}
             , #{reqLowerSeq}
             , #{reqNo}
             , #{carlineCd}
             , #{modelCd}
             , #{ocnCd}
             , #{extColorCd}
             , #{intColorCd}
             , SUBSTR(#{vinNo}, 1, 11)
             , SUBSTR(#{vinNo}, 12, 6)
             , #{fileDocId}
             , #{enginNo}
             , #{regUsrId}
             , SYSDATE
             , #{updtUsrId}
             , SYSDATE
        )
    </insert>

    <!-- 시승차량신청 팝업 차량 수정 -->
    <update id="updateGroupSalesApplicationVehDet" parameterType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.updateGroupSalesApplicationVehDet] */
        UPDATE SA_0413T
           set CARLINE_CD = #{carlineCd}
             , MODEL_CD = #{modelCd}
             , OCN_CD = #{ocnCd}
             , EXT_COLOR_CD = #{extColorCd}
             , INT_COLOR_CD = #{intColorCd}
             , SPC_CAR_QTY = #{spcCarQty}
             , STOCK_VIN_NO1 = SUBSTR(#{vinNo}, 1, 11)
             , STOCK_VIN_NO2 = SUBSTR(#{vinNo}, 12, 6)
             , ENGIN_NO = #{enginNo}
             , UPDT_USR_ID = #{updtUsrId}
             , UPDT_DT = SYSDATE
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
           AND REQ_LOWER_SEQ = #{reqLowerSeq}
           AND REQ_NO = #{reqNo}
    </update>

    <!-- 법인 - 집단 판매신청 차량 상세정보 삭제 -->
    <delete id="deleteGroupSalesApplicationVehDet" parameterType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.deleteGroupSalesApplicationVehDet] */
        DELETE FROM SA_0413T
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
    </delete>

    <!-- 법인 - 집단판매 신청 팝업 적용 가능 차량 정보 조회 -->
    <select id="applyGroupSalesApplicationPopup" parameterType="GroupSalesApplicationPopupVO" resultType="GroupSalesApplicationPopupVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.applyGroupSalesApplicationPopup] */
        SELECT CARLINE_CD
             , MODEL_CD
             , OCN_CD
             , EXT_COLOR_CD
             , INT_COLOR_CD
             , VIN_NO
             , ENGIN_SERIAL_NO AS ENGIN_NO
          FROM SA_0121T
         WHERE 1=1
           AND CAR_ID = #{carId}
    </select>



    <!-- 차량마스터관리PopUp 리스트 -->
    <select id="selectVehicleInfoByConditionCnt" parameterType="GroupSalesApplicationSearchVO" resultType="int">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectVehicleInfoByConditionCnt] */
        SELECT COUNT(*)
          FROM SA_0121T A
         WHERE 1=1
         <if test='sDlrCd != null and sDlrCd != ""'>
           AND A.ORD_DLR_CD = #{sDlrCd}
         </if>
<!--          <if test='sVinNo != null and sVinNo != ""'>
            <choose>
              <when test='@org.apache.commons.lang3.StringUtils@contains(sVinNo,"*")'>
                 <bind name='sVinNo' value='@org.apache.commons.lang3.StringUtils@replace(sVinNo, "*", "%")' />
                  AND A.VIN_NO LIKE #{sVinNo}
              </when>
              <otherwise>
                  AND A.VIN_NO = #{sVinNo}
              </otherwise>
            </choose>
          </if> -->
          <if test='sVinNo != null and sVinNo != ""'>
            AND A.VIN_NO LIKE '%' || #{sVinNo} || '%'
          </if>
          <if test='sCarlineCd != null and sCarlineCd != ""'>
            AND A.CARLINE_CD = #{sCarlineCd}
          </if>
          <if test='sModelCd != null and sModelCd != ""'>
            AND A.MODEL_CD = #{sModelCd}
          </if>
            AND A.VIN_NO NOT IN (  SELECT SA0413.STOCK_VIN_NO1 || SA0413.STOCK_VIN_NO2 AS VIN_NO
                                             FROM SA_0413T SA0413
                                            WHERE SA0413.DLR_CD = #{sDlrCd}
                                              AND SA0413.USR_ID = #{sUsrId}
                                 )
    </select>
    <select id="selectVehicleInfoByCondition" parameterType="GroupSalesApplicationSearchVO" resultType="VehicleMasterVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectVehicleInfoByCondition] */
        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT A.VIN_NO
                	 , A.CAR_ID
                     , A.CARLINE_CD
                     , FN_GET_CARLINE_NM_NC(A.CARLINE_CD) AS CARLINE_NM
                     , FN_GET_CARLINE_NM(A.CARLINE_CD) AS CARLINE_CD_NM
                     , A.MODEL_CD
                     , FN_GET_MODEL_NM_NC(A.MODEL_CD) AS MODEL_NM
                     , FN_GET_MODEL_NM(A.MODEL_CD) AS MODEL_CD_NM
                     , A.OCN_CD
                     , FN_GET_OCN_NM_NC(A.MODEL_CD, A.OCN_CD) AS OCN_NM
                     , FN_GET_OCN_NM(A.MODEL_CD,A.OCN_CD) AS OCN_CD_NM
                     , A.EXT_COLOR_CD
                     , FN_GET_EXT_COLOR_NM_NC(A.EXT_COLOR_CD) AS EXT_COLOR_NM
                     , FN_GET_EXT_COLOR_NM(A.EXT_COLOR_CD) AS EXT_COLOR_CD_NM
                 	 , A.INT_COLOR_CD
                 	 , FN_GET_INT_COLOR_NM_NC(A.INT_COLOR_CD) AS INT_COLOR_NM
                 	 , FN_GET_INT_COLOR_NM(A.INT_COLOR_CD) AS INT_COLOR_CD_NM
                     , (SELECT NVL(MAX(MS_PRC),0) FROM SA_0110T WHERE MODEL_CD = A.MODEL_CD AND OCN_CD = A.OCN_CD AND END_DT  >=  SYSDATE) AS MS_PRC
                  FROM SA_0121T A
                 WHERE 1=1
                 <if test='sDlrCd != null and sDlrCd != ""'>
                   AND A.ORD_DLR_CD = #{sDlrCd}
                 </if>
<!--                  <if test='sVinNo != null and sVinNo != ""'>
                    <choose>
                      <when test='@org.apache.commons.lang3.StringUtils@contains(sVinNo,"*")'>
                         <bind name='sVinNo' value='@org.apache.commons.lang3.StringUtils@replace(sVinNo, "*", "%")' />
                          AND A.VIN_NO LIKE #{sVinNo}
                      </when>
                      <otherwise>
                          AND A.VIN_NO = #{sVinNo}
                      </otherwise>
                    </choose>
                  </if> -->
                  <if test='sVinNo != null and sVinNo != ""'>
                    AND A.VIN_NO LIKE '%' || #{sVinNo} || '%'
                  </if>
                  <if test='sCarlineCd != null and sCarlineCd != ""'>
                    AND A.CARLINE_CD = #{sCarlineCd}
                  </if>
                  <if test='sModelCd != null and sModelCd != ""'>
                    AND A.MODEL_CD = #{sModelCd}
                  </if>
                    AND A.VIN_NO NOT IN (  SELECT SA0413.STOCK_VIN_NO1 || SA0413.STOCK_VIN_NO2 AS VIN_NO
                                             FROM SA_0413T SA0413
                                            WHERE SA0413.DLR_CD = #{sDlrCd}
                                              AND SA0413.USR_ID = #{sUsrId}
                                         )
            ) T1
                <where>
                    <if test='firstIndex != -1 and lastIndex != -1'>
                        ROWNUM <![CDATA[<=]]> #{lastIndex}
                    </if>
                </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>




    <!-- 차량마스터관리PopUp 리스트 -->
    <select id="selectDetlVehPopByConditionCnt" parameterType="GroupSalesApplicationSearchVO" resultType="int">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectDetlVehPopByConditionCnt] */

        SELECT COUNT(A.REQ_SEQ) AS VALUE
          FROM SA_0414T A , SA_0413T B
         WHERE A.DLR_CD   = #{sDlrCd}
           AND A.USR_ID   = #{sUsrId}
           AND A.REQ_SEQ  = #{sReqSeq}
           AND B.DLR_CD   = A.DLR_CD
           AND B.USR_ID   = A.USR_ID
           AND B.REQ_SEQ  = A.REQ_SEQ

    </select>

    <!-- 집단판매 차량정보 조회 -->
    <select id="selectDetlVehPopByCondition" parameterType="GroupSalesApplicationSearchVO" resultType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectDetlVehPopByCondition] */
        SELECT * FROM (
            SELECT ROWNUM AS RNUM ,T1.* FROM (
                 SELECT T.*
                       ,NVL(DECODE(C.DAMT, NULL, 0, (NVL(C.DAMT,0)+NVL(C.AAMT,0))/C.DAMT) ,0)AS DC_RATE
                       ,NVL(C.AAMT,0) AS AAMT
                   FROM (
                        SELECT A.DLR_CD
                              ,A.USR_ID
                              ,A.REQ_SEQ
                              ,A.APPROVE_CD
                              ,B.REQ_LOWER_SEQ
                              ,B.CARLINE_CD
                              ,B.MODEL_CD
                              ,B.STOCK_VIN_NO1 || B.STOCK_VIN_NO2 AS VIN_NO
                              ,B.STOCK_VIN_NO1
                              ,B.STOCK_VIN_NO2
                              ,B.FILE_DOC_ID
                              ,(
                               SELECT COUNT(FILE_NO) AS FILE_CNT
                                 FROM CM_0902T
                                 WHERE FILE_DOC_NO  = B.FILE_DOC_ID
                                   AND DEL_YN = 'N'
                              ) AS FILE_DOC_CNT
                              ,FN_GET_CARLINE_NM_NC(B.CARLINE_CD) AS CARLINE_NM
                              ,FN_GET_MODEL_TP_NM(B.MODEL_CD,B.OCN_CD) AS MODEL_NM
                              ,B.OCN_CD
                              ,FN_GET_OCN_NM_NC(B.MODEL_CD,B.OCN_CD) AS OCN_NM
                              ,B.EXT_COLOR_CD
                              ,FN_GET_EXT_COLOR_NM_NC(B.EXT_COLOR_CD) AS EXT_COLOR_NM
                              ,B.INT_COLOR_CD
                              ,FN_GET_INT_COLOR_NM_NC(B.INT_COLOR_CD) AS INT_COLOR_NM
                              ,(SELECT NVL(MAX(MS_PRC),0) FROM SA_0110T WHERE MODEL_CD = B.MODEL_CD AND OCN_CD = B.OCN_CD AND END_DT  >=  SYSDATE) AS MS_PRC
                          FROM SA_0414T A , SA_0413T B
                         WHERE A.DLR_CD   = #{sDlrCd}
                           AND A.USR_ID   = #{sUsrId}
                           AND A.REQ_SEQ  = #{sReqSeq}
                           AND B.DLR_CD   = A.DLR_CD
                           AND B.USR_ID   = A.USR_ID
                           AND B.REQ_SEQ  = A.REQ_SEQ
                       )T LEFT OUTER JOIN SA_0416T C
                       ON T.STOCK_VIN_NO1 = C.VIN_NO1
                      AND T.STOCK_VIN_NO2 = C.VIN_NO2
                      AND T.DLR_CD        = C.DLR_CD
                ) T1
                <where>
                    <if test='firstIndex != -1 and lastIndex != -1'>
                        ROWNUM <![CDATA[<=]]> #{lastIndex}
                    </if>
                </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>



    <!-- 집단판매신청된 차량 삭제(집단판매신청명세) -->
    <delete id="deleteGroupSalesVehDetl" parameterType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.deleteGroupSalesVehDetl] */
        DELETE SA_0413T
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
           AND REQ_LOWER_SEQ = #{reqLowerSeq}
    </delete>



    <!-- 집단판매신청된 차량 삭제(집단판매신청서브헤더) -->
    <delete id="deleteGroupSalesVehSubHead" parameterType="GroupSalesApplicationVehVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.deleteGroupSalesVehSubHead] */
        DELETE SA_0415T
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
           AND REQ_LOWER_SEQ = #{reqLowerSeq}
    </delete>


    <!-- 시승차량신청 팝업 차량 수정 (차량FILE_DOC_ID추가)-->
    <update id="updateGroupSalesFile" parameterType="GroupSalesApplicationVehVO">
        UPDATE SA_0413T
           SET FILE_DOC_ID = #{fileDocId}
             , UPDT_USR_ID = #{updtUsrId}
             , UPDT_DT = SYSDATE
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
           AND REQ_LOWER_SEQ = #{reqLowerSeq}
    </update>

    <update id="deleteSaveAddFile" parameterType="GroupSalesApplicationVehVO">
        DELETE SA_0414IS
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
    </update>

    <!-- 집단판매 보충자료 파일업로드 (차량FILE_DOC_ID추가)-->
    <update id="updateSaveAddFile" parameterType="GroupSalesApplicationVehVO">
        UPDATE SA_0414T
           SET ADD_FILE_SEQ = #{addFileNo}
             , UPDT_USR_ID = #{updtUsrId}
             , UPDT_DT = SYSDATE
         WHERE DLR_CD = #{dlrCd}
           AND USR_ID = #{usrId}
           AND REQ_SEQ = #{reqSeq}
    </update>

    <!-- 집단판매 보충자료 파일업로드 (차량FILE_DOC_ID추가)-->
    <update id="updateSaveAddFileForInterface" parameterType="GroupSalesApplicationVehVO">
     MERGE INTO SA_0414IS A
              USING(SELECT #{dlrCd} AS DLR_CD
                          ,#{usrId} AS USR_ID
                          ,#{reqSeq} AS REQ_SEQ
                          ,#{addFileNo} AS ADD_FILE_SEQ
                          ,(SELECT X.REG_USR_ID
                              FROM SA_0414T X
                             WHERE X.DLR_CD  = #{dlrCd}
                               AND X.USR_ID  = #{usrId}
                               AND X.REQ_SEQ = #{reqSeq}) AS REG_USR_ID
                          ,(SELECT Y.REG_DT
                              FROM SA_0414T Y
                             WHERE Y.DLR_CD  = #{dlrCd}
                               AND Y.USR_ID  = #{usrId}
                               AND Y.REQ_SEQ = #{reqSeq}) AS REG_DT
                          ,'Y' AS EVAL_YN
                          ,#{updtUsrId} AS UPDT_USR_ID
                          ,SYSDATE AS UPDT_DT
                          ,'N' AS IFRESULT
                      FROM DUAL) B
                    ON(A.DLR_CD  = B.DLR_CD
                   AND A.USR_ID  = B.USR_ID
                   AND A.REQ_SEQ = B.REQ_SEQ)
      WHEN MATCHED THEN
          UPDATE SET A.ADD_FILE_SEQ = B.ADD_FILE_SEQ
                    ,A.IFRESULT     = B.IFRESULT
                    ,A.UPDT_USR_ID  = B.UPDT_USR_ID
                    ,A.UPDT_DT      = B.UPDT_DT
                    ,A.EVAL_YN      = B.EVAL_YN
      WHEN NOT MATCHED THEN
          INSERT(A.DLR_CD
                ,A.USR_ID
                ,A.REQ_SEQ
                ,A.IFRESULT
                ,A.ADD_FILE_SEQ
                ,A.REG_USR_ID
                ,A.REG_DT
                ,A.UPDT_USR_ID
                ,A.UPDT_DT
                ,A.EVAL_YN
                )VALUES(
                 B.DLR_CD
                ,B.USR_ID
                ,B.REQ_SEQ
                ,B.IFRESULT
                ,B.ADD_FILE_SEQ
                ,B.REG_USR_ID
                ,B.REG_DT
                ,B.UPDT_USR_ID
                ,B.UPDT_DT
                ,B.EVAL_YN
                )
    </update>

    <!-- 신규  -->
    <select id="selectGroupSalesApplication" parameterType="GroupSalesApplicationVO" resultType="GroupSalesApplicationVO">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.selectGroupSalesApplication] */
		SELECT DLR_CD,USR_ID,REQ_SEQ,CUST_NM,PRSN_ID,ZIP_CD,ADDR,HP_NO,FAX_NO,ATC_DSTIN_CD,ATC_CONT
             , CAR_USE_TP,PRSN_DLR_CD,PRSN_DLR_TEL_NO,LONG_DCSS_YN,CAR_ALLOC_HOPE_DT,FILE_DOC_ID
             , RETL_AMT,RCPT_AMT,DC_AMT,APPROVE_CD,TEL_NO
             , MAX(CONTRACT_FILE_NM) AS CONTRACT_FILE_NM
             , MAX(BUSS_LICENCE_FILE_NM) AS BUSS_LICENCE_FILE_NM,MAX(ETC_FILE_NM) AS ETC_FILE_NM
             , MAX(ADD_FILE_NM) AS ADD_FILE_NM
             , NVL(MAX(CONTRACT_FILE_NO),0) AS CONTRACT_FILE_NO
             , NVL(MAX(BUSS_LICENCE_FILE_NO),0) AS BUSS_LICENCE_FILE_NO
             , NVL(MAX(ETC_FILE_NO),0) AS ETC_FILE_NO
             , NVL(MAX(ADD_FILE_NO),0) AS ADD_FILE_NO
        FROM (
                SELECT A.DLR_CD
                     , A.USR_ID
                     , A.REQ_SEQ
                     , A.CUST_NM
                     , A.PRSN_ID
                     , A.ZIP_CD
                     , A.ADDR
                     , A.HP_NO
                     , A.FAX_NO
                     , A.ATC_DSTIN_CD
                     , A.ATC_CONT
                     , A.CAR_USE_TP
                     , A.PRSN_DLR_CD
                     , A.PRSN_DLR_TEL_NO
                     , A.LONG_DCSS_YN
                     , TO_DATE(A.CAR_ALLOC_HOPE_DT, 'YYYYMMDD') AS CAR_ALLOC_HOPE_DT
                     , A.FILE_DOC_ID
                     , RETL_AMT
                     , RCPT_AMT
                     , DC_AMT
                     , A.TEL_NO
                     , APPROVE_CD
                     , CASE WHEN A.CONTRACT_DOC_SEQ = D.FILE_NO THEN FILE_NM END AS CONTRACT_FILE_NM
                     , CASE WHEN A.CRN_DOC_SEQ = D.FILE_NO THEN FILE_NM END AS BUSS_LICENCE_FILE_NM
                     , CASE WHEN A.ETC_DOC_SEQ = D.FILE_NO THEN FILE_NM END AS ETC_FILE_NM
                     , CASE WHEN A.ADD_FILE_SEQ = D.FILE_NO THEN FILE_NM END AS ADD_FILE_NM
                     , CASE WHEN A.CONTRACT_DOC_SEQ = D.FILE_NO THEN FILE_NO END AS CONTRACT_FILE_NO
                     , CASE WHEN A.CRN_DOC_SEQ = D.FILE_NO THEN FILE_NO END AS BUSS_LICENCE_FILE_NO
                     , CASE WHEN A.ETC_DOC_SEQ = D.FILE_NO THEN FILE_NO END AS ETC_FILE_NO
                     , CASE WHEN A.ADD_FILE_SEQ = D.FILE_NO THEN FILE_NO END AS ADD_FILE_NO
                  FROM SA_0414T A,
                       (SELECT B.FILE_DOC_NO,C.FILE_NO,C.FILE_TP,C.FILE_NM,C.FILE_SIZE,C.FILE_DATA
                          FROM CM_0901T B, CM_0902T C
                         WHERE 1=1
                           AND B.FILE_DOC_NO = C.FILE_DOC_NO
                       ) D
                 WHERE A.FILE_DOC_ID = D.FILE_DOC_NO(+)
                   AND A.DLR_CD = #{dlrCd}
                   AND A.USR_ID = #{usrId}
                   AND A.REQ_SEQ = #{reqSeq}
             )
       GROUP BY DLR_CD,USR_ID,REQ_SEQ,CUST_NM,PRSN_ID,ZIP_CD,ADDR,HP_NO,FAX_NO,ATC_DSTIN_CD,ATC_CONT
               ,CAR_USE_TP,PRSN_DLR_CD,PRSN_DLR_TEL_NO,LONG_DCSS_YN,CAR_ALLOC_HOPE_DT
               ,FILE_DOC_ID,RETL_AMT,RCPT_AMT,DC_AMT,APPROVE_CD,TEL_NO
    </select>




    <!-- 법인 - 집단판매 신청 차량정보 저장. : 집단판매신청정보수신1 프로시져  -->
    <insert id="procFleetSaleFigureReq1" parameterType="GroupSalesApplicationVO" statementType="CALLABLE">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.procFleetSaleFigureReq1] */
        {CALL SP_SAL_DMS_P_0414T_IF(
              'SAL087'
            , #{dlrCd, mode=IN, jdbcType=VARCHAR}
            , #{usrId, mode=IN, jdbcType=VARCHAR}
            , #{reqSeq, mode=IN, jdbcType=VARCHAR}
        )}
    </insert>




    <!-- 법인 - 집단판매 신청 차량 상세정보 저장. : 집단판매신청정보수신2 프로시져  -->
    <insert id="procFleetSaleFigureReq2" parameterType="GroupSalesApplicationVehVO" statementType="CALLABLE">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.procFleetSaleFigureReq2] */
        {CALL SP_SAL_DMS_P_0413T_IF(
              'SAL088'
            , #{dlrCd, mode=IN, jdbcType=VARCHAR}
            , #{usrId, mode=IN, jdbcType=VARCHAR}
            , #{reqSeq, mode=IN, jdbcType=VARCHAR}
            , #{reqLowerSeq, mode=IN, jdbcType=VARCHAR}
            , #{reqNo, mode=IN, jdbcType=VARCHAR}
        )}
    </insert>



    <!-- 법인 - 집단판매 신청 차량 상세정보 저장. : 집단판매신청정보수신3 프로시져  -->
    <insert id="procFleetSaleFigureReq3" parameterType="GroupSalesApplicationVehVO" statementType="CALLABLE">
    /* [chn.bhmc.dms.sal.svo.service.dao.GroupSalesApplicationDAO.procFleetSaleFigureReq3] */
        {CALL SP_SAL_DMS_P_0415T_IF(
              'SAL089'
            , #{dlrCd, mode=IN, jdbcType=VARCHAR}
            , #{usrId, mode=IN, jdbcType=VARCHAR}
            , #{reqSeq, mode=IN, jdbcType=VARCHAR}
            , #{reqLowerSeq, mode=IN, jdbcType=VARCHAR}
        )}
    </insert>



</mapper>