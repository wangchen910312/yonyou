<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    SQL File Name : ClaimOldItemManageDAO_SqlMap.xml
    Description : 고품관리 마스터에 관한 데이터처리
    author Yin Xueyuan
    since 2016. 5. 6.
    version 1.0
    Modification Information
       since          author              description
    ===========    =============    ===========================
    2016. 5. 6.  Yin Xueyuan      최초 생성
-->

<mapper namespace="chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO">

	<!-- 고품요청관리  등록 (사용) -->
    <insert id="insertClaimOldItemManage" parameterType="ClaimOldItemManageVO">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.insertClaimOldItemManage] */
        INSERT INTO SE_0790T    --고품관리
        (
             DLR_CD                 --딜러코드
            ,VIN_NO                 --차대번호
            ,CLAIM_DOC_NO           --클레임문서번호
            ,STAT_CD                --상태코드
            ,ATQ_REQ_NO             --고품신청번호
            ,SEQ                    --일련번호
            ,RUN_DIST_VAL           --주행거리값
            ,RETURN_DT              --반납일자
            ,ITEM_CD                --품목코드
            ,ITEM_NM                --품목명
            ,ITEM_UNIT_CD           --품목단위코드
            ,CLAIM_QTY              --클레임수량
            ,REQ_TEL_NO             --요청자전화번호
            ,REQ_STAT_CD            --요청상태코드
            ,REQ_REASON_CONT        --요청사유내용
            ,COLLC_REQ_DT           --회수요청일자
            ,REQ_ID                 --요청자ID
            ,REQ_DT                 --요청일자
            ,REQ_DEPT_CD            --요청부서코드
            ,COLLC_ID               --회수자ID
            ,COLLC_DT               --회수일자
            ,REG_USR_ID             --등록자ID
            ,REG_DT                 --등록일자
            ,RCIP_ID                --수취인ID
            ,RCIP_ADDR_NM           --수취인주소명
            ,RCIP_TEL_NO            --수취인전화번호
            ,EXPS_CMP_NM            --택배회사명
            ,PAY_TP                 --지불유형
            ,TRSF_NO                --운송장번호
            ,WARNING_INFO           --주의사항
            ,OLDITEM_CMP_NM         --고품회수회사
            ,EXPS_AMT               --보가금액
            ,OLDITEM_STAT_CD        --부품상태
        )
        VALUES
        (
             #{dlrCd}                 --딜러코드
            ,#{vinNo}                 --차대번호
            ,#{claimDocNo}            --클레임문서번호
            ,#{statCd}                --상태코드
            ,#{atqReqNo}              --고품신청번호
            ,#{seq}                   --일련번호
            ,#{runDistVal}            --주행거리값
            ,#{returnDt}              --반납일자
            ,#{itemCd}                --품목코드
            ,#{itemNm}                --품목명
            ,#{itemUnitCd}            --품목단위코드
            ,#{claimQty}              --클레임수량
            ,#{reqTelNo}              --요청자전화번호
            ,#{statCd}                --요청상태코드
            ,#{reqReasonCont}         --요청사유내용
            ,#{collcReqDt}            --회수요청일자
            ,#{reqId}                 --요청자ID
            ,SYSDATE                  --요청일자
            ,#{reqDeptCd}             --요청부서코드
            ,#{collcId}               --회수자ID
            ,#{collcDt}               --회수일자
            ,#{regUsrId}              --등록자ID
            ,SYSDATE                  --등록일자
            ,#{rcipId}                --수취인ID
            ,#{rcipAddrNm}            --수취인주소명
            ,#{rcipTelNo}             --수취인전화번호
            ,#{expsCmpNm}             --택배회사명
            ,#{payTp}                 --지불유형
            ,#{trsfNo}                --운송장번호
            ,#{warningInfo}           --주의사항
            ,#{olditemCmpNm}          --고품회수회사
            ,#{expsAmt}               --보가금액
            ,'02'                     --부품상태
        )
    </insert>

    <!-- 고품요청관리  엑셀 업로드 TEMP 삭제  -->
    <delete id="deleteClaimOldItemExcelTemp" parameterType="string">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.deleteClaimOldItemExcelTemp] */
        TRUNCATE TABLE SE_0790T_TMP

    </delete>

	<!-- 고품요청관리  엑셀 업로드  -->
    <insert id="insertClaimOldItemExcelTemp" parameterType="ClaimOldItemManageVO">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.insertClaimOldItemExcelTemp] */

          INSERT INTO SE_0790T_TMP    --고품관리 excep temp
            (
                 DLR_CD                 --딜러코드
                ,VIN_NO                 --차대번호
                ,CLAIM_DOC_NO           --클레임문서번호
                ,SEQ
                ,STAT_CD                --상태코드
                ,RUN_DIST_VAL           --주행거리값
                ,ITEM_CD                --품목코드
                ,ITEM_NM                --품목명
                ,ITEM_UNIT_CD           --품목단위코드
                ,CLAIM_QTY              --클레임수량
                ,COLLC_QTY              --회수수량
                ,REQ_TEL_NO             --요청자전화번호
                ,REQ_STAT_CD            --요청상태코드
                ,REQ_REASON_CONT        --요청사유내용
                ,COLLC_REQ_DT           --회수요청일자
                ,REQ_ID                 --요청자ID
                ,REQ_DT                 --요청일자
                ,REQ_DEPT_CD            --요청부서코드
                ,COLLC_ID               --회수자ID
                ,COLLC_DT               --회수일자
                ,REG_USR_ID             --등록자ID
                ,REG_DT                 --등록일자
                ,RCIP_ID                --수취인ID
                ,RCIP_ADDR_NM           --수취인주소명
                ,RCIP_TEL_NO            --수취인전화번호
                ,EXPS_CMP_NM            --택배회사명
                ,PAY_TP                 --지불유형
                ,TRSF_NO                --운송장번호
                ,WARNING_INFO           --주의사항
                ,OLDITEM_CMP_NM         --고품회수회사
                ,EXPS_AMT               --보가금액
                ,ACCEPT_YN              --접수여부
                ,OLDITEM_STAT_CD        --부품상태
            )
            VALUES
            (
                 #{dlrCd}                 --딜러코드
                ,#{vinNo}                 --차대번호
                ,#{claimDocNo}            --클레임문서번호
                ,(
                  SELECT NVL(MAX(SEQ),0) + 1
                    FROM SE_0790T_TMP
                   WHERE DLR_CD       = #{dlrCd}
                     AND VIN_NO       = #{vinNo}
                     AND CLAIM_DOC_NO = #{claimDocNo}
                     AND ITEM_CD      = #{itemCd}
                )
                ,#{statCd}                --상태코드
                ,#{runDistVal}            --주행거리값
                ,#{itemCd}                --품목코드
                ,#{itemNm}                --품목명
                ,#{itemUnitCd}            --품목단위코드
                ,#{claimQty}              --클레임수량
                ,#{collcQty}              --회수수량
                ,#{reqTelNo}              --요청자전화번호
                ,#{statCd}                --요청상태코드
                ,#{reqReasonCont}         --요청사유내용
                ,#{collcReqDt}            --회수요청일자
                ,#{reqId}                 --요청자ID
                ,SYSDATE                  --요청일자
                ,#{reqDeptCd}             --요청부서코드
                ,#{collcId}               --회수자ID
                ,#{collcDt}               --회수일자
                ,#{regUsrId}              --등록자ID
                ,SYSDATE                  --등록일자
                ,#{rcipId}                --수취인ID
                ,#{rcipAddrNm}            --수취인주소명
                ,#{rcipTelNo}             --수취인전화번호
                ,#{expsCmpNm}             --택배회사명
                ,#{payTp}                 --지불유형
                ,#{trsfNo}                --운송장번호
                ,#{warningInfo}           --주의사항
                ,#{olditemCmpNm}          --고품회수회사
                ,#{expsAmt}               --보가금액
                ,'N'                      --접수여부
                ,'02'                     --부품상태
            )
    </insert>



	<!-- 고품요청관리  엑셀 업로드  -->
    <insert id="insertExcelData" parameterType="string">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.insertExcelData] */

      INSERT INTO SE_0790T (
         DLR_CD                 --딜러코드
        ,VIN_NO                 --차대번호
        ,CLAIM_DOC_NO           --클레임문서번호
        ,STAT_CD                --상태코드
        ,ATQ_REQ_NO             --고품신청번호
        ,SEQ                    --일련번호
        ,RUN_DIST_VAL           --주행거리값
        ,ITEM_CD                --품목코드
        ,ITEM_NM                --품목명
        ,ITEM_UNIT_CD           --품목단위코드
        ,CLAIM_QTY              --클레임수량
        ,REQ_TEL_NO             --요청자전화번호
        ,REQ_STAT_CD            --요청상태코드
        ,REQ_REASON_CONT        --요청사유내용
        ,REQ_ID                 --요청자ID
        ,REQ_DT                 --요청일자
        ,REQ_DEPT_CD            --요청부서코드
        ,REG_USR_ID             --등록자ID
        ,REG_DT                 --등록일자
        ,RCIP_ID                --수취인ID
        ,RCIP_ADDR_NM           --수취인주소명
        ,RCIP_TEL_NO            --수취인전화번호
        ,EXPS_CMP_NM            --택배회사명
        ,PAY_TP                 --지불유형
        ,TRSF_NO                --운송장번호
        ,WARNING_INFO           --주의사항
        ,OLDITEM_CMP_NM         --고품회수회사
        ,EXPS_AMT               --보가금액
        ,COLLC_REQ_DT           --회수요청일자
        ,ACCEPT_YN               --접수여부
      )
      SELECT DLR_CD                 --딜러코드
            ,VIN_NO                 --차대번호
            ,CLAIM_DOC_NO           --클레임문서번호
            ,NVL(STAT_CD,'02')      --상태코드
            ,#{atqReqNo}            --고품신청번호
            ,SEQ                    --일련번호
            ,RUN_DIST_VAL           --주행거리값
            ,ITEM_CD                --품목코드
            ,ITEM_NM                --품목명
            ,NVL(ITEM_UNIT_CD,'EA') ITEM_UNIT_CD --품목단위코드
            ,CLAIM_QTY              --클레임수량
            ,REQ_TEL_NO             --요청자전화번호
            ,REQ_STAT_CD            --요청상태코드
            ,REQ_REASON_CONT        --요청사유내용
            ,REQ_ID                 --요청자ID
            ,SYSDATE                --요청일자
            ,REQ_DEPT_CD            --요청부서코드
            ,REG_USR_ID             --등록자ID
            ,SYSDATE                --등록일자
            ,RCIP_ID                --수취인ID
            ,RCIP_ADDR_NM           --수취인주소명
            ,RCIP_TEL_NO            --수취인전화번호
            ,EXPS_CMP_NM            --택배회사명
            ,NVL(PAY_TP,'02') AS PAY_TP --지불유형
            ,TRSF_NO                --운송장번호
            ,WARNING_INFO           --주의사항
            ,OLDITEM_CMP_NM         --고품회수회사
            ,EXPS_AMT               --보가금액
            ,SYSDATE AS COLLC_REQ_DT --회수요청일자
            ,NVL(ACCEPT_YN,'N') AS ACCEPT_YN
      FROM SE_0790T_TMP A
     WHERE NOT EXISTS(
        SELECT *
          FROM SE_0790T
         WHERE DLR_CD       = A.DLR_CD
           AND VIN_NO       = A.VIN_NO
           AND CLAIM_DOC_NO = A.CLAIM_DOC_NO
           AND ITEM_CD      = A.ITEM_CD
         )
    </insert>



	<!-- 고품요청관리  엑셀 업로드 TEMP   -->
    <insert id="insertClaimOldItemExcelTempErr" parameterType="ClaimOldItemManageVO">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.insertClaimOldItemExcelTempErr] */

          INSERT INTO SE_0790T_ERR    --고품관리
            (
                 DLR_CD                 --딜러코드
                ,VIN_NO                 --차대번호
                ,CLAIM_DOC_NO           --클레임문서번호
                ,STAT_CD                --상태코드
                ,RUN_DIST_VAL           --주행거리값
                ,ITEM_CD                --품목코드
                ,ITEM_NM                --품목명
                ,ITEM_UNIT_CD           --품목단위코드
                ,CLAIM_QTY              --클레임수량
                ,REQ_TEL_NO             --요청자전화번호
                ,REQ_STAT_CD            --요청상태코드
                ,REQ_REASON_CONT        --요청사유내용
                ,COLLC_REQ_DT           --회수요청일자
                ,REQ_ID                 --요청자ID
                ,REQ_DT                 --요청일자
                ,REQ_DEPT_CD            --요청부서코드
                ,COLLC_ID               --회수자ID
                ,COLLC_DT               --회수일자
                ,REG_USR_ID             --등록자ID
                ,REG_DT                 --등록일자
                ,RCIP_ID                --수취인ID
                ,RCIP_ADDR_NM           --수취인주소명
                ,RCIP_TEL_NO            --수취인전화번호
                ,EXPS_CMP_NM            --택배회사명
                ,PAY_TP                 --지불유형
                ,TRSF_NO                --운송장번호
                ,WARNING_INFO           --주의사항
                ,OLDITEM_CMP_NM         --고품회수회사
                ,EXPS_AMT               --보가금액
                ,ACCEPT_YN              --접수여부
            )
            VALUES
            (
                 #{dlrCd}                 --딜러코드
                ,#{vinNo}                 --차대번호
                ,#{claimDocNo}            --클레임문서번호
                ,#{statCd}                --상태코드
                ,#{runDistVal}            --주행거리값
                ,#{itemCd}                --품목코드
                ,#{itemNm}                --품목명
                ,#{itemUnitCd}            --품목단위코드
                ,#{claimQty}              --클레임수량
                ,#{reqTelNo}              --요청자전화번호
                ,#{statCd}                --요청상태코드
                ,#{reqReasonCont}         --요청사유내용
                ,#{collcReqDt}            --회수요청일자
                ,#{reqId}                 --요청자ID
                ,SYSDATE                  --요청일자
                ,#{reqDeptCd}             --요청부서코드
                ,#{collcId}               --회수자ID
                ,#{collcDt}               --회수일자
                ,#{regUsrId}              --등록자ID
                ,SYSDATE                  --등록일자
                ,#{rcipId}                --수취인ID
                ,#{rcipAddrNm}            --수취인주소명
                ,#{rcipTelNo}             --수취인전화번호
                ,#{expsCmpNm}             --택배회사명
                ,#{payTp}                 --지불유형
                ,#{trsfNo}                --운송장번호
                ,#{warningInfo}           --주의사항
                ,#{olditemCmpNm}          --고품회수회사
                ,#{expsAmt}               --보가금액
                'N'                       --접수여부
            )
    </insert>

    <!-- 고품공제 관리  -->
    <insert id="insertClaimOldItemDdcutManage" parameterType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.insertClaimOldItemDdcutManage] */

        INSERT INTO SE_0790T        --고품관리
        (
             DLR_CD                 --딜러코드
            ,VIN_NO                 --차대번호
            ,CLAIM_DOC_NO           --클레임문서번호
            ,STAT_CD                --상태코드
            ,ATQ_REQ_NO             --고품신청번호
            ,SEQ                    --일련번호
            ,RUN_DIST_VAL           --주행거리값
            ,RETURN_DT              --반납일자
            ,ITEM_CD                --품목코드
            ,ITEM_NM                --품목명
            ,ITEM_UNIT_CD           --품목단위코드
            ,COLLC_QTY              --회수수량
            ,CLAIM_QTY              --클레임수량
            ,REQ_TEL_NO             --요청자전화번호
            ,REQ_STAT_CD            --요청상태코드
            ,REQ_REASON_CONT        --요청사유내용
            ,COLLC_REQ_DT           --회수요청일자
            ,REQ_ID                 --요청자ID
            ,REQ_DT                 --요청일자
            ,REQ_DEPT_CD            --요청부서코드
            ,COLLC_ID               --회수자ID
            ,COLLC_DT               --회수일자
            ,DDCT_ID                --공제자ID
            ,DDCT_DT                --공제일자
            ,GI_DSTIN_CD            --출고구분코드
            ,GI_REASON_CONT         --출고사유내용
            ,GI_DT                  --출고일자
            ,GI_DEPT_CD             --출고부서코드
            ,GI_ID                  --출고자ID
            ,REG_USR_ID             --등록자ID
            ,REG_DT                 --등록일자
            ,DDCT_QTY               --공제수량
            ,RCIP_ID                --수취인ID
            ,RCIP_ADDR_NM           --수취인주소명
            ,RCIP_TEL_NO            --수취인전화번호
            ,EXPS_CMP_NM            --택배회사명
            ,PAY_TP                 --지불유형
            ,SENDER_ID              --부취인ID
            ,SENDER_TEL_NO          --부취인전화번호
            ,TRSF_NO                --운송장번호
        )
        VALUES
        (
             #{dlrCd}                 --딜러코드
            ,#{vinNo}                 --차대번호
            ,#{claimDocNo}            --클레임문서번호
            ,#{statCd}                --상태코드
            ,#{atqReqNo}              --고품신청번호
            ,#{seq}                   --일련번호
            ,#{runDistVal}            --주행거리값
            ,#{returnDt}              --반납일자
            ,#{itemCd}                --품목코드
            ,#{itemNm}                --품목명
            ,#{itemUnitCd}            --품목단위코드
            ,#{collcQty}              --회수수량
            ,#{claimQty}              --클레임수량
            ,#{reqTelNo}              --요청자전화번호
            ,#{reqStatCd}             --요청상태코드
            ,#{reqReasonCont}         --요청사유내용
            ,#{collcReqDt}            --회수요청일자
            ,#{reqId}                 --요청자ID
            ,SYSDATE                  --요청일자
            ,#{reqDeptCd}             --요청부서코드
            ,#{collcId}               --회수자ID
            ,#{collcDt}               --회수일자
            ,#{ddctId}                --공제자ID
            ,#{ddctDt}                --공제일자
            ,#{giDstinCd}             --출고구분코드
            ,#{giReasonCont}          --출고사유내용
            ,#{giDt}                  --출고일자
            ,#{giDeptCd}              --출고부서코드
            ,#{giId}                  --출고자ID
            ,#{regUsrId}              --등록자ID
            ,SYSDATE                  --등록일자
            ,#{ddctQty}               --공제수량
            ,#{rcipId}                --수취인ID
            ,#{rcipAddrNm}            --수취인주소명
            ,#{rcipTelNo}             --수취인전화번호
            ,#{expsCmpNm}             --택배회사명
            ,#{payTp}                 --지불유형
            ,#{senderId}              --부취인ID
            ,#{senderTelNo}           --부취인전화번호
            ,#{trsfNo}                --운송장번호
        )
    </insert>

    <!-- 고품회수관리  수정 (사용) -->
    <update id="updateReceiveOldItemManage" parameterType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.updateReceiveOldItemManage] */

        UPDATE SE_0790T    --고품관리
           SET
               STAT_CD         = #{statCd}                --상태코드
              ,COLLC_QTY       = #{collcQty}              --회수수량
              ,COLLC_ID        = #{collcId}               --회수자ID
              ,COLLC_DT        = #{collcDt}               --회수일자
              ,CONTROLL_USR_ID = #{updtUsrId}             --수정자ID
              ,UPDT_USR_ID     = #{updtUsrId}             --수정자ID
              ,UPDT_DT         = SYSDATE                  --수정일자
              ,ACCEPT_YN       ='Y'
         WHERE 1 = 1
           AND VIN_NO          = #{vinNo}                 --차대번호
           AND CLAIM_DOC_NO    = #{claimDocNo}            --클레임문서번호
           AND SEQ             = #{seq}                   --일련번호
           AND ITEM_CD         = #{itemCd}                --품목코드
           AND DLR_CD          = #{dlrCd}                 --딜러코드
    </update>

	<!-- 고품공제관리 수정 -->
	<update id="updateDeductOldItemManage" parameterType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.updateDeductOldItemManage] */

        UPDATE SE_0790T    --고품관리
           SET
               STAT_CD         = #{statCd}                --상태코드
              ,DDCT_ID         = #{ddctId}                --공제자ID
              ,DDCT_DT         = #{ddctDt}                --공제일자
              ,UPDT_USR_ID     = #{updtUsrId}             --수정자ID
              ,UPDT_DT         = SYSDATE                  --수정일자
              ,DDCT_YN         = 'Y'
         WHERE 1 = 1
           AND VIN_NO          = #{vinNo}                 --차대번호
           AND CLAIM_DOC_NO    = #{claimDocNo}            --클레임문서번호
           AND SEQ             = #{seq}                   --일련번호
           AND ITEM_CD         = #{itemCd}                --품목코드
           AND DLR_CD          = #{dlrCd}                 --딜러코드
	</update>

	<!-- 고품출고관리 수정 -->
	<update id="updateClaimOldItemOutManage" parameterType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.updateClaimOldItemOutManage] */

        UPDATE SE_0790T    --고품관리
           SET
               STAT_CD         = #{statCd}                --상태코드
              ,GI_DSTIN_CD     = #{giDstinCd}             --출고구분코드
              ,GI_REASON_CONT  = #{giReasonCont}          --출고사유내용
              ,GI_DT           = #{giDt}                  --출고일자
              ,GI_DEPT_CD      = #{giDeptCd}              --출고부서코드
              ,GI_ID           = #{giId}                  --출고자ID
              ,UPDT_USR_ID     = #{updtUsrId}             --수정자ID
              ,UPDT_DT         = SYSDATE                  --수정일자
         WHERE 1 = 1
           AND VIN_NO          = #{vinNo}                 --차대번호
           AND CLAIM_DOC_NO    = #{claimDocNo}            --클레임문서번호
           AND SEQ             = #{seq}                   --일련번호
           AND ITEM_CD         = #{itemCd}                --품목코드
           AND DLR_CD          = #{dlrCd}                 --딜러코드
	</update>


    <!-- 고품요청관리  엑셀  업로드   ERROR TEMP 삭제 -->
    <delete id="deleteClaimOldItemExcelTempErr" parameterType="string">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.deleteClaimOldItemExcelTempErr] */
        TRUNCATE TABLE SE_0790T_ERR
    </delete>


    <!-- 고품관리 삭제 -->
    <delete id="deleteClaimOldItemManage" parameterType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.deleteClaimOldItemManage] */

        DELETE FROM SE_0790T
         WHERE 1 = 1
           AND VIN_NO          = #{vinNo}                 --차대번호
           AND CLAIM_DOC_NO    = #{claimDocNo}            --클레임문서번호
           AND SEQ             = #{seq}                   --일련번호
           AND ITEM_CD         = #{itemCd}                --품목코드
           AND DLR_CD          = #{dlrCd}                 --딜러코드
    </delete>

    <!-- 고품관리인터페이스 테이블 삭제 -->
    <delete id="deleteClaimOldItemManageIf" parameterType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.deleteClaimOldItemManageIf] */
        DELETE FROM SE_0790I
         WHERE 1 = 1
           AND VIN_NO          = #{vinNo}                 --차대번호
           AND CLAIM_DOC_NO    = #{claimDocNo}            --클레임문서번호
           AND SEQ             = #{seq}                   --일련번호
           AND ITEM_CD         = #{itemCd}                --품목코드
           AND DLR_CD          = #{dlrCd}                 --딜러코드
    </delete>

    <!-- 고품출고 관리 목록수  사용-->
    <select id="selectOldItemOutManageByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectOldItemOutManageByConditionCnt] */

          SELECT COUNT(*) AS VALUE
            FROM SE_0790T T1
           WHERE T1.STAT_CD IN ('04','05','06','07')
            <if test='sDlrCd != null and sDlrCd != ""'>
             AND DLR_CD = #{sDlrCd}
            </if>
            <if test='sStatCd != null and sStatCd != ""'>
             AND STAT_CD = #{sStatCd}
            </if>
            <if test='sGiDeptCd != null and sGiDeptCd != ""'>
             AND GI_DEPT_CD = #{sGiDeptCd}
            </if>
            <if test=' sReqDeptCd != null and sReqDeptCd != "" '>
             AND REQ_DEPT_CD = #{sReqDeptCd}
            </if>
            <if test='sItemCd != null and sItemCd != ""'>
             AND ITEM_CD LIKE '%'||#{sItemCd}||'%'
            </if>
            <if test='sItemNm != null and sItemNm != ""'>
             AND ITEM_NM LIKE '%'||#{sItemNm}||'%'
            </if>
            <if test='sClaimDocNo != null and sClaimDocNo != ""'>
             AND CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
            </if>
            <if test='sAcceptYn != null and sAcceptYn != ""'>
             AND ACCEPT_YN  = #{sAcceptYn}
            </if>
            <choose>
                <when test=' sField !=null and sField == "02" '>
                    <if test='sReqFromDt != null '>
                      AND REG_DT  <![CDATA[>=]]>  #{sReqFromDt}
                    </if>
                    <if test='sReqToDt !=null '>
                      AND REG_DT  <![CDATA[<]]>  #{sReqToDt}+1
                    </if>
                </when>
                <when test=' sField !=null and sField == "04" '>
                    <if test='sReqFromDt != null '>
                      AND GI_DT  <![CDATA[>=]]>  #{sReqFromDt}
                    </if>
                    <if test='sReqToDt !=null '>
                      AND GI_DT  <![CDATA[<]]>  #{sReqToDt}+1
                    </if>
                </when>
            </choose>
    </select>

    <!-- 고품출고 관리 리스트 -사용-->
    <select id="selectOldItemOutManageByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectOldItemOutManageByCondition] */

        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT
                      A.DLR_CD                 --딜러코드
                     ,(SELECT DLR_SHT_NM FROM CM_0101T WHERE DLR_CD = A.DLR_CD) AS DLR_NM
                     ,A.VIN_NO                 --차대번호
                     ,A.CLAIM_DOC_NO           --클레임문서번호
                     ,NVL(STAT_CD,'01') STAT_CD   --상태코드
                     ,(SELECT CLAIM_START_DT
                         FROM SE_0710T C
                        WHERE C.DLR_CD       = A.DLR_CD
                          AND C.CLAIM_DOC_NO = A.CLAIM_DOC_NO
                          AND C.CLAIM_STAT_CD ='A'
                          AND ROWNUM = 1 ) AS CLAIM_START_DT --클레임 일자
                     ,A.ATQ_REQ_NO             --고품신청번호
                     ,A.SEQ                    --일련번호
                     ,NVL(A.RUN_DIST_VAL,0)AS RUN_DIST_VAL --주행거리값
                     ,A.RETURN_DT              --반납일자
                     ,A.ITEM_CD                --품목코드
                     ,A.ITEM_NM                --품목명
                     ,NVL(A.ITEM_UNIT_CD,'EA')AS ITEM_UNIT_CD --품목단위코드
                     ,NVL(A.COLLC_QTY,0) AS COLLC_QTY --회수수량
                     ,NVL(A.CLAIM_QTY,0) AS CLAIM_QTY --클레임수량
                     ,A.REQ_TEL_NO             --요청자전화번호
                     ,A.REQ_STAT_CD            --요청상태코드
                     ,A.REQ_REASON_CONT        --요청사유내용
                     ,A.COLLC_REQ_DT           --회수요청일자
                     ,A.REQ_ID                 --요청자ID
                     ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = A.REQ_ID) AS REQ_NM
                     ,A.REQ_DT                 --요청일자
                     ,A.REQ_DEPT_CD            --요청부서코드
                     ,A.COLLC_ID               --회수자ID
                     ,A.COLLC_DT               --회수일자
                     ,A.DDCT_ID                --공제자ID
                     ,A.DDCT_DT                --공제일자
                     ,A.GI_DSTIN_CD            --출고구분코드
                     ,A.GI_REASON_CONT         --출고사유내용
                     ,A.GI_DT                  --출고일자
                     ,A.GI_DEPT_CD             --출고부서코드
                     ,A.GI_ID                  --출고자ID
                     ,A.REG_USR_ID             --등록자ID
                     ,A.REG_DT                 --등록일자
                     ,A.UPDT_USR_ID            --수정자ID
                     ,A.UPDT_DT                --수정일자
                     ,A.DDCT_QTY               --공제수량
                     ,A.RCIP_ID                --수취인ID
                     ,A.RCIP_ADDR_NM           --수취인주소명
                     ,A.RCIP_TEL_NO            --수취인전화번호
                     ,A.EXPS_CMP_NM            --택배회사명
                     ,A.PAY_TP                 --지불유형
                     ,A.SENDER_ID              --부취인ID
                     ,A.SENDER_TEL_NO          --부취인전화번호
                     ,A.TRSF_NO                --운송장번호
                     ,A.NOT_SEND_CAUSE_CONT
                     ,A.NOT_SEND_DT
                     ,A.CONTROLL_DT
                     ,A.OLDITEM_STAT_CD
                     ,A.CONTROLL_USR_ID
                     ,A.ACCEPT_YN
                     ,A.DDCT_YN
                     ,A.WARNING_INFO
                     ,A.OLDITEM_CMP_NM
                     ,A.EXPS_AMT
                FROM SE_0790T A
               WHERE STAT_CD IN ('04','05','06','07')
                <if test='sDlrCd != null and sDlrCd != ""'>
                AND DLR_CD = #{sDlrCd}
                </if>
                <if test='sStatCd != null and sStatCd != ""'>
                AND STAT_CD = #{sStatCd}
                </if>
                <if test='sItemCd != null and sItemCd != ""'>
                AND ITEM_CD LIKE '%'||#{sItemCd}||'%'
                </if>
                <if test='sItemNm != null and sItemNm != ""'>
                AND ITEM_NM LIKE '%'||#{sItemNm}||'%'
                </if>
                <if test='sGiDeptCd != null and sGiDeptCd != ""'>
                 AND GI_DEPT_CD = #{sGiDeptCd}
                </if>
                <if test=' sReqDeptCd != null and sReqDeptCd != "" '>
                 AND REQ_DEPT_CD = #{sReqDeptCd}
                </if>
                <if test='sClaimDocNo != null and sClaimDocNo != ""'>
                AND CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
                </if>
                <if test='sAtqReqNo != null and sAtqReqNo != ""'>
                AND ATQ_REQ_NO LIKE '%'||#{sAtqReqNo}||'%'
                </if>
                <if test='sAcceptYn != null and sAcceptYn != ""'>
                 AND ACCEPT_YN  = #{sAcceptYn}
                </if>
                <choose>
                    <when test=' sField !=null and sField == "02" '>
                        <if test='sReqFromDt != null '>
                          AND REG_DT  <![CDATA[>=]]>  #{sReqFromDt}
                        </if>
                        <if test='sReqToDt !=null '>
                          AND REG_DT  <![CDATA[<]]>  #{sReqToDt}+1
                        </if>
                    </when>
                    <when test=' sField !=null and sField == "04" '>
                        <if test='sReqFromDt != null '>
                          AND GI_DT  <![CDATA[>=]]>  #{sReqFromDt}
                        </if>
                        <if test='sReqToDt !=null '>
                          AND GI_DT  <![CDATA[<]]>  #{sReqToDt}+1
                        </if>
                    </when>
                </choose>
                ORDER BY
                <choose>
                    <when test='sort != null'>
                        <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                            <choose>
                                 <when test='item.field == "dlrCd"'>          DLR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "vinNo"'>          VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "claimDocNo"'>     CLAIM_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "statCd"'>         STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "atqReqNo"'>       ATQ_REQ_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "seq"'>            SEQ <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                                 <when test='item.field == "runDistVal"'>     RUN_DIST_VAL <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "returnDt"'>       RETURN_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "itemCd"'>         ITEM_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "itemNm"'>         ITEM_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "itemUnitCd"'>     ITEM_UNIT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "collcQty"'>       COLLC_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "claimQty"'>       CLAIM_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "reqTelNo"'>       REQ_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "reqStatCd"'>      REQ_STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "reqReasonCont"'>  REQ_REASON_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                 <when test='item.field == "collcReqDt"'>     COLLC_REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "reqId"'>          REQ_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "reqDt"'>          REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "reqDeptCd"'>      REQ_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "collcId"'>        COLLC_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                                 <when test='item.field == "collcDt"'>        COLLC_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                                 <when test='item.field == "ddctId"'>         DDCT_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "ddctDt"'>         DDCT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "giDstinCd"'>      GI_DSTIN_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "giReasonCont"'>   GI_REASON_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose> </when>
                                 <when test='item.field == "giDt"'>           GI_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "giDeptCd"'>       GI_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "giId"'>           GI_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                <otherwise>
                                    DLR_CD,CLAIM_DOC_NO,ATQ_REQ_NO,ITEM_CD ASC
                                </otherwise>
                            </choose>
                        </foreach>
                    </when>
                    <otherwise>
                        DLR_CD,CLAIM_DOC_NO,ATQ_REQ_NO,ITEM_CD ASC
                    </otherwise>
                </choose>
            ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- 고품공제  관리 목록수  사용-->
    <select id="selectDeductOldItemManageByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectDeductOldItemManageByConditionCnt] */

          SELECT COUNT(*) AS VALUE
            FROM SE_0790T T1
           WHERE T1.STAT_CD IN('04','05')
            <if test='sDlrCd != null and sDlrCd != ""'>
             AND DLR_CD = #{sDlrCd}
            </if>
            <if test='sStatCd != null and sStatCd != ""'>
             AND STAT_CD = #{sStatCd}
            </if>
            <if test='sItemCd != null and sItemCd != ""'>
             AND ITEM_CD LIKE '%'||#{sItemCd}||'%'
            </if>
            <if test='sItemNm != null and sItemNm != ""'>
             AND ITEM_NM LIKE '%'||#{sItemNm}||'%'
            </if>
            <if test='sClaimDocNo != null and sClaimDocNo != ""'>
             AND CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
            </if>
            <if test=' sReqDeptCd != null and sReqDeptCd != "" '>
             AND REQ_DEPT_CD = #{sReqDeptCd}
            </if>
            <if test='sAcceptYn != null and sAcceptYn != ""'>
             AND ACCEPT_YN  = #{sAcceptYn}
            </if>
            <choose>
                <when test=' sField !=null and sField == "02" '>
                    <if test='sReqFromDt != null '>
                      AND REG_DT  <![CDATA[>=]]>  #{sReqFromDt}
                    </if>
                    <if test='sReqToDt !=null '>
                      AND REG_DT  <![CDATA[<]]>  #{sReqToDt}+1
                    </if>
                </when>
                <when test=' sField !=null and sField == "05" '>
                    <if test='sReqFromDt != null '>
                      AND DDCT_DT  <![CDATA[>=]]>  #{sReqFromDt}
                    </if>
                    <if test='sReqToDt !=null '>
                      AND DDCT_DT  <![CDATA[<]]>  #{sReqToDt}+1
                    </if>
                </when>
            </choose>
    </select>

    <!-- 고품공제 관리 리스트 -사용-->
    <select id="selectDeductOldItemManageByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectDeductOldItemManageByCondition] */

        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT
                      A.DLR_CD                 --딜러코드
                     ,(SELECT DLR_SHT_NM FROM CM_0101T WHERE DLR_CD = A.DLR_CD) AS DLR_NM
                     ,A.VIN_NO                 --차대번호
                     ,A.CLAIM_DOC_NO           --클레임문서번호
                     ,NVL(STAT_CD,'01') STAT_CD   --상태코드
                     ,(SELECT CLAIM_START_DT
                         FROM SE_0710T C
                        WHERE C.DLR_CD       = A.DLR_CD
                          AND C.CLAIM_DOC_NO = A.CLAIM_DOC_NO
                          AND C.CLAIM_STAT_CD ='A'
                          AND ROWNUM = 1 ) AS CLAIM_START_DT --클레임 일자
                     ,A.ATQ_REQ_NO             --고품신청번호
                     ,A.SEQ                    --일련번호
                     ,NVL(A.RUN_DIST_VAL,0)AS RUN_DIST_VAL --주행거리값
                     ,A.RETURN_DT              --반납일자
                     ,A.ITEM_CD                --품목코드
                     ,A.ITEM_NM                --품목명
                     ,NVL(A.ITEM_UNIT_CD,'EA') AS ITEM_UNIT_CD --품목단위코드
                     ,NVL(A.COLLC_QTY,0) AS COLLC_QTY --회수수량
                     ,NVL(A.CLAIM_QTY,0) AS CLAIM_QTY --클레임수량
                     ,A.REQ_TEL_NO             --요청자전화번호
                     ,A.REQ_STAT_CD            --요청상태코드
                     ,A.REQ_REASON_CONT        --요청사유내용
                     ,A.COLLC_REQ_DT           --회수요청일자
                     ,A.REQ_ID                 --요청자ID
                     ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = A.REQ_ID) AS REQ_NM
                     ,A.REQ_DT                 --요청일자
                     ,A.REQ_DEPT_CD            --요청부서코드
                     ,A.COLLC_ID               --회수자ID
                     ,A.COLLC_DT               --회수일자
                     ,A.DDCT_ID                --공제자ID
                     ,A.DDCT_DT                --공제일자
                     ,A.GI_DSTIN_CD            --출고구분코드
                     ,A.GI_REASON_CONT         --출고사유내용
                     ,A.GI_DT                  --출고일자
                     ,A.GI_DEPT_CD             --출고부서코드
                     ,A.GI_ID                  --출고자ID
                     ,A.REG_USR_ID             --등록자ID
                     ,A.REG_DT                 --등록일자
                     ,A.UPDT_USR_ID            --수정자ID
                     ,A.UPDT_DT                --수정일자
                     ,A.DDCT_QTY               --공제수량
                     ,A.RCIP_ID                --수취인ID
                     ,A.RCIP_ADDR_NM           --수취인주소명
                     ,A.RCIP_TEL_NO            --수취인전화번호
                     ,A.EXPS_CMP_NM            --택배회사명
                     ,A.PAY_TP                 --지불유형
                     ,A.SENDER_ID              --부취인ID
                     ,A.SENDER_TEL_NO          --부취인전화번호
                     ,A.TRSF_NO                --운송장번호
                     ,A.NOT_SEND_CAUSE_CONT
                     ,A.NOT_SEND_DT
                     ,A.CONTROLL_DT
                     ,A.OLDITEM_STAT_CD
                     ,A.CONTROLL_USR_ID
                     ,A.ACCEPT_YN
                     ,A.DDCT_YN
                     ,A.WARNING_INFO
                     ,A.OLDITEM_CMP_NM
                     ,A.EXPS_AMT
                FROM SE_0790T A
               WHERE A.STAT_CD IN('04','05')
                 <if test='sDlrCd != null and sDlrCd != ""'>
                 AND DLR_CD = #{sDlrCd}
                 </if>
                 <if test='sStatCd != null and sStatCd != ""'>
                 AND STAT_CD = #{sStatCd}
                 </if>
                 <if test='sItemCd != null and sItemCd != ""'>
                 AND ITEM_CD LIKE '%'||#{sItemCd}||'%'
                 </if>
                 <if test='sItemNm != null and sItemNm != ""'>
                 AND ITEM_NM LIKE '%'||#{sItemNm}||'%'
                 </if>
                 <if test='sClaimDocNo != null and sClaimDocNo != ""'>
                 AND CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
                 </if>
                 <if test='sAtqReqNo != null and sAtqReqNo != ""'>
                 AND ATQ_REQ_NO LIKE '%'||#{sAtqReqNo}||'%'
                 </if>
                 <if test=' sReqDeptCd != null and sReqDeptCd != "" '>
                 AND REQ_DEPT_CD = #{sReqDeptCd}
                 </if>
                 <if test='sAcceptYn != null and sAcceptYn != ""'>
                  AND ACCEPT_YN  = #{sAcceptYn}
                 </if>
                 <choose>
                     <when test=' sField !=null and sField == "02" '>
                         <if test='sReqFromDt != null '>
                           AND REG_DT  <![CDATA[>=]]>  #{sReqFromDt}
                         </if>
                         <if test='sReqToDt !=null '>
                           AND REG_DT  <![CDATA[<]]>  #{sReqToDt}+1
                         </if>
                     </when>
                     <when test=' sField !=null and sField == "05" '>
                         <if test='sReqFromDt != null '>
                           AND DDCT_DT  <![CDATA[>=]]>  #{sReqFromDt}
                         </if>
                         <if test='sReqToDt !=null '>
                           AND DDCT_DT  <![CDATA[<]]>  #{sReqToDt}+1
                         </if>
                     </when>
                 </choose>
                ORDER BY
                <choose>
                    <when test='sort != null'>
                        <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                            <choose>
                                 <when test='item.field == "dlrCd"'>          DLR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "vinNo"'>          VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "claimDocNo"'>     CLAIM_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "statCd"'>         STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "atqReqNo"'>       ATQ_REQ_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "seq"'>            SEQ <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                                 <when test='item.field == "runDistVal"'>     RUN_DIST_VAL <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "returnDt"'>       RETURN_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "itemCd"'>         ITEM_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "itemNm"'>         ITEM_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "itemUnitCd"'>     ITEM_UNIT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "collcQty"'>       COLLC_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "claimQty"'>       CLAIM_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "reqTelNo"'>       REQ_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "reqStatCd"'>      REQ_STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "reqReasonCont"'>  REQ_REASON_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                 <when test='item.field == "collcReqDt"'>     COLLC_REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "reqId"'>          REQ_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "reqDt"'>          REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "reqDeptCd"'>      REQ_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "collcId"'>        COLLC_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                                 <when test='item.field == "collcDt"'>        COLLC_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                                 <when test='item.field == "ddctId"'>         DDCT_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "ddctDt"'>         DDCT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "giDstinCd"'>      GI_DSTIN_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "giReasonCont"'>   GI_REASON_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose> </when>
                                 <when test='item.field == "giDt"'>           GI_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "giDeptCd"'>       GI_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "giId"'>           GI_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                <otherwise>
                                    DLR_CD,CLAIM_DOC_NO,ATQ_REQ_NO,ITEM_CD ASC
                                </otherwise>
                            </choose>
                        </foreach>
                    </when>
                    <otherwise>
                        DLR_CD,CLAIM_DOC_NO,ATQ_REQ_NO,ITEM_CD ASC
                    </otherwise>
                </choose>
            ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- 고품요청관리 목록수 -->
    <select id="selectClaimOldItemInfoByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemInfoByConditionCnt] */


        SELECT COUNT(T1.CLAIM_DOC_NO)AS VALUE
          FROM (
                SELECT C.*
                      ,NVL(D.STAT_CD,'01') AS STAT_CD --상태코드
                      ,D.ATQ_REQ_NO                   --고품신청번호
                  FROM (
                        SELECT
                              A.DLR_CD
                             ,A.VIN_NO
                             ,A.CLAIM_DOC_NO
                             ,A.CLAIM_START_DT
                             ,B.ITEM_CD
                         FROM SE_0710T A , SE_0711T B
                        WHERE A.DLR_CD        = B.DLR_CD
                          AND A.CLAIM_DOC_NO  = B.CLAIM_DOC_NO
                          AND A.CLAIM_STAT_CD = 'A'
                          <if test='sDlrCd != null and sDlrCd !="" '>
                          AND A.DLR_CD        = #{sDlrCd}
                          </if>
                          <if test='sClaimDocNo !=null and sClaimDocNo!="" '>
                          AND A.CLAIM_DOC_NO  = #{sClaimDocNo}
                          </if>
                          <if test='sItemCd !=null and sItemCd != ""'>
                          AND B.ITEM_CD       = #{sItemCd}
                          </if>
                          <choose>
                            <when test=' sField !=null and sField == "01" '>
                                <if test='sReqFromDt != null '>
                                  AND A.CLAIM_CONFIRM_DT  <![CDATA[>=]]>  #{sReqFromDt}
                                </if>
                                <if test='sReqToDt !=null '>
                                  AND A.CLAIM_CONFIRM_DT  <![CDATA[<]]>  #{sReqToDt}+1
                                </if>
                            </when>
                         </choose>
                      )C LEFT OUTER JOIN SE_0790T D
                        ON C.DLR_CD   = D.DLR_CD
                       AND C.VIN_NO   = D.VIN_NO
                       AND C.CLAIM_DOC_NO = D.CLAIM_DOC_NO
                       AND C.ITEM_CD  = D.ITEM_CD
                       <where>
                         <if test=' sReqDeptCd != null and sReqDeptCd != "" '>
                             D.REQ_DEPT_CD = #{sReqDeptCd}
                         </if>
                         <if test=' sAtqReqNo != null and sAtqReqNo != "" '>
                             AND D.ATQ_REQ_NO = '%'||#{sAtqReqNo}||'%'
                         </if>
                         <choose>
                            <when test=' sField !=null and sField == "02" '>
                                <if test='sReqFromDt != null '>
                                  AND D.REQ_DT  <![CDATA[>=]]>  #{sReqFromDt}
                                </if>
                                <if test='sReqToDt !=null '>
                                  AND D.REQ_DT  <![CDATA[<]]>  #{sReqToDt}+1
                                </if>
                            </when>
                         </choose>
                       </where>
                )T1
               WHERE T1.STAT_CD IN('01','02','03')
                <if test='sStatCd != null and sStatCd != ""'>
                 AND T1.STAT_CD = #{sStatCd}
                </if>
    </select>

    <!-- 고품요청관리 (사용) -->
    <select id="selectClaimOldItemInfoByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemInfoByCondition] */

        SELECT * FROM (
             SELECT ROWNUM AS RNUM
                   ,T1.*
                   ,FN_CMM_CD_NM('SER300',T1.STAT_CD, #{sLangCd} , 'N' ) AS STAT_NM
                   ,FN_CMM_CD_NM('SER302',T1.REQ_DEPT_CD, #{sLangCd} , 'N' ) AS REQ_DEPT_NM

               FROM (
                         SELECT C.*
                               ,NVL(D.STAT_CD,'01') AS STAT_CD --상태코드
                               ,D.ATQ_REQ_NO             --고품신청번호
                               ,D.SEQ                    --일련번호
                               ,D.RETURN_DT              --반납일자
                               ,NVL(D.ITEM_UNIT_CD,'EA') AS ITEM_UNIT_CD --품목단위코드
                               ,NVL(D.COLLC_QTY,0) AS COLLC_QTY --회수수량
                               ,D.REQ_TEL_NO             --요청자전화번호
                               ,D.REQ_STAT_CD            --요청상태코드(사용안함.)
                               ,D.REQ_REASON_CONT        --요청사유내용
                               ,D.COLLC_REQ_DT           --회수요청일자
                               ,D.REQ_ID                 --요청자ID
                               ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = D.REQ_ID AND ROWNUM = 1) AS REQ_NM
                               ,D.REQ_DT                 --요청일자
                               ,D.REQ_DEPT_CD            --요청부서코드
                               ,D.COLLC_ID               --회수자ID
                               ,D.COLLC_DT               --회수일자
                               ,D.DDCT_ID                --공제자ID
                               ,D.DDCT_DT                --공제일자
                               ,D.GI_DSTIN_CD            --출고구분코드
                               ,D.GI_REASON_CONT         --출고사유내용
                               ,D.GI_DT                  --출고일자
                               ,D.GI_DEPT_CD             --출고부서코드
                               ,D.GI_ID                  --출고자ID
                               ,D.DDCT_QTY               --공제수량
                               ,D.RCIP_ID                --수취인ID
                               ,D.RCIP_ADDR_NM           --수취인주소명
                               ,D.RCIP_TEL_NO            --수취인전화번호
                               ,D.EXPS_CMP_NM            --택배회사명
                               ,D.PAY_TP                 --지불유형
                               ,D.SENDER_ID              --부취인ID
                               ,D.SENDER_TEL_NO          --부취인전화번호
                               ,D.TRSF_NO                --운송장번호
                               ,D.NOT_SEND_CAUSE_CONT
                               ,D.NOT_SEND_DT
                               ,D.CONTROLL_DT
                               ,D.OLDITEM_STAT_CD
                               ,D.CONTROLL_USR_ID
                               ,D.ACCEPT_YN
                               ,D.DDCT_YN
                               ,D.WARNING_INFO
                               ,D.OLDITEM_CMP_NM
                               ,D.EXPS_AMT
                          FROM (
                           SELECT
                                 A.DLR_CD
                                ,(SELECT DLR_SHT_NM FROM CM_0101T WHERE DLR_CD = A.DLR_CD) AS DLR_NM
                                ,A.VIN_NO
                                ,A.CLAIM_DOC_NO
                                ,A.CLAIM_START_DT
                                ,A.RUN_DIST_VAL
                                ,CASE WHEN B.ITEM_QTY = 0 THEN 1 ELSE B.ITEM_QTY END CLAIM_QTY
                                ,B.ITEM_CD
                                ,B.ITEM_NM
                                ,NVL(B.SALE_UNIT_CD,'EA') AS SALE_UNIT_CD
                            FROM SE_0710T A , SE_0711T B
                           WHERE A.DLR_CD        = B.DLR_CD
                             AND A.CLAIM_DOC_NO  = B.CLAIM_DOC_NO
                             AND A.CLAIM_STAT_CD = 'A'
                             <if test='sDlrCd != null and sDlrCd !="" '>
                             AND A.DLR_CD        = #{sDlrCd}
                             </if>
                             <if test='sClaimDocNo !=null and sClaimDocNo!="" '>
                             AND A.CLAIM_DOC_NO  = #{sClaimDocNo}
                             </if>
                             <if test='sItemCd !=null and sItemCd != ""'>
                             AND B.ITEM_CD       = #{sItemCd}
                             </if>
                             <choose>
                                <when test=' sField !=null and sField == "01" '>
                                    <if test='sReqFromDt != null '>
                                      AND A.CLAIM_CONFIRM_DT  <![CDATA[>=]]>  #{sReqFromDt}
                                    </if>
                                    <if test='sReqToDt !=null '>
                                      AND A.CLAIM_CONFIRM_DT  <![CDATA[<]]>  #{sReqToDt}+1
                                    </if>
                                </when>
                             </choose>
                         )C LEFT OUTER JOIN SE_0790T D
                           ON C.DLR_CD   = D.DLR_CD
                          AND C.VIN_NO   = D.VIN_NO
                          AND C.CLAIM_DOC_NO = D.CLAIM_DOC_NO
                          AND C.ITEM_CD  = D.ITEM_CD
                          <where>
                            <if test=' sReqDeptCd != null and sReqDeptCd != "" '>
                                D.REQ_DEPT_CD = #{sReqDeptCd}
                            </if>
                            <if test=' sAtqReqNo != null and sAtqReqNo != "" '>
                                AND D.ATQ_REQ_NO = '%'||#{sAtqReqNo}||'%'
                            </if>
                            <choose>
                                <when test=' sField !=null and sField == "02" '>
                                    <if test='sReqFromDt != null '>
                                      AND D.REQ_DT  <![CDATA[>=]]>  #{sReqFromDt}
                                    </if>
                                    <if test='sReqToDt !=null '>
                                      AND D.REQ_DT  <![CDATA[<]]>  #{sReqToDt} +1
                                    </if>
                                </when>
                             </choose>
                          </where>
                        ORDER BY
                            <choose>
                                <when test='sort != null'>
                                    <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                                        <choose>
                                             <when test='item.field == "dlrCd"'>          C.DLR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                             <when test='item.field == "vinNo"'>          C.VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                             <when test='item.field == "claimDocNo"'>     C.CLAIM_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                             <when test='item.field == "statCd"'>         D.STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                             <when test='item.field == "runDistVal"'>     C.RUN_DIST_VAL <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                             <when test='item.field == "itemCd"'>         C.ITEM_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                             <when test='item.field == "itemNm"'>         C.ITEM_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                             <when test='item.field == "collcQty"'>       D.COLLC_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                             <when test='item.field == "reqId"'>          D.REQ_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                             <when test='item.field == "reqDt"'>          D.REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                             <when test='item.field == "reqDeptCd"'>      D.REQ_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                            <otherwise>
                                                C.DLR_CD,C.CLAIM_DOC_NO,C.ITEM_CD ASC
                                            </otherwise>
                                        </choose>
                                    </foreach>
                                </when>
                                <otherwise>
                                    C.DLR_CD,C.CLAIM_DOC_NO,C.ITEM_CD ASC
                                </otherwise>
                            </choose>
                     )T1
                     <where>
                        <if test='firstIndex != -1 and lastIndex != -1'>
                            ROWNUM <![CDATA[<=]]> #{lastIndex}
                        </if>
                           AND T1.STAT_CD IN('01','02','03')
                        <if test='sStatCd != null and sStatCd != ""'>
                           AND T1.STAT_CD = #{sStatCd}
                        </if>
                     </where>
                 )
                 <where>
                    <if test='firstIndex != -1 and lastIndex != -1'>
                        RNUM > #{firstIndex}
                    </if>
                </where>
    </select>


    <!-- 고품회수 관리 목록수  사용-->
    <select id="selectClaimOldItemRecoveryByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemRecoveryByConditionCnt] */

        SELECT COUNT(*) AS VALUE
         FROM SE_0790T T1
        WHERE T1.STAT_CD IN('04','08')
         <if test='sDlrCd != null and sDlrCd != ""'>
          AND DLR_CD = #{sDlrCd}
         </if>
         <if test='sStatCd != null and sStatCd != ""'>
          AND STAT_CD = #{sStatCd}
         </if>
         <if test='sOlditemStatCd != null and sOlditemStatCd != ""'>
          AND OLDITEM_STAT_CD = #{sOlditemStatCd}
         </if>
         <if test='sReqDeptCd != null and sReqDeptCd != ""'>
          AND REQ_DEPT_CD  = #{sReqDeptCd}
         </if>
         <if test='sItemCd != null and sItemCd != ""'>
          AND ITEM_CD LIKE '%'||#{sItemCd}||'%'
         </if>
         <if test='sItemNm != null and sItemNm != ""'>
          AND ITEM_NM LIKE '%'||#{sItemNm}||'%'
         </if>
         <if test='sClaimDocNo != null and sClaimDocNo != ""'>
          AND CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
         </if>
         <if test='sAcceptYn != null and sAcceptYn != ""'>
          AND ACCEPT_YN  = #{sAcceptYn}
         </if>
         <choose>
            <when test=' sField !=null and sField == "02" '>
                <if test='sReqFromDt != null '>
                  AND T1.REQ_DT  <![CDATA[>=]]>  #{sReqFromDt}
                </if>
                <if test='sReqToDt !=null '>
                AND T1.REQ_DT  <![CDATA[<]]>  #{sReqToDt}+1
                </if>
            </when>
            <when test=' sField !=null and sField == "03" '>
                <if test='sReqFromDt != null '>
                  AND T1.COLLC_DT  <![CDATA[>=]]>  #{sReqFromDt}
                </if>
                <if test='sReqToDt !=null '>
                AND T1.COLLC_DT  <![CDATA[<]]>  #{sReqToDt}+1
                </if>
            </when>
         </choose>
    </select>

    <!-- 고품회수 관리 리스트 -사용-->
    <select id="selectClaimOldItemRecoveryByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemRecoveryByCondition] */

        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT
                      A.DLR_CD                 --딜러코드
                     ,(SELECT DLR_SHT_NM FROM CM_0101T WHERE DLR_CD = A.DLR_CD) AS DLR_NM
                     ,A.VIN_NO                 --차대번호
                     ,A.CLAIM_DOC_NO           --클레임문서번호
                     ,NVL(STAT_CD,'01') STAT_CD   --상태코드
                     ,FN_CMM_CD_NM('SER300',A.STAT_CD,#{sLangCd},'N') AS STAT_NM
                     ,(SELECT CLAIM_START_DT
                         FROM SE_0710T C
                        WHERE C.DLR_CD       = A.DLR_CD
                          AND C.CLAIM_DOC_NO = A.CLAIM_DOC_NO
                          AND C.CLAIM_STAT_CD ='A'
                          AND ROWNUM = 1 ) AS CLAIM_START_DT --클레임 일자
                     ,A.ATQ_REQ_NO             --고품신청번호
                     ,A.SEQ                    --일련번호
                     ,NVL(A.RUN_DIST_VAL,0)AS RUN_DIST_VAL --주행거리값
                     ,A.RETURN_DT              --반납일자
                     ,A.ITEM_CD                --품목코드
                     ,A.ITEM_NM                --품목명
                     ,NVL(A.ITEM_UNIT_CD,'EA')AS ITEM_UNIT_CD --품목단위코드
                     ,NVL(A.COLLC_QTY,0) AS COLLC_QTY --회수수량
                     ,NVL(A.CLAIM_QTY,0) AS CLAIM_QTY --클레임수량
                     ,A.REQ_TEL_NO             --요청자전화번호
                     ,A.REQ_STAT_CD            --요청상태코드
                     ,A.REQ_REASON_CONT        --요청사유내용
                     ,A.COLLC_REQ_DT           --회수요청일자
                     ,A.REQ_ID                 --요청자ID
                     ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = A.REQ_ID AND ROWNUM = 1) AS REQ_NM
                     ,A.REQ_DT                 --요청일자
                     ,A.REQ_DEPT_CD            --요청부서코드
                     ,FN_CMM_CD_NM('SER302',A.REQ_DEPT_CD,#{sLangCd},'N') REQ_DEPT_NM  --요청부서명
                     ,A.COLLC_ID               --회수자ID
                     ,A.COLLC_DT               --회수일자
                     ,A.DDCT_ID                --공제자ID
                     ,A.DDCT_DT                --공제일자
                     ,A.GI_DSTIN_CD            --출고구분코드
                     ,A.GI_REASON_CONT         --출고사유내용
                     ,A.GI_DT                  --출고일자
                     ,A.GI_DEPT_CD             --출고부서코드
                     ,A.GI_ID                  --출고자ID
                     ,A.REG_USR_ID             --등록자ID
                     ,A.REG_DT                 --등록일자
                     ,A.UPDT_USR_ID            --수정자ID
                     ,A.UPDT_DT                --수정일자
                     ,A.DDCT_QTY               --공제수량
                     ,A.RCIP_ID                --수취인ID
                     ,A.RCIP_ADDR_NM           --수취인주소명
                     ,A.RCIP_TEL_NO            --수취인전화번호
                     ,A.EXPS_CMP_NM            --택배회사명
                     ,A.PAY_TP                 --지불유형
                     ,A.SENDER_ID              --부취인ID
                     ,A.SENDER_TEL_NO          --부취인전화번호
                     ,A.TRSF_NO                --운송장번호
                     ,A.NOT_SEND_CAUSE_CONT
                     ,A.NOT_SEND_DT
                     ,A.CONTROLL_DT
                     ,A.OLDITEM_STAT_CD
                     ,FN_CMM_CD_NM('SER303',A.OLDITEM_STAT_CD, #{sLangCd},'N') AS OLDITEM_STAT_NM
                     ,A.CONTROLL_USR_ID
                     ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = A.CONTROLL_USR_ID AND DLR_CD = 'A07AA' ) AS CONTROLL_USR_NM
                     ,A.ACCEPT_YN
                     ,FN_CMM_CD_NM('COM020',NVL(A.ACCEPT_YN,'N'), #{sLangCd},'N') AS ACCEPT_YN_NM
                     ,A.DDCT_YN
                     ,A.WARNING_INFO
                     ,A.OLDITEM_CMP_NM
                     ,A.EXPS_AMT
                FROM SE_0790T A
               WHERE STAT_CD IN('04','08')
                <if test='sDlrCd != null and sDlrCd != ""'>
                AND DLR_CD = #{sDlrCd}
                </if>
                <if test='sStatCd != null and sStatCd != ""'>
                AND STAT_CD = #{sStatCd}
                </if>
                <if test='sOlditemStatCd != null and sOlditemStatCd != ""'>
                AND OLDITEM_STAT_CD = #{sOlditemStatCd}
                </if>
                <if test='sItemCd != null and sItemCd != ""'>
                AND ITEM_CD LIKE '%'||#{sItemCd}||'%'
                </if>
                <if test='sReqDeptCd != null and sReqDeptCd != ""'>
                AND REQ_DEPT_CD  = #{sReqDeptCd}
                </if>
                <if test='sItemNm != null and sItemNm != ""'>
                AND ITEM_NM LIKE '%'||#{sItemNm}||'%'
                </if>
                <if test='sAcceptYn != null and sAcceptYn != ""'>
                AND ACCEPT_YN  = #{sAcceptYn}
                </if>
                <if test='sClaimDocNo != null and sClaimDocNo != ""'>
                AND CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
                </if>
                <if test='sAtqReqNo != null and sAtqReqNo != ""'>
                AND ATQ_REQ_NO LIKE '%'||#{sAtqReqNo}||'%'
                </if>
                <choose>
                    <when test=' sField !=null and sField == "02" '>
                        <if test='sReqFromDt != null '>
                          AND A.REQ_DT  <![CDATA[>=]]>  #{sReqFromDt}
                        </if>
                        <if test='sReqToDt !=null '>
                          AND A.REQ_DT  <![CDATA[<]]>  #{sReqToDt}+1
                        </if>
                    </when>
                    <when test=' sField !=null and sField == "03" '>
                        <if test='sReqFromDt != null '>
                          AND A.COLLC_DT  <![CDATA[>=]]>  #{sReqFromDt}
                        </if>
                        <if test='sReqToDt !=null '>
                          AND A.COLLC_DT  <![CDATA[<]]>  #{sReqToDt}+1
                        </if>
                    </when>
                 </choose>
                ORDER BY
                <choose>
                    <when test='sort != null'>
                        <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                            <choose>
                                 <when test='item.field == "dlrCd"'>          DLR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "vinNo"'>          VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "claimDocNo"'>     CLAIM_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "statCd"'>         STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "atqReqNo"'>       ATQ_REQ_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "seq"'>            SEQ <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>            </when>
                                 <when test='item.field == "runDistVal"'>     RUN_DIST_VAL <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "returnDt"'>       RETURN_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "itemCd"'>         ITEM_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "itemNm"'>         ITEM_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "itemUnitCd"'>     ITEM_UNIT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "collcQty"'>       COLLC_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "claimQty"'>       CLAIM_QTY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "reqTelNo"'>       REQ_TEL_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "reqStatCd"'>      REQ_STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "reqReasonCont"'>  REQ_REASON_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                 <when test='item.field == "collcReqDt"'>     COLLC_REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "reqId"'>          REQ_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "reqDt"'>          REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "reqDeptCd"'>      REQ_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "collcId"'>        COLLC_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                                 <when test='item.field == "collcDt"'>        COLLC_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                                 <when test='item.field == "ddctId"'>         DDCT_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "ddctDt"'>         DDCT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "giDstinCd"'>      GI_DSTIN_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "giReasonCont"'>   GI_REASON_CONT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose> </when>
                                 <when test='item.field == "giDt"'>           GI_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "giDeptCd"'>       GI_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>     </when>
                                 <when test='item.field == "giId"'>           GI_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                <otherwise>
                                    DLR_CD,CLAIM_DOC_NO,ATQ_REQ_NO,ITEM_CD ASC
                                </otherwise>
                            </choose>
                        </foreach>
                    </when>
                    <otherwise>
                        DLR_CD,CLAIM_DOC_NO,ATQ_REQ_NO,ITEM_CD ASC
                    </otherwise>
                </choose>
            ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>


    <!-- 고품요청 조회 현황 목록 갯수 -->
    <select id="selectClaimOldItemMaterInfoByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemMaterInfoByConditionCnt] */


        SELECT  COUNT(ATQ_REQ_NO) AS VALUE
          FROM (
               SELECT ATQ_REQ_NO
                     ,ROW_NUMBER() OVER(PARTITION BY ATQ_REQ_NO ORDER BY ATQ_REQ_NO )AS RN
                FROM SE_0790T A
              <where>
                 <if test='sDlrCd != null and sDlrCd != ""'>
                 AND A.DLR_CD = #{sDlrCd}
                 </if>
                 <if test='sAtqReqNo != null and sAtqReqNo != ""'>
                 AND A.ATQ_REQ_NO = #{sAtqReqNo}
                 </if>
                 <if test='sStatCd != null and sStatCd != ""'>
                 AND A.STAT_CD = #{sStatCd}
                 </if>
                 <if test='sOlditemStatCd != null and sOlditemStatCd != ""'>
                  AND OLDITEM_STAT_CD = #{sOlditemStatCd}
                 </if>
                 <if test='sItemCd != null and sItemCd != ""'>
                 AND A.ITEM_CD '%'||LIKE #{sItemCd}||'%'
                 </if>
                 <if test='sItemNm != null and sItemNm != ""'>
                 AND A.ITEM_NM LIKE '%'||#{sItemNm}||'%'
                 </if>
                 <if test='sClaimDocNo != null and sClaimDocNo != ""'>
                 AND A.CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
                 </if>
                 <if test='sReqDeptCd != null and sReqDeptCd != ""'>
                 AND A.REQ_DEPT_CD LIKE '%'||#{sReqDeptCd}||'%'
                 </if>
                 <if test='sAcceptYn != null and sAcceptYn != ""'>
                 AND ACCEPT_YN  = #{sAcceptYn}
                 </if>
                 <if test='sGiDeptCd != null and sGiDeptCd != ""'>
                 AND GI_DEPT_CD = #{sGiDeptCd}
                 </if>
                 <choose>
                    <when test=' sField !=null and sField == "02" '>
                        <if test='sReqFromDt != null '>
                          AND A.REQ_DT  <![CDATA[>=]]>  #{sReqFromDt}
                        </if>
                        <if test='sReqToDt !=null '>
                          AND A.REQ_DT  <![CDATA[<]]>  #{sReqToDt}+1
                        </if>
                    </when>
                    <when test=' sField !=null and sField == "03" '>
                        <if test='sReqFromDt != null '>
                          AND A.COLLC_DT  <![CDATA[>=]]>  #{sReqFromDt}
                        </if>
                        <if test='sReqToDt !=null '>
                          AND A.COLLC_DT  <![CDATA[<]]>  #{sReqToDt}+1
                        </if>
                    </when>
                    <when test=' sField !=null and sField == "04" '>
                        <if test='sReqFromDt != null '>
                          AND GI_DT  <![CDATA[>=]]>  #{sReqFromDt}
                        </if>
                        <if test='sReqToDt !=null '>
                          AND GI_DT  <![CDATA[<]]>  #{sReqToDt}+1
                        </if>
                    </when>
                    <when test=' sField !=null and sField == "05" '>
                         <if test='sReqFromDt != null '>
                           AND DDCT_DT  <![CDATA[>=]]>  #{sReqFromDt}
                         </if>
                         <if test='sReqToDt !=null '>
                           AND DDCT_DT  <![CDATA[<]]>  #{sReqToDt}+1
                         </if>
                     </when>
                 </choose>
              </where>
           )B WHERE RN = 1


    </select>

    <!-- 고품요청 조회 현황 리스트 -->
    <select id="selectClaimOldItemMaterInfoByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemMaterInfoByCondition] */


       SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT  B.*
                       ,SUM(CASE WHEN B.TMP_CLAIM_CNT = 1 THEN B.TMP_CLAIM_CNT ELSE 0 END )OVER(PARTITION BY ATQ_REQ_NO) AS CLAIM_CNT
                       ,SUM(CASE WHEN B.TMP_DLR_CNT = 1 THEN B.TMP_DLR_CNT ELSE 0 END) OVER(PARTITION BY ATQ_REQ_NO) AS DLR_CNT
                       ,SUM(CASE WHEN B.TMP_VIN_CNT = 1 THEN B.TMP_VIN_CNT ELSE 0 END) OVER(PARTITION BY ATQ_REQ_NO) AS VIN_CNT
                 FROM (
                      SELECT  DLR_CD                 --딜러코드
                            ,(SELECT DLR_SHT_NM FROM CM_0101T WHERE DLR_CD = A.DLR_CD) AS DLR_NM
                             ,VIN_NO                 --차대번호
                             ,CLAIM_DOC_NO           --클레임문서번호
                             ,STAT_CD                --상태코드
                             ,ATQ_REQ_NO             --고품신청번호
                             ,SEQ                    --일련번호
                             ,NVL(RUN_DIST_VAL,0)AS RUN_DIST_VAL           --주행거리값
                             ,RETURN_DT              --반납일자
                             ,ITEM_CD                --품목코드
                             ,ITEM_NM                --품목명
                             ,NVL(ITEM_UNIT_CD,'EA') AS ITEM_UNIT_CD           --품목단위코드
                             ,NVL(COLLC_QTY,0) AS COLLC_QTY              --회수수량
                             ,NVL(CLAIM_QTY,0) AS CLAIM_QTY              --클레임수량
                             ,REQ_TEL_NO             --요청자전화번호
                             ,REQ_STAT_CD            --요청상태코드
                             ,REQ_REASON_CONT        --요청사유내용
                             ,COLLC_REQ_DT           --회수요청일자
                             ,REQ_ID                 --요청자ID
                             ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = A.REQ_ID AND ROWNUM = 1) AS REQ_NM
                             ,REQ_DT                 --요청일자
                             ,REQ_DEPT_CD            --요청부서코드
                             ,COLLC_ID               --회수자ID
                             ,COLLC_DT               --회수일자
                             ,DDCT_ID                --공제자ID
                             ,DDCT_DT                --공제일자
                             ,GI_DSTIN_CD            --출고구분코드
                             ,GI_REASON_CONT         --출고사유내용
                             ,GI_DT                  --출고일자
                             ,GI_DEPT_CD             --출고부서코드
                             ,GI_ID                  --출고자ID
                             ,NVL(DDCT_QTY,0) AS DDCT_QTY               --공제수량
                             ,RCIP_ID                --수취인ID
                             ,RCIP_ADDR_NM           --수취인주소명
                             ,RCIP_TEL_NO            --수취인전화번호
                             ,EXPS_CMP_NM            --택배회사명
                             ,PAY_TP                 --지불유형
                             ,NOT_SEND_CAUSE_CONT
                             ,NOT_SEND_DT
                             ,CONTROLL_DT
                             ,OLDITEM_STAT_CD
                             ,CONTROLL_USR_ID
                             ,ACCEPT_YN
                             ,DDCT_YN
                             ,WARNING_INFO
                             ,OLDITEM_CMP_NM
                             ,EXPS_AMT
                             ,NVL(ROW_NUMBER() OVER(PARTITION BY DLR_CD,ATQ_REQ_NO, CLAIM_DOC_NO ORDER BY ATQ_REQ_NO ) ,0) AS TMP_CLAIM_CNT
                             ,NVL(ROW_NUMBER() OVER(PARTITION BY DLR_CD,ATQ_REQ_NO ORDER BY ATQ_REQ_NO ) ,0) AS TMP_DLR_CNT
                             ,NVL(ROW_NUMBER() OVER(PARTITION BY ATQ_REQ_NO,VIN_NO ORDER BY ATQ_REQ_NO ) ,0) AS TMP_VIN_CNT
                             ,NVL(ROW_NUMBER() OVER(PARTITION BY ATQ_REQ_NO ORDER BY ATQ_REQ_NO ) ,0) AS RN
                       FROM SE_0790T A
                    <where>
                     <if test='sDlrCd != null and sDlrCd != ""'>
                     AND A.DLR_CD = #{sDlrCd}
                     </if>
                     <if test='sAtqReqNo != null and sAtqReqNo != ""'>
                     AND A.ATQ_REQ_NO = #{sAtqReqNo}
                     </if>
                     <if test='sStatCd != null and sStatCd != ""'>
                     AND A.STAT_CD = #{sStatCd}
                     </if>
                     <if test='sOlditemStatCd != null and sOlditemStatCd != ""'>
                      AND OLDITEM_STAT_CD = #{sOlditemStatCd}
                     </if>
                     <if test='sItemCd != null and sItemCd != ""'>
                     AND A.ITEM_CD '%'||LIKE #{sItemCd}||'%'
                     </if>
                     <if test='sItemNm != null and sItemNm != ""'>
                     AND A.ITEM_NM LIKE '%'||#{sItemNm}||'%'
                     </if>
                     <if test='sClaimDocNo != null and sClaimDocNo != ""'>
                     AND A.CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
                     </if>
                     <if test='sReqDeptCd != null and sReqDeptCd != ""'>
                     AND A.REQ_DEPT_CD LIKE '%'||#{sReqDeptCd}||'%'
                     </if>
                     <if test='sAcceptYn != null and sAcceptYn != ""'>
                     AND ACCEPT_YN  = #{sAcceptYn}
                     </if>
                     <if test='sGiDeptCd != null and sGiDeptCd != ""'>
                     AND GI_DEPT_CD = #{sGiDeptCd}
                     </if>
                     <choose>
                        <when test=' sField !=null and sField == "02" '>
                            <if test='sReqFromDt != null '>
                              AND A.REQ_DT  <![CDATA[>=]]>  #{sReqFromDt}
                            </if>
                            <if test='sReqToDt !=null '>
                              AND A.REQ_DT  <![CDATA[<]]>  #{sReqToDt}+1
                            </if>
                        </when>
                        <when test=' sField !=null and sField == "03" '>
                            <if test='sReqFromDt != null '>
                              AND A.COLLC_DT  <![CDATA[>=]]>  #{sReqFromDt}
                            </if>
                            <if test='sReqToDt !=null '>
                              AND A.COLLC_DT  <![CDATA[<]]>  #{sReqToDt}+1
                            </if>
                        </when>
                        <when test=' sField !=null and sField == "04" '>
                            <if test='sReqFromDt != null '>
                              AND GI_DT  <![CDATA[>=]]>  #{sReqFromDt}
                            </if>
                            <if test='sReqToDt !=null '>
                              AND GI_DT  <![CDATA[<]]>  #{sReqToDt}+1
                            </if>
                        </when>
                        <when test=' sField !=null and sField == "05" '>
                             <if test='sReqFromDt != null '>
                               AND DDCT_DT  <![CDATA[>=]]>  #{sReqFromDt}
                             </if>
                             <if test='sReqToDt !=null '>
                               AND DDCT_DT  <![CDATA[<]]>  #{sReqToDt}+1
                             </if>
                         </when>
                     </choose>
                  </where>
                        ORDER BY
                        <choose>
                            <when test='sort != null'>
                                <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                                    <choose>
                                         <when test='item.field == "reqId"'>          A.REQ_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                         <when test='item.field == "reqDt"'>          A.REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                         <when test='item.field == "reqDeptCd"'>      A.REQ_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                        <otherwise>
                                            ATQ_REQ_NO ASC
                                        </otherwise>
                                    </choose>
                                </foreach>
                            </when>
                            <otherwise>
                                ATQ_REQ_NO ASC
                            </otherwise>
                        </choose>
                  )B
                )T1 WHERE RN = 1
                <if test='firstIndex != -1 and lastIndex != -1'>
                    AND ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            )
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    RNUM > #{firstIndex}
                </if>
            </where>
    </select>

    <!-- 고품요청 조회 상세 목록수 -->
    <select id="selectClaimOldItemDetailInfoByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemDetailInfoByConditionCnt] */


        SELECT COUNT(ATQ_REQ_NO) AS VALUE
          FROM SE_0790T A
        <where>
           <if test='sDlrCd != null and sDlrCd != ""'>
           AND A.DLR_CD = #{sDlrCd}
           </if>
           <if test='sAtqReqNo != null and sAtqReqNo != ""'>
           AND A.ATQ_REQ_NO = #{sAtqReqNo}
           </if>
           <if test='sStatCd != null and sStatCd != ""'>
           AND A.STAT_CD = #{sStatCd}
           </if>
           <if test='sItemCd != null and sItemCd != ""'>
           AND A.ITEM_CD '%'||LIKE #{sItemCd}||'%'
           </if>
           <if test='sItemNm != null and sItemNm != ""'>
           AND A.ITEM_NM LIKE '%'||#{sItemNm}||'%'
           </if>
           <if test='sClaimDocNo != null and sClaimDocNo != ""'>
           AND A.CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
           </if>
           <if test='sReqDeptCd != null and sReqDeptCd != ""'>
           AND A.REQ_DEPT_CD LIKE '%'||#{sReqDeptCd}||'%'
           </if>
           <if test='sReqFromDt != null'>
           AND A.REQ_DT <![CDATA[>=]]> #{sReqFromDt}
           </if>
           <if test='sReqToDt != null'>
           AND A.REQ_DT <![CDATA[<]]> #{sReqToDt} + 1
           </if>
        </where>
    </select>

    <!-- 고품요청 조회  현황 상세 조회 -->
    <select id="selectClaimOldItemDetailInfoByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
        /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemDetailInfoByCondition] */


        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                    SELECT  DLR_CD                 --딜러코드
                          ,(SELECT DLR_SHT_NM FROM CM_0101T WHERE DLR_CD = A.DLR_CD) AS DLR_NM
                          ,VIN_NO                 --차대번호
                          ,CLAIM_DOC_NO           --클레임문서번호
                          ,(SELECT CLAIM_START_DT
                             FROM SE_0710T C
                            WHERE C.DLR_CD       = A.DLR_CD
                              AND C.CLAIM_DOC_NO = A.CLAIM_DOC_NO
                              AND C.CLAIM_STAT_CD ='A'
                              AND ROWNUM = 1 ) AS CLAIM_START_DT --클레임 일자
                          ,STAT_CD                --상태코드
                          ,ATQ_REQ_NO             --고품신청번호
                          ,SEQ                    --일련번호
                          ,NVL(RUN_DIST_VAL,0)RUN_DIST_VAL           --주행거리값
                          ,RETURN_DT              --반납일자
                          ,ITEM_CD                --품목코드
                          ,ITEM_NM                --품목명
                          ,NVL(ITEM_UNIT_CD,'EA') AS ITEM_UNIT_CD           --품목단위코드
                          ,NVL(COLLC_QTY,0)AS COLLC_QTY              --회수수량
                          ,NVL(CLAIM_QTY,0) AS CLAIM_QTY              --클레임수량
                          ,REQ_TEL_NO             --요청자전화번호
                          ,REQ_STAT_CD            --요청상태코드
                          ,REQ_REASON_CONT        --요청사유내용
                          ,COLLC_REQ_DT           --회수요청일자
                          ,REQ_ID                 --요청자ID
                          ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = A.REQ_ID AND ROWNUM = 1) AS REQ_NM
                          ,REQ_DT                 --요청일자
                          ,REQ_DEPT_CD            --요청부서코드
                          ,COLLC_ID               --회수자ID
                          ,COLLC_DT               --회수일자
                          ,DDCT_ID                --공제자ID
                          ,DDCT_DT                --공제일자
                          ,GI_DSTIN_CD            --출고구분코드
                          ,GI_REASON_CONT         --출고사유내용
                          ,GI_DT                  --출고일자
                          ,GI_DEPT_CD             --출고부서코드
                          ,GI_ID                  --출고자ID
                          ,NVL(DDCT_QTY,0)AS DDCT_QTY               --공제수량
                          ,RCIP_ID                --수취인ID
                          ,RCIP_ADDR_NM           --수취인주소명
                          ,RCIP_TEL_NO            --수취인전화번호
                          ,EXPS_CMP_NM            --택배회사명
                          ,PAY_TP                 --지불유형
                          ,A.NOT_SEND_CAUSE_CONT
                          ,A.NOT_SEND_DT
                          ,A.CONTROLL_DT
                          ,A.OLDITEM_STAT_CD
                          ,A.CONTROLL_USR_ID
                          ,A.ACCEPT_YN
                          ,A.DDCT_YN
                          ,A.WARNING_INFO
                          ,A.OLDITEM_CMP_NM
                    FROM SE_0790T A
                  <where>
                     <if test='sDlrCd != null and sDlrCd != ""'>
                     AND A.DLR_CD = #{sDlrCd}
                     </if>
                     <if test='sAtqReqNo != null and sAtqReqNo != ""'>
                     AND A.ATQ_REQ_NO = #{sAtqReqNo}
                     </if>
                     <if test='sStatCd != null and sStatCd != ""'>
                      AND A.STAT_CD = #{sStatCd}
                     </if>
                     <if test='sItemCd != null and sItemCd != ""'>
                     AND A.ITEM_CD '%'||LIKE #{sItemCd}||'%'
                     </if>
                     <if test='sItemNm != null and sItemNm != ""'>
                     AND A.ITEM_NM LIKE '%'||#{sItemNm}||'%'
                     </if>
                     <if test='sClaimDocNo != null and sClaimDocNo != ""'>
                     AND A.CLAIM_DOC_NO LIKE '%'||#{sClaimDocNo}||'%'
                     </if>
                     <if test='sReqDeptCd != null and sReqDeptCd != ""'>
                     AND A.REQ_DEPT_CD LIKE '%'||#{sReqDeptCd}||'%'
                     </if>
                     <if test='sReqFromDt != null'>
                     AND A.REQ_DT <![CDATA[>=]]> #{sReqFromDt}
                     </if>
                     <if test='sReqToDt != null'>
                     AND A.REQ_DT <![CDATA[<]]> #{sReqToDt} + 1
                     </if>
                 </where>
                  ORDER BY
                  <choose>
                      <when test='sort != null'>
                          <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                              <choose>
                                   <when test='item.field == "reqId"'>          A.REQ_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                   <when test='item.field == "reqDt"'>          A.REQ_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                   <when test='item.field == "reqDeptCd"'>      A.REQ_DEPT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                  <otherwise>
                                      ATQ_REQ_NO ASC
                                  </otherwise>
                              </choose>
                          </foreach>
                      </when>
                      <otherwise>
                          ATQ_REQ_NO ASC
                      </otherwise>
                  </choose>
            )T1
             <where>
                 <if test='firstIndex != -1 and lastIndex != -1'>
                     ROWNUM <![CDATA[<=]]> #{lastIndex}
                 </if>
             </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- 고품관리 키조회 -->
    <select id="selectClaimOldItemManageByKey" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemManageByKey] */

        SELECT * FROM SE_0790T
         WHERE 1 = 1
           AND VIN_NO          = #{vinNo}                 --차대번호
           AND CLAIM_DOC_NO    = #{claimDocNo}            --클레임문서번호
           AND SEQ             = #{seq}                   --일련번호
           AND ITEM_CD         = #{itemCd}                --품목코드
           AND DLR_CD          = #{dlrCd}                 --딜러코드
    </select>

    <!-- 고품요청 UPLOAD TEMP 조회-->
    <select id="selectClaimOldItemExcelTempByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemExcelTempByConditionCnt] */
            SELECT COUNT(CLAIM_DOC_NO) AS VALUE
              FROM SE_0790T_TMP
    </select>


    <!-- 고품요청 UPLOAD TEMP 조회-->
    <select id="selectClaimOldItemExcelTempByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemExcelTempByCondition] */

        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT *
                  FROM SE_0790T_TMP
                 ORDER BY VIN_NO , CLAIM_DOC_NO,ITEM_CD
            )T1
             <where>
                 <if test='firstIndex != -1 and lastIndex != -1'>
                     ROWNUM <![CDATA[<=]]> #{lastIndex}
                 </if>
             </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>


    <!-- 고품요청 UPLOAD ERROR 목록수-->
    <select id="selectClaimOldItemExcelTempErrByConditionCnt" parameterType="ClaimOldItemManageSearchVO" resultType="int">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemExcelTempErrByConditionCnt] */

                SELECT COUNT(CLAIM_DOC_NO) AS VALUE
                  FROM SE_0790T_ERR
    </select>


    <!-- 고품요청 UPLOAD TEMP 조회-->
    <select id="selectClaimOldItemExcelTempErrByCondition" parameterType="ClaimOldItemManageSearchVO" resultType="ClaimOldItemManageVO">
    /* [chn.bhmc.dms.ser.wac.service.dao.ClaimOldItemManageDAO.selectClaimOldItemExcelTempErrByCondition] */

        SELECT * FROM (
            SELECT ROWNUM AS RNUM, T1.* FROM (
                SELECT *
                  FROM SE_0790T_ERR
                 ORDER BY VIN_NO , CLAIM_DOC_NO,ITEM_CD
            )T1
             <where>
                 <if test='firstIndex != -1 and lastIndex != -1'>
                     ROWNUM <![CDATA[<=]]> #{lastIndex}
                 </if>
             </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>


    <!-- 고품 데이타 TEMP로 전송. : 프로시져  -->
    <insert id="insertClaimToTemp" parameterType="ClaimOldItemManageVO" statementType="CALLABLE">
        {CALL SP_SER_CLAIM_OLDITEM_REQ(
               #{dlrCd, mode=IN, jdbcType=VARCHAR}
              ,#{vinNo, mode=IN, jdbcType=VARCHAR}
              ,#{claimDocNo, mode=IN, jdbcType=VARCHAR}
              ,#{atqReqNo, mode=IN, jdbcType=VARCHAR}
              ,#{seq, mode=IN, jdbcType=VARCHAR}
              ,#{itemCd, mode=IN, jdbcType=VARCHAR}
        )}
    </insert>

    <!-- 고품 데이타 TEMP로 전송. : 프로시져  -->
    <insert id="insertExcelClaimToTemp" parameterType="string" statementType="CALLABLE">
        {CALL SP_SER_EXCEL_CLAIM_OLDITEM_REQ(
              #{atqReqNo, mode=IN, jdbcType=VARCHAR}
        )}
    </insert>


</mapper>