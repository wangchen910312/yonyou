<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    SQL File Name : ServiceReceiveDAO_SqlMap.xml
    Description : 수납관리 마스터에 관한 데이터처리
    author Yin Xueyuan
    since 2016. 4. 20.
    version 1.0
    Modification Information
       since          author              description
    ===========    =============    ===========================
    2016. 4. 20.  Yin Xueyuan      최초 생성
-->

<mapper namespace="chn.bhmc.dms.ser.rcv.service.dao.ServiceReceiveDAO">

    <select id="selectServiceReceiveByCondition" parameterType="ServiceReceiveSearchVO" resultType="ServiceReceiveVO">
        /* [chn.bhmc.dms.ser.rcv.service.dao.ServiceReceiveDAO.selectServiceReceiveByCondition] */
        SELECT * FROM (
            SELECT ROWNUM AS RNUM
                   ,T1.*
                   ,FN_CMM_CD_NM('COM020',T1.PAYM_YN,#{sLangCd},'N') AS PAYM_YN_NM
                   ,FN_CMM_CD_NM('SER070',T1.RCV_STAT_CD,#{sLangCd},'N') AS RCV_STAT_NM
                   ,FN_CMM_CD_NM('SER060',T1.PAYM_TP,#{sLangCd},'N') AS PAYM_TP_NM
                   ,FN_CMM_CD_NM('SER061',T1.PAYM_MTH_CD,#{sLangCd},'N') AS PAYM_MTH_NM
                   ,FN_CMM_CD_NM('SER062',T1.PAYM_PRID,#{sLangCd},'N') AS PAYM_PRID_NM
                   ,FN_CMM_CD_NM('SER072',T1.RCPT_TP,#{sLangCd},'N') AS RCPT_TP_NM
                   ,T1.PAYM_MTH_CD AS RCV_HIS_PAYM_MTH_CD
                   ,FN_CMM_CD_NM('SER061',T1.PAYM_MTH_CD,#{sLangCd},'N') AS RCV_HIS_PAYM_MTH_CD_NM
                   ,T1.RCPT_TP AS RCV_HIS_RCPT_TP
                   ,FN_CMM_CD_NM('SER072',T1.RCPT_TP,#{sLangCd},'N') AS RCV_HIS_RCPT_TP_NM
                   ,(SELECT USR_NM FROM CM_0801T WHERE USR_ID = T1.RO_REG_USR_ID AND DLR_CD = T1.DLR_CD) AS RO_REG_USR_NM
              FROM (
                     SELECT A.DLR_CD                               --딜러코드
                           ,A.RCV_DOC_NO                           --수납문서번호
                           ,A.RO_TP                                --RO유형
                           ,FN_CMM_CD_NM('SER031',A.RO_TP,#{sLangCd},'N') AS RO_TP_NM
                           ,A.RO_DOC_NO                            --RO문서번호
                           ,A.RO_GRP_NO                            --RO그룹번호
                           ,A.RESV_DOC_NO                          --예약문서번호
                           ,A.DIAG_DOC_NO                          --사전점검번호
                           ,A.PRE_CHK_DT                           --사전점검일자
                           ,A.BASE_RO_NO                           --원RO번호
                           ,A.INC_REQ_NO                           --보험신청번호
                           ,A.CUST_REMARK                          --고객비고
                           ,A.VIN_NO                               --차대번호
                           ,A.CAR_REG_NO                           --차량등록번호
                           ,A.ENGIN_NO                             --엔진시리얼번호
                           ,A.CAR_OWNER_ID                         --차량소유자ID
                           ,A.CAR_OWNER_NM                         --차량소유자명
                           ,A.DRIVER_ID                            --운전자ID
                           ,A.DRIVER_NM                            --운전자명
                           ,A.RESV_DT                              --예약일자
                           ,A.RUN_DIST_VAL                         --주행거리값
                           ,A.LBR_CALC_AMT                         --공임정산금액
                           ,A.LBR_DC_RATE                          --공임할인율
                           ,A.LBR_DC_AMT                           --공임할인금액
                           ,A.LBR_BM_POINT_USE_AMT                 --공임BM포인트사용금액
                           ,A.LBR_POINT_USE_AMT                    --공임포인트사용금액
                           ,A.LBR_ETC_DC_AMT                       --공임기타할인금액
                           ,A.LBR_CALC_SUM_AMT                     --공임정산합계금액
                           ,A.PAR_CALC_AMT                         --부품정산금액
                           ,A.PAR_DC_RATE                          --부품할인율
                           ,A.PAR_DC_AMT                           --부품할인금액
                           ,A.PAR_BM_POINT_USE_AMT                 --부품BM포인트사용금액
                           ,A.PAR_POINT_USE_AMT                    --부품포인트사용금액
                           ,A.PAR_ETC_DC_AMT                       --부품기타할인금액
                           ,A.PAR_CALC_SUM_AMT                     --부품정산합계금액
                           ,A.ETC_CALC_AMT                         --기타정산금액
                           ,A.ETC_DC_RATE                          --기타할인율
                           ,A.ETC_DC_AMT                           --기타할인금액
                           ,A.ETC_BM_POINT_USE_AMT                 --기타BM포인트사용금액
                           ,A.ETC_POINT_USE_AMT                    --기타포인트사용금액
                           ,A.ETC_OTHER_DC_AMT                     --기타다른할인금액
                           ,A.ETC_CALC_SUM_AMT                     --기타정산합계금액
                           ,A.CALC_TOT_AMT                         --정산총금액
                           ,A.DC_TOT_RATE                          --할인총율
                           ,A.DC_TOT_AMT                           --할인총금액
                           ,A.BM_POINT_TOT_AMT                     --BM포인트총금액
                           ,A.POINT_TOT_AMT                        --포인트총금액
                           ,A.ETC_TOT_AMT                          --기타총금액
                           ,A.LAST_CALC_TOT_AMT                    --최종정산총금액
                           ,A.CALC_DT                              --정산일자
                           ,A.CALC_STAT_CD                         --정산상태코드
                           ,A.CALC_DOC_NO                          --정산번호
                           ,A.CALC_PRSN_ID                         --정산번호
                           ,A.CALC_PRSN_NM                         --정산번호
                           ,B.RCV_SUB_DOC_NO                       --수납문서번호
                           ,B.PAYM_TP
                           ,B.PAYM_PRID
                           ,B.PAYM_MTH_CD
                           ,NVL(B.PAYM_AMT,0) AS PAYM_AMT          --수납금액
                           ,NVL(B.NPAY_AMT, NVL(B.PAYM_AMT,0) - NVL(B.RCV_AMT,0)) AS NPAY_AMT  --미수금액
                           ,B.PAYM_REMARK
                           ,B.PAYM_USR_NM
                           ,NVL(B.CALC_AMT,0)  AS CALC_AMT         --정산금액
                           ,NVL(B.RCV_AMT,0)   AS RCV_AMT          --실수금액
                           ,B.RCV_CPLT_DT                          --수납완성일자
                           ,B.NPAY_CHK_DT                          --미수확인일자
                           ,B.RCPT_TP                              --영수증유형
                           ,B.RCPT_NO                              --영수증번호
                           ,B.RCPT_DT                              --영수증일자
                           ,B.RCV_REMARK                           --수납비고
                           ,NVL(B.RCV_STAT_CD, 'O') RCV_STAT_CD    --수납상태
                           ,B.RCV_CANC_YN                          --수납취소여부
                           ,B.RCV_CANC_DT                          --수납취소일자
                           ,B.RCV_CANC_ID                          --수납취소ID
                           ,B.PAYM_CD
                           ,NVL(B.PAR_AMT,0)  AS PAR_AMT
                           ,NVL(B.LBR_AMT,0)  AS LBR_AMT
                           ,NVL(B.ETC_AMT,0)  AS ETC_AMT
                           ,NVL(B.WON_UNIT_CUT_AMT,0) AS WON_UNIT_CUT_AMT       --정산절사
                           ,NVL(B.DEMIC_POINT_CUT_AMT,0) AS DEMIC_POINT_CUT_AMT    --정산제로
                           ,B.DC_PERM_CD
                           ,NVL(B.DC_RATE,0)  AS DC_RATE
                           ,NVL(B.BAL_AMT,0)  AS BAL_AMT
                           ,NVL(B.PRE_AMT,0)  AS PRE_AMT
                           ,B.CUPN_NO
                           ,NVL(B.CUPN_AMT,0) AS CUPN_AMT
                           ,NVL(B.REFD_AMT,0) AS REFD_AMT
                           ,B.REFD_DT
                           ,B.REFD_PRSN_NM
                           ,B.REFD_REMARK
                           ,CASE WHEN NVL(B.RCV_AMT,0) = NVL(B.PAYM_AMT,0) AND B.RCV_STAT_CD = 'F' THEN 'Y' ELSE 'N' END AS PAYM_YN
                           ,(SELECT RO_DT
                               FROM SE_0300T
                              WHERE DLR_CD    = A.DLR_CD
                                AND RO_DOC_NO = A.RO_DOC_NO
                                AND RO_TP     = A.RO_TP
                            )AS RO_DT
                           ,(SELECT REG_USR_ID
                               FROM SE_0300T
                              WHERE DLR_CD    = A.DLR_CD
                                AND RO_DOC_NO = A.RO_DOC_NO
                                AND RO_TP     = A.RO_TP
                            )AS RO_REG_USR_ID
                            ,(SELECT CAR_RUN_DIST_VAL FROM SA_0121T WHERE VIN_NO = A.VIN_NO AND ROWNUM = 1) AS CAR_RUN_DIST_VAL
                            ,(SELECT FN_GET_CARLINE_NM(CARLINE_CD) AS CARLINE_NM FROM SA_0121T WHERE VIN_NO = A.VIN_NO AND ROWNUM = 1) AS CARLINE_NM
                            ,(SELECT FN_GET_MODEL_NM(MODEL_CD) AS MODEL_NM FROM SA_0121T WHERE VIN_NO = A.VIN_NO AND ROWNUM = 1) AS MODEL_NM
                       FROM SE_0550T A, SE_0560T B
                      WHERE B.DLR_CD     = A.DLR_CD
                        AND B.RCV_DOC_NO = A.RCV_DOC_NO
                        AND A.DLR_CD     = #{sDlrCd}
                        <if test='sSerParDstinCd != null and sSerParDstinCd != ""'>
                        AND A.SER_PAR_DSTIN_CD = #{sSerParDstinCd}
                        </if>
                        <if test='sCalcFromDt != null'>
                        AND A.CALC_DT <![CDATA[>=]]> #{sCalcFromDt}
                        </if>
                        <if test='sCalcToDt != null'>
                        AND A.CALC_DT <![CDATA[<]]> #{sCalcToDt} + 1
                        </if>
                        <if test='sVinNo != null and sVinNo != ""'>
                        AND A.VIN_NO LIKE  '%'||  #{sVinNo} ||'%'         -- VIN NO
                        </if>
                        <if test='sRoDocNo != null and sRoDocNo != ""'>
                        AND A.RO_DOC_NO LIKE  '%'|| #{sRoDocNo} ||'%'     --RO NO
                        </if>
                        <if test='sPaymUsrNm != null and sPaymUsrNm != ""'>
                        AND B.PAYM_USR_NM LIKE  '%'|| #{sPaymUsrNm} ||'%' --지불자
                        </if>
                        <if test='sCarRegNo != null and sCarRegNo != ""'>
                        AND A.CAR_REG_NO LIKE '%'|| #{sCarRegNo} ||'%'    --차량번호
                        </if>
                        <if test='sDriverNm != null and sDriverNm != ""'>
                        AND A.DRIVER_NM LIKE '%'|| #{sDriverNm} ||'%'     --수리의뢰자
                        </if>
                        <if test='sRcvDocNo != null and sRcvDocNo != ""'>
                        AND A.RCV_DOC_NO LIKE '%'|| #{sRcvDocNo} ||'%'    --결제문서번호
                        </if>
                        <if test='sPaymTp != null and sPaymTp != ""'>
                        AND B.PAYM_TP = #{sPaymTp}                        --지불유형
                        </if>
                        <if test='sCalcPrsnNm != null and sCalcPrsnNm != ""'>
                        AND A.CALC_PRSN_NM LIKE '%'|| #{sCalcPrsnNm} ||'%' --정비정산자
                        </if>
                        <if test='sRoTp != null and sRoTp != ""'>
                        AND A.RO_TP = #{sRoTp}                            -- RO유형
                        </if>
                        <if test='sPaymPrid != null and sPaymPrid != ""'>
                        AND B.PAYM_PRID = #{sPaymPrid}                    -- 지불기한
                        </if>
                        <if test='sCalcStatCd != null and sCalcStatCd != ""'>
                        AND A.CALC_STAT_CD = #{sCalcStatCd}                    -- 정산상태
                        </if>
                ORDER BY
                <choose>
                    <when test='sort != null'>
                        <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                            <choose>
                                 <when test='item.field == "dlrCd"'>               A.DLR_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>              </when>
                                 <when test='item.field == "rcvDocNo"'>            A.RCV_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "roTp"'>                A.RO_TP <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>               </when>
                                 <when test='item.field == "roDocNo"'>             A.RO_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                                 <when test='item.field == "roGrpNo"'>             A.RO_GRP_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                                 <when test='item.field == "resvDocNo"'>           A.RESV_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "vinNo"'>               A.VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>              </when>
                                 <when test='item.field == "carRegNo"'>            A.CAR_REG_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "carOwnerId"'>          A.CAR_OWNER_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "carOwnerNm"'>          A.CAR_OWNER_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "driverId"'>            A.DRIVER_ID <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                                 <when test='item.field == "driverNm"'>            A.DRIVER_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>           </when>
                                 <when test='item.field == "resvDt"'>              A.RESV_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                                 <when test='item.field == "runDistVal"'>          A.RUN_DIST_VAL <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "lbrCalcAmt"'>          A.LBR_CALC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "lbrDcRate"'>           A.LBR_DC_RATE <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "lbrDcAmt"'>            A.LBR_DC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "lbrBmPointUseAmt"'>    A.LBR_BM_POINT_USE_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                 <when test='item.field == "lbrPointUseAmt"'>      A.LBR_POINT_USE_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "lbrEtcDcAmt"'>         A.LBR_ETC_DC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "lbrCalcSumAmt"'>       A.LBR_CALC_SUM_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "parCalcAmt"'>          A.PAR_CALC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "parDcRate"'>           A.PAR_DC_RATE <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "parDcAmt"'>            A.PAR_DC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "parBmPointUseAmt"'>    A.PAR_BM_POINT_USE_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                 <when test='item.field == "parPointUseAmt"'>      A.PAR_POINT_USE_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "parEtcDcAmt"'>         A.PAR_ETC_DC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>      </when>
                                 <when test='item.field == "parCalcSumAmt"'>       A.PAR_CALC_SUM_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "etcCalcAmt"'>          A.ETC_CALC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "etcDcRate"'>           A.ETC_DC_RATE <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "etcDcAmt"'>            A.ETC_DC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "etcBmPointUseAmt"'>    A.ETC_BM_POINT_USE_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                                 <when test='item.field == "etcPointUseAmt"'>      A.ETC_POINT_USE_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "etcOtherDcAmt"'>       A.ETC_OTHER_DC_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "etcCalcSumAmt"'>       A.ETC_CALC_SUM_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "calcTotAmt"'>          A.CALC_TOT_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "dcTotRate"'>           A.DC_TOT_RATE <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "dcTotAmt"'>            A.DC_TOT_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>          </when>
                                 <when test='item.field == "bmPointTotAmt"'>       A.BM_POINT_TOT_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>    </when>
                                 <when test='item.field == "pointTotAmt"'>         A.POINT_TOT_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>       </when>
                                 <when test='item.field == "etcTotAmt"'>           A.ETC_TOT_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "lastCalcTotAmt"'>      A.LAST_CALC_TOT_AMT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>   </when>
                                 <when test='item.field == "calcDt"'>              A.CALC_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>             </when>
                                 <when test='item.field == "calcStatCd"'>          A.CALC_STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>        </when>
                                 <when test='item.field == "calcDocNo"'>           A.CALC_DOC_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                 <when test='item.field == "rcvStatCd"'>           A.RCV_STAT_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose>         </when>
                                <otherwise>
                                    A.CALC_DOC_NO DESC ,A.RCV_DOC_NO DESC
                                </otherwise>
                            </choose>
                        </foreach>
                    </when>
                    <otherwise>
                        A.CALC_DOC_NO DESC ,A.RCV_DOC_NO DESC
                    </otherwise>
                </choose>
            ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
                <if test='sRcvStatCd != null and sRcvStatCd != ""'>
                AND T1.RCV_STAT_CD = #{sRcvStatCd}              --수납상세 상태코드
                </if>
                <if test='sPaymYn != null and sPaymYn != ""'>
                AND T1.PAYM_YN = #{sPaymYn}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- 수납관리 목록수 -->
    <select id="selectServiceReceiveByConditionCnt" parameterType="ServiceReceiveSearchVO" resultType="int">
        /* [chn.bhmc.dms.ser.rcv.service.dao.ServiceReceiveDAO.selectServiceReceiveByConditionCnt] */
                SELECT COUNT(T1.RCV_DOC_NO) AS VALUE
                  FROM(
                     SELECT A.RCV_DOC_NO
                            ,NVL(B.RCV_STAT_CD, 'O') RCV_STAT_CD    --수납상태
                            ,CASE WHEN NVL(B.RCV_AMT,0) = NVL(B.PAYM_AMT,0) THEN 'Y' ELSE 'N' END AS PAYM_YN
                       FROM SE_0550T A , SE_0560T B
                      WHERE B.DLR_CD     = A.DLR_CD
                        AND B.RCV_DOC_NO = A.RCV_DOC_NO
                        AND A.DLR_CD     = #{sDlrCd}
                        <if test='sSerParDstinCd != null and sSerParDstinCd != ""'>
                        AND A.SER_PAR_DSTIN_CD = #{sSerParDstinCd}
                        </if>
                        <if test='sCalcFromDt != null'>
                        AND A.CALC_DT <![CDATA[>=]]> #{sCalcFromDt}
                        </if>
                        <if test='sCalcToDt != null'>
                        AND A.CALC_DT <![CDATA[<]]> #{sCalcToDt} + 1
                        </if>
                        <if test='sVinNo != null and sVinNo != ""'>
                        AND A.VIN_NO LIKE  '%'||  #{sVinNo} ||'%'         -- VIN NO
                        </if>
                        <if test='sRoDocNo != null and sRoDocNo != ""'>
                        AND A.RO_DOC_NO LIKE  '%'|| #{sRoDocNo} ||'%'     --RO NO
                        </if>
                        <if test='sPaymUsrNm != null and sPaymUsrNm != ""'>
                        AND B.PAYM_USR_NM LIKE  '%'|| #{sPaymUsrNm} ||'%' --지불자
                        </if>
                        <if test='sCarRegNo != null and sCarRegNo != ""'>
                        AND A.CAR_REG_NO LIKE '%'|| #{sCarRegNo} ||'%'    --차량번호
                        </if>
                        <if test='sDriverNm != null and sDriverNm != ""'>
                        AND A.DRIVER_NM LIKE '%'|| #{sDriverNm} ||'%'     --수리의뢰자
                        </if>
                        <if test='sRcvDocNo != null and sRcvDocNo != ""'>
                        AND A.RCV_DOC_NO LIKE '%'|| #{sRcvDocNo} ||'%'    --결제문서번호
                        </if>
                        <if test='sPaymTp != null and sPaymTp != ""'>
                        AND B.PAYM_TP = #{sPaymTp}                        --지불유형
                        </if>
                        <if test='sCalcPrsnNm != null and sCalcPrsnNm != ""'>
                        AND A.CALC_PRSN_NM LIKE '%'|| #{sCalcPrsnNm} ||'%' --정비정산자
                        </if>
                        <if test='sRoTp != null and sRoTp != ""'>
                        AND A.RO_TP = #{sRoTp}                            -- RO유형
                        </if>
                        <if test='sPaymPrid != null and sPaymPrid != ""'>
                        AND B.PAYM_PRID = #{sPaymPrid}                    -- 지불기한
                        </if>
                        <if test='sCalcStatCd != null and sCalcStatCd != ""'>
                        AND A.CALC_STAT_CD = #{sCalcStatCd}               -- 정산상태
                        </if>
                  )T1
                  <where>
                     <if test='sRcvStatCd != null and sRcvStatCd != ""'>
                        T1.RCV_STAT_CD = #{sRcvStatCd}               --수납상세 상태코드
                     </if>
                     <if test='sPaymYn != null and sPaymYn != ""'>
                     AND T1.PAYM_YN = #{sPaymYn}
                     </if>
                  </where>
    </select>
</mapper>