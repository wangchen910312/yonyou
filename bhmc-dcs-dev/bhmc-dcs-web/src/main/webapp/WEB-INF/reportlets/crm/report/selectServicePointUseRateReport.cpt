<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20170720" releaseVersion="8.0.0">
<TableDataMap>
<TableData name="servicePointUseRate" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="sServiceFromDt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sSung"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sJoinToDt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sDivision"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sDlrCd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sOffice"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sCity"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sServiceToDt"/>
<O>
<![CDATA[2018-01-18]]></O>
</Parameter>
<Parameter>
<Attributes name="sJoinFromDt"/>
<O>
<![CDATA[2011-01-11]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[BHDMS]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT DLR_CD
     , MAX(DLR_SHT_NM) AS DLR_NM
     , MAX(SDPT_CD) AS SDPT_CD
     , MAX(SDPT_NM) AS SDPT_NM
     , MAX(DIST_OFFICE_CD)
     , MAX(SALE_DLR_CITY_CD)
     , MAX(SALE_DLR_SUNG_CD)
     , MAX(OFF_NM) AS OFF_NM
     , MAX(SUNG_NM) AS SUNG_NM
     , MAX(CITY_NM) AS CITY_NM
     , '10' AS COL01
     , SUM(RO_CNT) AS COL02
     , SUM(BM) AS COL03
 FROM (
    SELECT DLR_CD,
           MAX(DLR_SHT_NM) AS DLR_SHT_NM,
           MAX(SDPT_CD) AS SDPT_CD,
           MAX(SDPT_NM) AS SDPT_NM,
           MAX(OFF_NM) AS OFF_NM,
           MAX(SUNG_NM) AS SUNG_NM,
           MAX(CITY_NM) AS CITY_NM,
           MAX(DIST_OFFICE_CD) AS DIST_OFFICE_CD,
           MAX(SALE_DLR_CITY_CD) AS SALE_DLR_CITY_CD,
           MAX(SALE_DLR_SUNG_CD) AS SALE_DLR_SUNG_CD,
           CUST_NO,
           COUNT(RO_DOC_NO) AS RO_CNT,
           MAX(BM) AS BM
      FROM (
         SELECT DM.DLR_CD,
                    DM.DLR_SHT_NM,
                 DM.SDPT_CD,
                 SDPT.DIVI_NM AS SDPT_NM,
                 OFFICE.OFF_NM,
                 SUNG.CSTL_NM AS SUNG_NM,
                 CITY.CITY_NM,
                 DM.DIST_OFFICE_CD,
                 DM.SALE_DLR_CITY_CD,
                 DM.SALE_DLR_SUNG_CD,
                 RO.RO_DOC_NO,
                 CM.CUST_NO,
                 DECODE(CM.BLUE_MEMBERSHIP_NO, NULL, 0, 1) AS BM
            FROM SE_0300T RO
           INNER JOIN CM_0101T DM ON RO.DLR_CD = DM.DLR_CD
           INNER JOIN CM_2701T SUNG ON DM.SALE_DLR_SUNG_CD = SUNG.CSTL_CD
           INNER JOIN CM_2501T SDPT ON DM.SDPT_CD = SDPT.DIVI_CD
		 INNER JOIN CM_2601T OFFICE ON DM.DIST_OFFICE_CD = OFFICE.OFF_CD
           INNER JOIN CM_3201T CITY ON DM.SALE_DLR_CITY_CD = CITY.CITY_CD
           INNER JOIN SE_0500T CALC ON RO.DLR_CD = CALC.DLR_CD AND RO.RO_DOC_NO = CALC.RO_DOC_NO
           INNER JOIN SA_0121T VM ON RO.VIN_NO = VM.VIN_NO
           LEFT OUTER JOIN CR_0101T CM ON CM.DLR_CD = RO.DLR_CD
             --AND TO_CHAR(CM.BLUE_MEMBERSHIP_JOIN_DT,'YYYY-MM-DD') BETWEEN '2018-01-11' AND '2018-01-18' -- 검색:bm가입일\
             AND TO_CHAR(CM.BLUE_MEMBERSHIP_JOIN_DT,'YYYY-MM-DD') BETWEEN '${sJoinFromDt}' AND '${sJoinToDt}' -- 검색:bm가입일
           WHERE 1=1
    ${IF(LEN(sDlrCd) <= 0,""," AND DM.DLR_CD = '" + sDlrCd + "'")}
    ${IF(LEN(sDivision) <= 0,""," AND DM.SDPT_CD = '" + sDivision + "'")}
    ${IF(LEN(sOffice) <= 0,""," AND DM.DIST_OFFICE_CD = '" + sOffice + "'")}
    ${IF(LEN(sSung) <= 0,""," AND DM.SALE_DLR_SUNG_CD = '" + sSung + "'")}
    ${IF(LEN(sCity) <= 0,""," AND DM.SALE_DLR_CITY_CD = '" + sCity + "'")}
    --AND DM.DLR_CD = '${sDlrCd}' -- 딜러
    --AND DM.SDPT_CD = '01'--사업부
    --AND DM.DIST_OFFICE_CD = '11' --사무처
    --AND DM.SALE_DLR_CITY_CD = '' --시
    --AND DM.SALE_DLR_SUNG_CD = ''--성
             AND CALC.CALC_STAT_CD = '00'
             AND CALC.CALC_CANC_YN = 'N'
             AND RO.RO_STAT_CD IN('00',  '05')
             AND (RO.GOODWILL_YN != 'Y' OR RO.GOODWILL_YN IS NULL )
             AND RO.RO_DT >= VM.CUST_SALE_DT
             AND VM.NCAR_DSTIN_CD = 'N'
             AND RO.CAR_OWNER_ID IS NOT NULL
             AND CALC.BM_POINT_TOT_AMT > 0           --AND TO_CHAR(CALC.CALC_DT,'yyyy-MM-dd') BETWEEN '2011-11-01' AND '2018-01-18' -- 검색 : 정비일
		   AND TO_CHAR(CALC.CALC_DT,'yyyy-MM-dd') BETWEEN '${sServiceFromDt}' AND '${sServiceToDt}' -- 검색 : 정비일
       )
       GROUP BY DLR_CD, CUST_NO
   )
   GROUP BY DLR_CD]]></Query>
</TableData>
</TableDataMap>
<Report class="com.fr.report.worksheet.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="1" T="1"/>
<FR/>
<HC/>
<FC/>
<UPFCR COLUMN="false" ROW="true"/>
</ReportPageAttr>
<ColumnPrivilegeControl/>
<RowPrivilegeControl/>
<RowHeight defaultValue="723900">
<![CDATA[288000,1943100,1440000,0,1440000,723900,723900,723900,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[288000,2880000,2880000,2880000,2880000,2880000,8640000,7920000,3600000,3600000,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0">
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="1" s="0">
<O>
<![CDATA[事业部 ]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="2" r="1" s="0">
<O>
<![CDATA[办事处]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="3" r="1" s="0">
<O>
<![CDATA[省市]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="4" r="1" s="0">
<O>
<![CDATA[城市]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="5" r="1" s="0">
<O>
<![CDATA[特约店代码]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="6" r="1" s="0">
<O>
<![CDATA[特约店简称]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="7" r="1" s="0">
<O>
<![CDATA[有效工单总数]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="8" r="1" s="0">
<O>
<![CDATA[使用积分工单数]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="9" r="1" s="0">
<O>
<![CDATA[入会率]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="2" s="1">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="SDPT_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="2" r="2" s="1">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="OFF_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="3" r="2" s="1">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="SUNG_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="4" r="2" s="1">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="CITY_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="5" r="2" s="1">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="DLR_CD"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="6" r="2" s="1">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="DLR_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="7" r="2" s="2">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="COL01"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="8" r="2" s="2">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="COL02"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="9" r="2" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=I3/H3]]></Attributes>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="7" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="COL01"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="8" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="servicePointUseRate" columnName="COL02"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="9" r="3" s="3">
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="1" r="4" cs="6" s="1">
<O>
<![CDATA[合计]]></O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="7" r="4" s="2">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(H3)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="8" r="4" s="2">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(I3)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="9" r="4" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=I5/H5]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1">
<PaperSize width="43200000" height="180000000"/>
<Margin top="432000" left="432000" bottom="432000" right="432000"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
<PrivilegeControl/>
</Report>
<ReportParameterAttr>
<Attributes showWindow="true" delayPlaying="true" windowPosition="1" align="0" useParamsTemplate="false"/>
<PWTitle>
<![CDATA[매개변수]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="Microsoft YaHei UI" style="0" size="72" foreground="-1"/>
<Background name="ColorBackground" color="-11561760"/>
<Border>
<Top style="1" color="-3352093"/>
<Bottom style="1" color="-3352093"/>
<Left style="1" color="-3352093"/>
<Right style="1" color="-3352093"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00]]></Format>
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0]]></Format>
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0%]]></Format>
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
</StyleList>
<DesignerVersion DesignerVersion="IAA"/>
</WorkBook>
