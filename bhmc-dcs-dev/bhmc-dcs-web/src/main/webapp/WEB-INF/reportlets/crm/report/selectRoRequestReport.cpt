<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20170715" releaseVersion="8.0.0">
<TableDataMap>
<TableData name="roRequestDs" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="sSung"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sSearchFromDt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sSearchToDt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sDivision"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sDlrCd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sOffice"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sReqTp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sCity"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[BHDMS]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT ROWNUM AS RNUM
      ,A.*
FROM (
    SELECT DM.DLR_CD  -- 딜러코드
          ,DM.DLR_SHT_NM AS DLR_NM  -- 딜러명
          ,SDPT.DIVI_NM AS SDPT_NM  -- 사업부
          ,OFFICE.OFF_NM    -- 사무처
          --,SUNG.CSTL_NM AS SUNG_NM    -- 성
          --,CITY.CITY_NM   -- 시
          ,COUNT(1) AS COL01 -- 요청량
		, SUM(CASE WHEN SUBSTR(T1.BHMC_VOC_NO, 0,2) != 'BM' AND T1.DLR_RESP_CD = '02' THEN 1
            ELSE 0
            END) AS COL02           -- 비예약정비 미대응량
          , SUM(CASE WHEN SUBSTR(T1.BHMC_VOC_NO, 0,2) = 'BM' AND T1.DLR_RESP_CD = '01' THEN 1
            ELSE 0
            END) AS COL03          -- 예약정비 미대응량
          ,40 AS COL04    -- 미대응총량
          ,50 AS COL05    -- 24시간대응률
          , SUM(CASE WHEN  T1.CLS_DT <= 30 AND (T1.VOC_STAT_CD = '06' OR T1.VOC_STAT_CD = '07') THEN 1
            ELSE 0
            END) AS COL06          -- 월간Close수(CRM624)
          ,70 AS COL07    -- 월간Close률
    FROM
      (
        SELECT
          T1.*
            , CASE WHEN T1.PROC_DT > T2.RDT THEN T2.RDT ELSE T1.PROC_DT END AS FIRST_TRACE_DT
            , CASE WHEN T1.MTH_ACHV_HM IS NOT NULL THEN
                TRUNC(T1.MTH_ACHV_HM - T1.EVAL_ALLOC_DT)  -- 방안달성시간 - 심사배정시간
              ELSE
                TRUNC(T1.PROC_DT - T1.EVAL_ALLOC_DT)      -- 처리시간 - 심사배정시간
              END AS CLS_DT
        FROM CR_0601T T1
            LEFT OUTER  JOIN (
              SELECT ROW_NUMBER() OVER (PARTITION BY VOC_NO ORDER BY REG_DT ASC ) AS RN
              ,DLR_CD, VOC_NO, REG_DT AS RDT
              FROM CR_0602T
            ) T2 ON T2.RN=1 AND T1.DLR_CD = T2.DLR_CD AND T1.VOC_NO = T2.VOC_NO
      ) T1
    INNER JOIN CM_0101T DM ON T1.DLR_CD = DM.DLR_CD
    INNER JOIN CM_2701T SUNG ON DM.SALE_DLR_SUNG_CD = SUNG.CSTL_CD
    INNER JOIN CM_2501T SDPT ON DM.SDPT_CD = SDPT.DIVI_CD
    INNER JOIN CM_2601T OFFICE ON DM.DIST_OFFICE_CD = OFFICE.OFF_CD
    INNER JOIN CM_3201T CITY ON DM.SALE_DLR_CITY_CD = CITY.CITY_CD
    WHERE 1=1
    AND DM.DMS_USE_YN = 'Y'
    AND T1.VOC_TP_CD = '03'  -- CRM604
    AND T1.BHMC_YN = 'Y'
--    AND TO_CHAR(T1.EVAL_ALLOC_DT,'YYYY-MM-DD') BETWEEN '2000-01-01' AND '2018-01-30'
    ${IF(LEN(sSearchFromDt) = 0 , ""," AND TO_CHAR(T1.EVAL_ALLOC_DT,'YYYY-MM-DD') BETWEEN '"+sSearchFromDt+"' AND '"+sSearchToDt+"'") }
    ${IF(LEN(sDlrCd) <= 0,""," AND T1.DLR_CD = '" + sDlrCd + "'")}
    ${IF(LEN(sDivision) <= 0,""," AND DM.SDPT_CD = '" + sDivision + "'")}
    ${IF(LEN(sOffice) <= 0,""," AND DM.DIST_OFFICE_CD = '" + sOffice + "'")}
    --${IF(LEN(sSung) <= 0,""," AND DM.SALE_DLR_SUNG_CD = '" + sSung + "'")}
    --${IF(LEN(sCity) <= 0,""," AND DM.SALE_DLR_CITY_CD = '" + sCity + "'")}
    --${IF(LEN(sReqTp) <= 0,""," AND REQ_TP = '" + sReqTp + "'")}
    --GROUP BY DM.DLR_CD,DM.DLR_SHT_NM,SUNG.CSTL_NM,SDPT.DIVI_NM,OFFICE.OFF_NM,CITY.CITY_NM
    GROUP BY DM.DLR_CD,DM.DLR_SHT_NM,SDPT.DIVI_NM,OFFICE.OFF_NM
    ORDER BY DLR_CD ASC
    ) A]]></Query>
</TableData>
</TableDataMap>
<Report class="com.fr.report.worksheet.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="4" T="4"/>
<FR/>
<HC/>
<FC/>
<UPFCR COLUMN="false" ROW="true"/>
</ReportPageAttr>
<ColumnPrivilegeControl/>
<RowPrivilegeControl/>
<RowHeight defaultValue="723900">
<![CDATA[288000,864000,864000,288000,1440000,1440000,0,1440000,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[288000,2160000,2880000,2880000,2880000,8640000,3600000,4320000,4320000,3600000,3600000,3600000,3600000,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0">
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="1" cs="2" s="0">
<O>
<![CDATA[请求工单总量 : ]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="3" r="1" s="1">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=G8]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="2" cs="2" s="0">
<O>
<![CDATA[24H未响应总量 : ]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="3" r="2" s="1">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=J8]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="0" r="3">
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="4" s="2">
<O>
<![CDATA[序号]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="2" r="4" s="2">
<O>
<![CDATA[事业部 ]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="3" r="4" s="2">
<O>
<![CDATA[办事处]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="4" r="4" s="2">
<O>
<![CDATA[特约店代码]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="5" r="4" s="2">
<O>
<![CDATA[特约店简称]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="6" r="4" s="2">
<O>
<![CDATA[请求量]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="7" r="4" s="2">
<O>
<![CDATA[非预约维保未响应量]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="8" r="4" s="2">
<O>
<![CDATA[预约维保未响应量]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="9" r="4" s="2">
<O>
<![CDATA[未响应总量]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="10" r="4" s="2">
<O>
<![CDATA[24H响应率]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="11" r="4" s="2">
<O>
<![CDATA[月度关闭量]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="12" r="4" s="2">
<O>
<![CDATA[月度关闭率]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="5" s="3">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="RNUM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="2" r="5" s="4">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="SDPT_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="3" r="5" s="4">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="OFF_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="4" r="5" s="4">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="DLR_CD"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="5" r="5" s="4">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="DLR_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="6" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL01"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="7" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL02"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="8" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL03"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="9" r="5" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=H6 + I6]]></Attributes>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="10" r="5" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=(G6-J6)/G6]]></Attributes>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="11" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL06"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="12" r="5" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=L6/G6]]></Attributes>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="6" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL01"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="7" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL02"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="8" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL03"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="9" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL04"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="10" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL05"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="11" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL06"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="12" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="roRequestDs" columnName="COL11"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="1" r="7" cs="5" s="4">
<O>
<![CDATA[合计]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="6" r="7" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(G6)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="7" r="7" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(H6)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="8" r="7" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(I6)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="9" r="7" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(J6)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="10" r="7" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=(G8-J8)/G8]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="11" r="7" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(L6)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="12" r="7" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=L8/G8]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1">
<PaperSize width="43200000" height="180000000"/>
<Margin top="432000" left="432000" bottom="432000" right="432000"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
<PrivilegeControl/>
</Report>
<ReportParameterAttr>
<Attributes showWindow="true" delayPlaying="true" windowPosition="1" align="0"/>
<PWTitle>
<![CDATA[매개변수]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="Dialog" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="Dialog" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="Microsoft YaHei UI" style="0" size="72" foreground="-1"/>
<Background name="ColorBackground" color="-11561760"/>
<Border>
<Top style="1" color="-3352093"/>
<Bottom style="1" color="-3352093"/>
<Left style="1" color="-3352093"/>
<Right style="1" color="-3352093"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00]]></Format>
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0]]></Format>
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#0%]]></Format>
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
</StyleList>
<DesignerVersion DesignerVersion="IAA"/>
<PreviewType PreviewType="0"/>
<TemplateID TemplateID="0961e9d1-1259-480b-819f-d3cfd4e23852"/>
</WorkBook>
