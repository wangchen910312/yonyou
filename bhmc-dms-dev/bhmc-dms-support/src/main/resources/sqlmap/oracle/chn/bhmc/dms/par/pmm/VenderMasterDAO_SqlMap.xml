<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- SQL File Name : VenderMasterDAO_SqlMap.xml Description : 거래처 관리. author
    In Bo Shim since 2016. 1. 11. version 1.0 Modification Information since
    author description =========== ============= ===========================
    2016. 01. 11. In Bo Shim 최초 생성 -->

<mapper namespace="chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO">

    <!-- 거래처 정보를 추가한다. -->
    <insert id="insertVenderMaster" parameterType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.insertVenderMaster]
        */
        INSERT INTO PT_0211T(
        DLR_CD
        , BP_CD
        , BP_NM
        , CONTRACT_NO
        , CONTRACT_START_DT
        , CONTRACT_END_DT
        , BP_FULL_NM
        , BP_EN_NM
        , BP_TP
        , CNTRY_CD
        , DIST_CD
        , DIST_NM
        , OWN_RGST_NM
        , CRN_NO
        , DEAL_CURR_UNIT_CD
        , COF_DT
        , ZIP_CD
        , SUNG_CD
        , SUNG_NM
        , ADDR
        , HOMEPAGE_URL
        , TEL_NO
        , FAX_NO
        , PRSN_NM
        , PRSN_TEL_NO
        , PRSN_HP_NO
        , PRSN_EMAIL_NM
        , PAY_TP
        , PAY_TERM_CD
        , BANK_NM
        , BANK_AC_NO
        , BANK_CARD_NO
        , AC_OWNER_NM
        , END_YN
        , REMARK
        , DC_RATE
        , PRC_TP
        , TAX_RATE
        , BP_DSTIN_CD
        , REG_USR_ID
        , REG_DT
        ) VALUES (
        #{ dlrCd }
        , #{ bpCd }
        , #{ bpNm }
        , #{ contractNo }
        , #{ contractStartDt }
        , #{ contractEndDt }
        , #{ bpFullNm }
        , #{ bpEnNm }
        , #{ bpTp }
        , #{ cntryCd }
        , #{ distCd }
        , #{ distNm }
        , #{ ownRgstNm }
        , #{ crnNo }
        , #{ dealCurrUnitCd }
        , #{ cofDt }
        , #{ zipCd }
        , #{ sungCd }
        , #{ sungNm }
        , #{ addr }
        , #{ homepageUrl }
        , #{ telNo }
        , #{ faxNo }
        , #{ prsnNm }
        , #{ prsnTelNo }
        , #{ prsnHpNo }
        , #{ prsnEmailNm }
        , #{ payTp }
        , #{ payTermCd }
        , #{ bankNm }
        , #{ bankAcNo }
        , #{ bankCardNo }
        , #{ acOwnerNm }
        , #{ endYn }
        , #{ remark }
        , #{ dcRate }
        , #{ prcTp }
        , #{ taxRate }
        , #{ bpDstinCd }
        , #{ regUsrId }
        , SYSDATE
        )
    </insert>

    <!-- 거래처 정보를 수정한다. -->
    <update id="updateVenderMaster" parameterType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.updateVenderMaster]
        */
        UPDATE PT_0211T SET
        BP_NM = #{ bpNm }
        ,CONTRACT_NO = #{ contractNo }
        ,CONTRACT_START_DT = #{ contractStartDt }
        ,CONTRACT_END_DT = #{ contractEndDt }
        ,BP_FULL_NM = #{ bpFullNm }
        ,BP_EN_NM = #{ bpEnNm }
        ,BP_TP = #{ bpTp }
        ,CNTRY_CD = #{ cntryCd }
        ,DIST_CD = #{ distCd }
        ,DIST_NM = #{ distNm }
        ,OWN_RGST_NM = #{ ownRgstNm }
        ,CRN_NO = #{ crnNo }
        ,DEAL_CURR_UNIT_CD = #{ dealCurrUnitCd }
        ,COF_DT = #{ cofDt }
        ,ZIP_CD = #{ zipCd }
        ,SUNG_CD = #{ sungCd }
        ,SUNG_NM = #{ sungNm }
        ,ADDR = #{ addr }
        ,HOMEPAGE_URL = #{ homepageUrl }
        ,TEL_NO = #{ telNo }
        ,FAX_NO = #{ faxNo }
        ,PRSN_NM = #{ prsnNm }
        ,PRSN_TEL_NO = #{ prsnTelNo }
        ,PRSN_HP_NO = #{ prsnHpNo }
        ,PRSN_EMAIL_NM = #{ prsnEmailNm }
        ,PAY_TP = #{ payTp }
        ,PAY_TERM_CD = #{ payTermCd }
        ,BANK_NM = #{ bankNm }
        ,BANK_AC_NO = #{ bankAcNo }
        ,BANK_CARD_NO = #{ bankCardNo }
        ,AC_OWNER_NM = #{ acOwnerNm }
        ,END_YN = #{ endYn }
        ,REMARK = #{ remark }
        ,DC_RATE = #{ dcRate }
        ,PRC_TP = #{ prcTp }
        ,TAX_RATE = #{ taxRate }
        ,UPDT_USR_ID = #{ updtUsrId }
        ,UPDT_DT = SYSDATE
        WHERE DLR_CD = #{dlrCd}
        AND BP_CD = #{bpCd}
    </update>

    <!-- 액셀 거래처 정보를 추가한다. -->
    <insert id="insertVenderMasterExcelDown" parameterType="VenderMasterExcelVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.insertVenderMasterExcel]
        */
        INSERT INTO PT_0211T(
            DLR_CD
            ,BP_CD
            ,BP_NM
            ,CONTRACT_NO
            ,CONTRACT_START_DT
            ,CONTRACT_END_DT
            ,BP_FULL_NM
            ,BP_EN_NM
            ,BP_TP
            ,CNTRY_CD
            ,DIST_CD
            ,DIST_NM
            ,OWN_RGST_NM
            ,CRN_NO
            ,DEAL_CURR_UNIT_CD
            ,COF_DT
            ,ZIP_CD
            ,SUNG_CD
            ,SUNG_NM
            ,ADDR
            ,HOMEPAGE_URL
            ,TEL_NO
            ,FAX_NO
            ,PRSN_NM
            ,PRSN_TEL_NO
            ,PRSN_HP_NO
            ,PRSN_EMAIL_NM
            ,PAY_TP
            ,PAY_TERM_CD
            ,BANK_NM
            ,BANK_AC_NO
            ,BANK_CARD_NO
            ,AC_OWNER_NM
            ,END_YN
            ,REMARK
            ,DC_RATE
            ,PRC_TP
            ,TAX_RATE
            ,BP_DSTIN_CD
            ,REG_USR_ID
            ,REG_DT
        ) VALUES (
            #{dlrCd}
            ,#{bpCd}
            ,#{bpNm}
            ,#{contractNo}
            ,#{contractStartDt}
            ,null
            ,#{bpFullNm}
            ,null
            ,#{bpTp}
            ,'CN'
            ,null
            ,#{distNm}
            ,#{ownRgstNm}
            ,null
            ,null
            ,null
            ,#{zipCd}
            ,null
            ,#{sungNm}
            ,#{addr}
            ,null
            ,null
            ,null
            ,#{prsnNm}
            ,#{prsnTelNo}
            ,#{prsnHpNo}
            ,null
            ,null
            ,null
            ,null
            ,null
            ,null
            ,null
            ,'N'
            ,null
            ,null
            ,null
            ,null
            ,#{bpDstinCd}
            ,#{regUsrId}
            ,SYSDATE
        )
    </insert>

    <!-- 액셀 거래처 정보를 수정한다. -->
    <update id="updateVenderMasterExcelDown" parameterType="VenderMasterExcelVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.updateVenderMasterExcelDown]
        */
        UPDATE PT_0211T SET
            BP_NM = #{ bpNm }
            ,CONTRACT_NO = #{ contractNo }
            ,CONTRACT_START_DT = TO_DATE(#{ contractStartDt })
            ,BP_FULL_NM = #{ bpFullNm }
            ,DIST_CD = #{ distCd }
            ,DIST_NM = #{ distNm }
            ,SUNG_CD = #{ sungCd }
            ,SUNG_NM = #{ sungNm }
            ,OWN_RGST_NM = #{ ownRgstNm }
            ,ADDR = #{ addr }
            ,ZIP_CD = #{ zipCd }
            ,UPDT_USR_ID = #{ updtUsrId }
            ,UPDT_DT = SYSDATE
        WHERE DLR_CD = #{dlrCd}
        AND BP_CD = #{bpCd}
    </update>

    <!-- 거래처 정보를 삭제한다. -->
    <delete id="deleteVenderMaster" parameterType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.deleteVenderMaster]
        */
        UPDATE PT_0211T SET
        END_YN = 'Y'
        ,UPDT_USR_ID = #{ updtUsrId }
        ,UPDT_DT = SYSDATE
        WHERE DLR_CD = #{dlrCd}
        AND BP_CD = #{bpCd}
    </delete>

    <!-- 거래처 정보를 조회한다. -->
    <select id="selectVenderMasterByKey" parameterType="map"
        resultType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectVenderMasterByKey]
        */
        SELECT * FROM PT_0211T
        WHERE DLR_CD = #{dlrCd}
        AND BP_CD =
        #{bpCd}
    </select>

    <!-- 거래처 정보를 조합 키 조회한다. -->
    <select id="selectVenderMasterBpTpByKey" parameterType="map" resultType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectVenderMasterBpTpByKey]
        */
        SELECT
            T.REMARK1 || LPAD(T.BP_TP_CNT+1,4,'0') AS BP_CD
            ,T.BP_TP
            ,T.BP_TP_CNT
        FROM
        (
        SELECT A.REMARK1
        ,A.BP_TP
        ,(
        SELECT
            CASE WHEN MAX(BP_CD) IS NULL THEN 0
            ELSE ROUND(MAX(TO_NUMBER(SUBSTR(BP_CD,7,8))),0)
            END
        FROM PT_0211T B WHERE B.DLR_CD = #{dlrCd} AND B.BP_CD LIKE '%'||A.REMARK1||'%'
        ) AS BP_TP_CNT
        from
        (
        SELECT
            CASE WHEN #{bpTp} = '01' THEN (SELECT BMP_BP_CD FROM CM_0101T A WHERE
            A.DLR_CD = #{dlrCd}) || B.REMARK1
            ELSE (SELECT DLR_CD FROM CM_0101T A WHERE A.DLR_CD = #{dlrCd}) ||
            B.REMARK1
            END REMARK1
            ,#{bpTp} AS BP_TP
        FROM CM_0303T B
        WHERE B.CMM_CD = #{bpTp}
        AND B.CMM_GRP_CD = 'PAR121'
        )A
        ) T
    </select>

    <!-- 액셀 거래처 정보 목록을 조회한다. -->
    <select id="selectVenderMastersExcelDownByCondition" parameterType="VenderMasterSearchVO" resultType="VenderMasterExcelVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectVenderMastersExcelDownByCondition]
        */
        SELECT
            AA.DLR_CD
            --,AA.BP_TP
            ,AA.BP_CD
            ,AA.BP_NM
            ,AA.BP_FULL_NM
            ,AA.CONTRACT_NO
            ,TO_CHAR(AA.CONTRACT_START_DT,'YYYYMMDD') AS CONTRACT_START_DT
            ,AA.BP_TP
            ,AA.SUNG_CD
            ,AA.SUNG_NM
            ,AA.DIST_CD
            ,AA.DIST_NM
            ,AA.OWN_RGST_NM
            ,AA.CRN_NO
            ,AA.DEAL_CURR_UNIT_CD
            ,AA.COF_DT
            ,AA.ADDR
            ,AA.ZIP_CD
            ,AA.HOMEPAGE_URL
            ,AA.TEL_NO
            ,AA.FAX_NO
            ,NVL(
                    (select
                        AB.PRSN_NM AS PRSN_NM
                     from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
                     AND AB.BP_CD = AA.BP_CD
                     AND AB.LINE_NO IN (
                        SELECT
                            MIN(AC.LINE_NO)
                        FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND AC.BP_CD = AA.BP_CD
                        )
                    )
            ,' ') AS PRSN_NM
            ,NVL(
                    (select
                        AB.PRSN_HP_NO AS PRSN_NM
                     from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
                     AND AB.BP_CD = AA.BP_CD
                     AND AB.LINE_NO IN (
                        SELECT
                            MIN(AC.LINE_NO)
                        FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND AC.BP_CD = AA.BP_CD
                        )
                    )
            ,' ') AS PRSN_HP_NO
            ,NVL(
                    (select
                        AB.PRSN_TEL_NO AS PRSN_NM
                     from PT_0215T AB
                     WHERE AB.DLR_CD = AA.DLR_CD AND AB.BP_CD = AA.BP_CD
                     AND AB.LINE_NO IN (
                        SELECT
                            MIN(AC.LINE_NO)
                        FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND AC.BP_CD = AA.BP_CD
                        )
                    )
            ,' ') AS PRSN_TEL_NO
        FROM PT_0211T AA
        <where>
            <if test='sDlrCd != null and sDlrCd != ""'>
                AND AA.DLR_CD = #{sDlrCd}
            </if>
            <if test='sBpCd != null and sBpCd != ""'>
                AND AA.BP_CD LIKE '%'||#{sBpCd}||'%'
            </if>
            <if test='sBpNm != null and sBpNm != ""'>
                AND AA.BP_NM LIKE '%'||#{sBpNm}||'%'
            </if>
            <if test='sBpTp != null and sBpTp != ""'>
                AND AA.BP_TP = #{sBpTp}
            </if>
            <if test='sBpTpLst != null and !sBpTpLst.isEmpty'>
                AND AA.BP_TP IN
                <foreach item="item" index="index" collection="sBpTpLst"
                    open="(" separator="," close=")">
                    #{item}
            </foreach>
            </if>
            <if test='sBpDstinCd != null and sBpDstinCd != ""'>
                AND AA.BP_DSTIN_CD = #{sBpDstinCd}
            </if>
            <if test='sEndYn != null and sEndYn != ""'>
                AND AA.END_YN = #{sEndYn}
            </if>

            AND END_YN != 'Y'

        </where>
        ORDER BY
        <choose>
            <when test='sort != null'>
                <foreach item="item" index="index" collection="sort"
                    open="" separator="," close="">
                    <choose>
                        <when test='item.field == "bpCd"'>
                            AA.BP_CD
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AA.DLR_CD ASC
                        </otherwise>
                    </choose>
                </foreach>
            </when>
            <otherwise>
                AA.DLR_CD ASC
            </otherwise>
        </choose>
    </select>

    <!-- 액셀 고객 정보 목록을 조회한다. -->
    <select id="selectVenderCustomerMastersExcelDownByCondition"
        parameterType="VenderMasterSearchVO" resultType="VenderCustomerMasterExcelVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectVenderCustomerMastersExcelDownByCondition]
        */
        SELECT
            AA.DLR_CD
            ,AA.BP_TP
            ,AA.BP_CD
            ,AA.BP_NM
            ,AA.BP_FULL_NM
            ,AA.CONTRACT_NO
            ,TO_CHAR(AA.CONTRACT_START_DT,'YYYYMMDD') AS CONTRACT_START_DT
            ,AA.BP_TP
            ,AA.SUNG_CD
            ,AA.SUNG_NM
            ,AA.DIST_CD
            ,AA.DIST_NM
            ,AA.OWN_RGST_NM
            ,AA.CRN_NO
            ,AA.DEAL_CURR_UNIT_CD
            ,AA.COF_DT
            ,AA.ADDR
            ,AA.ZIP_CD
            ,AA.HOMEPAGE_URL
            ,AA.TEL_NO
            ,AA.FAX_NO
            ,NVL((select AB.PRSN_NM AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
            AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
            MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
            AC.BP_CD = AA.BP_CD)),' ') AS PRSN_NM
            ,NVL((select AB.PRSN_HP_NO AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
            AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
            MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
            AC.BP_CD = AA.BP_CD)),' ') AS PRSN_HP_NO
            ,NVL((select AB.PRSN_TEL_NO AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD =
            AA.DLR_CD AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
            MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
            AC.BP_CD = AA.BP_CD)),' ') AS PRSN_TEL_NO
        FROM PT_0211T AA
        <where>
            <if test='sDlrCd != null and sDlrCd != ""'>
                AND AA.DLR_CD = #{sDlrCd}
            </if>
            <if test='sBpCd != null and sBpCd != ""'>
                AND AA.BP_CD LIKE '%'||#{sBpCd}||'%'
            </if>
            <if test='sBpNm != null and sBpNm != ""'>
                AND AA.BP_NM LIKE '%'||#{sBpNm}||'%'
            </if>
            <if test='sBpTp != null and sBpTp != ""'>
                AND AA.BP_TP = #{sBpTp}
            </if>
            <if test='sBpTpLst  != null and !sBpTpLst.isEmpty'>
                AND AA.BP_TP IN
                <foreach item="item" index="index" collection="sBpTpLst"
                    open="(" separator="," close=")">
                    #{item}
            </foreach>
            </if>
            <if test='sBpDstinCd != null and sBpDstinCd != ""'>
                AND AA.BP_DSTIN_CD = #{sBpDstinCd}
            </if>
            <if test='sEndYn != null and sEndYn != ""'>
                AND AA.END_YN = #{sEndYn}
            </if>

            AND END_YN != 'Y'

        </where>
        ORDER BY
        <choose>
            <when test='sort != null'>
                <foreach item="item" index="index" collection="sort"
                    open="" separator="," close="">
                    <choose>
                        <when test='item.field == "bpCd"'>
                            AA.BP_CD
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AA.DLR_CD ASC
                        </otherwise>
                    </choose>
                </foreach>
            </when>
            <otherwise>
                AA.DLR_CD ASC
            </otherwise>
        </choose>
    </select>

    <!-- 거래처 정보 목록을 조회한다. -->
    <select id="selectVenderMastersByCondition" parameterType="VenderMasterSearchVO"
        resultType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectVenderMastersByCondition]
        */
        SELECT * FROM (
        SELECT ROWNUM AS RNUM, T1.* FROM (
        SELECT
        AA.DLR_CD
        ,AA.BP_CD
        ,AA.BP_NM
        ,AA.CONTRACT_NO
        ,AA.CONTRACT_START_DT
        ,AA.CONTRACT_END_DT
        ,AA.BP_FULL_NM
        ,AA.BP_EN_NM
        ,AA.BP_TP
        ,AA.CNTRY_CD
        ,AA.DIST_CD
        ,AA.DIST_NM
        ,AA.OWN_RGST_NM
        ,AA.CRN_NO
        ,AA.DEAL_CURR_UNIT_CD
        ,AA.COF_DT
        ,AA.ZIP_CD
        ,AA.ADDR
        ,AA.HOMEPAGE_URL
        ,AA.TEL_NO
        ,AA.FAX_NO
        ,NVL((select AB.PRSN_NM AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
        AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
        MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
        AC.BP_CD = AA.BP_CD)),' ') AS PRSN_NM
        ,NVL((select AB.SEX_CD AS SEX_CD from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD AND
        AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT MIN(AC.LINE_NO)
        FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND AC.BP_CD =
        AA.BP_CD)),' ') AS SEX_CD
        ,NVL((select AB.PRSN_HP_NO AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
        AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
        MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
        AC.BP_CD = AA.BP_CD)),' ') AS PRSN_HP_NO
        ,NVL((select AB.PRSN_TEL_NO AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD =
        AA.DLR_CD AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
        MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
        AC.BP_CD = AA.BP_CD)),' ') AS PRSN_TEL_NO
        ,NVL(
        (
            select AB.PRSN_EMAIL_NM AS PRSN_NM from PT_0215T AB
            WHERE AB.DLR_CD = AA.DLR_CD AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (
                SELECT MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND AC.BP_CD = AA.BP_CD
            )
        )
        ,' ') AS PRSN_EMAIL_NM
        ,NVL(
         (
            select AB.PRSN_FAX_NO AS PRSN_NM from PT_0215T AB
            WHERE AB.DLR_CD = AA.DLR_CD AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (
                SELECT MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND AC.BP_CD = AA.BP_CD
            )
        )
        ,' ') AS PRSN_FAX_NO
        ,AA.PAY_TP
        ,AA.PAY_TERM_CD
        ,AA.BANK_NM
        ,AA.BANK_AC_NO
        ,AA.BANK_CARD_NO
        ,AC_OWNER_NM
        ,AA.END_YN
        ,AA.REMARK
        ,AA.REG_USR_ID
        ,AA.REG_DT
        ,AA.UPDT_USR_ID
        ,AA.UPDT_DT
        ,AA.SUNG_CD
        ,AA.SUNG_NM
        ,AA.DC_RATE
        ,AA.PRC_TP
        ,AA.TAX_RATE
        ,AA.BP_DSTIN_CD
        FROM PT_0211T AA
        <where>
            <if test='sDlrCd != null and sDlrCd != ""'>
                AND AA.DLR_CD = #{sDlrCd}
                    </if>
            <if test='sBpCd != null and sBpCd != ""'>
                AND AA.BP_CD LIKE '%'||#{sBpCd}||'%'
                    </if>
            <if test='sBpNm != null and sBpNm != ""'>
                AND AA.BP_NM LIKE '%'||#{sBpNm}||'%'
                    </if>
            <if test='sBpFullNm != null and sBpFullNm != ""'>
                AND AA.BP_FULL_NM LIKE '%'||#{sBpFullNm}||'%'
                    </if>
            <if test='sBpTp != null and sBpTp != ""'>
                AND AA.BP_TP = #{sBpTp}
                    </if>
            <if test='sBpTpLst  != null and !sBpTpLst.isEmpty'>
                AND AA.BP_TP IN
                <foreach item="item" index="index" collection="sBpTpLst"
                    open="(" separator="," close=")">
                    #{item}
                    </foreach>
            </if>
            <if test='sBpDstinCd != null and sBpDstinCd != ""'>
                AND AA.BP_DSTIN_CD = #{sBpDstinCd}
                    </if>
            AND AA.END_YN != 'Y'
        </where>
        ORDER BY
        <choose>
            <when test='sort != null'>
                <foreach item="item" index="index" collection="sort"
                    open="" separator="," close="">
                    <choose>
                        <when test='item.field == "bpCd"'>
                            AA.BP_CD
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bpTp"'>
                            AA.BP_TP
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bpNm"'>
                            AA.BP_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bpFullNm"'>
                            AA.BP_FULL_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "contractNo"'>
                            AA.CONTRACT_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "contractStartDt"'>
                            AA.CONTRACT_START_DT
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "contractEndDt"'>
                            AA.CONTRACT_END_DT
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "crnNo"'>
                            AA.CRN_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "ownRgstNm"'>
                            AA.OWN_RGST_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnNm"'>
                            AA.PRSN_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>

                        <when test='item.field == "prsnTelNo"'>
                            AA.PRSN_TEL_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnHpNo"'>
                            AA.PRSN_HP_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnEmailNm"'>
                            AA.PRSN_EMAIL_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>

                        <when test='item.field == "addr"'>
                            AA.ADDR
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "payTp"'>
                            AA.PAY_TP
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "payTermCd"'>
                            AA.PAY_TERM_CD
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bankNm"'>
                            AA.BANK_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bankAcNo"'>
                            AA.BANK_AC_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "acOwnerNm"'>
                            AA.AC_OWNER_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bankCardNo"'>
                            AA.BANK_CARD_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "taxRate"'>
                            AA.TAX_RATE
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "dcRate"'>
                            AA.DC_RATE
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AA.DLR_CD ASC
                                </otherwise>
                    </choose>
                </foreach>
            </when>
            <otherwise>
                AA.DLR_CD ASC
                    </otherwise>
        </choose>
        ) T1
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                ROWNUM <![CDATA[<=]]>
                #{lastIndex}
            </if>
        </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- 거래처 정보 카운트를 조회한다. -->
    <select id="selectVenderMastersByConditionCnt" parameterType="VenderMasterSearchVO"
        resultType="int">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectVenderMastersByConditionCnt]
        */
        SELECT count(*) FROM PT_0211T
        <where>
            <if test='sDlrCd != null and sDlrCd != ""'>
                AND DLR_CD = #{sDlrCd}
            </if>
            <if test='sBpCd != null and sBpCd != ""'>
                AND BP_CD LIKE '%'||#{sBpCd}||'%'
            </if>
            <if test='sBpNm != null and sBpNm != ""'>
                AND BP_NM LIKE '%'||#{sBpNm}||'%'
            </if>
            <if test='sBpFullNm != null and sBpFullNm != ""'>
                AND BP_FULL_NM LIKE '%'||#{sBpFullNm}||'%'
            </if>
            <if test='sBpTp != null and sBpTp != ""'>
                AND BP_TP = #{sBpTp}
            </if>
            <if test='sBpTpLst != null and !sBpTpLst.isEmpty'>
                AND BP_TP IN
                <foreach item="item" index="index" collection="sBpTpLst"
                    open="(" separator="," close=")">
                    #{item}
            </foreach>
            </if>
            <if test='sBpDstinCd != null and sBpDstinCd != ""'>
                AND BP_DSTIN_CD = #{sBpDstinCd}
            </if>
            AND END_YN != 'Y'
        </where>
    </select>

    <!-- 거래처 정보 목록을 조회한다. -->
    <select id="selectAllVenderMastersByCondition" parameterType="VenderMasterSearchVO"
        resultType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectAllVenderMastersByCondition]
        */
        SELECT * FROM (
        SELECT ROWNUM AS RNUM, T1.* FROM (
        SELECT
        AA.DLR_CD
        ,AA.BP_CD
        ,AA.BP_NM
        ,AA.CONTRACT_NO
        ,AA.CONTRACT_START_DT
        ,AA.CONTRACT_END_DT
        ,AA.BP_FULL_NM
        ,AA.BP_EN_NM
        ,AA.BP_TP
        ,AA.CNTRY_CD
        ,AA.DIST_CD
        ,AA.DIST_NM
        ,AA.OWN_RGST_NM
        ,AA.CRN_NO
        ,AA.DEAL_CURR_UNIT_CD
        ,AA.COF_DT
        ,AA.ZIP_CD
        ,AA.ADDR
        ,AA.HOMEPAGE_URL
        ,AA.TEL_NO
        ,AA.FAX_NO
        ,NVL((select AB.PRSN_NM AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
        AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
        MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
        AC.BP_CD = AA.BP_CD)),' ') AS PRSN_NM
        ,NVL((select AB.SEX_CD AS SEX_CD from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD AND
        AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT MIN(AC.LINE_NO)
        FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND AC.BP_CD =
        AA.BP_CD)),' ') AS SEX_CD
        ,NVL((select AB.PRSN_HP_NO AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD = AA.DLR_CD
        AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
        MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
        AC.BP_CD = AA.BP_CD)),' ') AS PRSN_HP_NO
        ,NVL((select AB.PRSN_TEL_NO AS PRSN_NM from PT_0215T AB WHERE AB.DLR_CD =
        AA.DLR_CD AND AB.BP_CD = AA.BP_CD AND AB.LINE_NO IN (SELECT
        MIN(AC.LINE_NO) FROM PT_0215T AC WHERE AC.DLR_CD = AA.DLR_CD AND
        AC.BP_CD = AA.BP_CD)),' ') AS PRSN_TEL_NO
        ,AA.PRSN_EMAIL_NM
        ,AA.PAY_TP
        ,AA.PAY_TERM_CD
        ,AA.BANK_NM
        ,AA.BANK_AC_NO
        ,AA.BANK_CARD_NO
        ,AC_OWNER_NM
        ,AA.END_YN
        ,AA.REMARK
        ,AA.REG_USR_ID
        ,AA.REG_DT
        ,AA.UPDT_USR_ID
        ,AA.UPDT_DT
        ,AA.SUNG_CD
        ,AA.SUNG_NM
        ,AA.DC_RATE
        ,AA.PRC_TP
        ,AA.TAX_RATE
        ,AA.BP_DSTIN_CD
        FROM PT_0211T AA
        <where>
            <if test='sDlrCd != null and sDlrCd != ""'>
                AND AA.DLR_CD = #{sDlrCd}
                    </if>
            <if test='sBpCd != null and sBpCd != ""'>
                AND AA.BP_CD = #{sBpCd}
                    </if>
            <if test='sBpNm != null and sBpNm != ""'>
                AND AA.BP_NM LIKE '%'||#{sBpNm}||'%'
                    </if>
            <if test='sBpFullNm != null and sBpFullNm != ""'>
                AND AA.BP_FULL_NM LIKE '%'||#{sBpFullNm}||'%'
                    </if>
            <if test='sBpTp != null and sBpTp != ""'>
                AND AA.BP_TP = #{sBpTp}
                    </if>
            <if test='sBpTpLst  != null and !sBpTpLst.isEmpty'>
                AND AA.BP_TP IN
                <foreach item="item" index="index" collection="sBpTpLst"
                    open="(" separator="," close=")">
                    #{item}
                    </foreach>
            </if>
            AND AA.END_YN != 'Y'
        </where>
        ORDER BY
        <choose>
            <when test='sort != null'>
                <foreach item="item" index="index" collection="sort"
                    open="" separator="," close="">
                    <choose>
                        <when test='item.field == "bpCd"'>
                            AA.BP_CD
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bpTp"'>
                            AA.BP_TP
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bpNm"'>
                            AA.BP_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bpFullNm"'>
                            AA.BP_FULL_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "contractNo"'>
                            AA.CONTRACT_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "contractStartDt"'>
                            AA.CONTRACT_START_DT
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "contractEndDt"'>
                            AA.CONTRACT_END_DT
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "crnNo"'>
                            AA.CRN_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "ownRgstNm"'>
                            AA.OWN_RGST_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnNm"'>
                            AA.PRSN_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "sexCd"'>
                            AA.SEX_CD
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnTelNo"'>
                            AA.PRSN_TEL_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnHpNo"'>
                            AA.PRSN_HP_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnEmailNm"'>
                            AA.PRSN_EMAIL_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "prsnFaxNo"'>
                            AA.PRSN_FAX_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "addr"'>
                            AA.ADDR
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "payTp"'>
                            AA.PAY_TP
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "payTermCd"'>
                            AA.PAY_TERM_CD
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bankNm"'>
                            AA.BANK_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bankAcNo"'>
                            AA.BANK_AC_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "acOwnerNm"'>
                            AA.AC_OWNER_NM
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "bankCardNo"'>
                            AA.BANK_CARD_NO
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "taxRate"'>
                            AA.TAX_RATE
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <when test='item.field == "dcRate"'>
                            AA.DC_RATE
                            <choose>
                                <when test='item.dir == "asc"'>ASC</when>
                                <otherwise>DESC</otherwise>
                            </choose>
                        </when>
                        <otherwise>
                            AA.DLR_CD ASC
                                </otherwise>
                    </choose>
                </foreach>
            </when>
            <otherwise>
                AA.DLR_CD ASC
                    </otherwise>
        </choose>
        ) T1
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                ROWNUM <![CDATA[<=]]>
                #{lastIndex}
            </if>
        </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUM > #{firstIndex}
            </if>
        </where>
    </select>

    <!-- 거래처 정보 카운트를 조회한다. -->
    <select id="selectAllVenderMastersByConditionCnt"
        parameterType="VenderMasterSearchVO" resultType="int">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectAllVenderMastersByConditionCnt]
        */
        SELECT count(*) FROM PT_0211T
        <where>
            <if test='sDlrCd != null and sDlrCd != ""'>
                AND DLR_CD = #{sDlrCd}
            </if>
            <if test='sBpCd != null and sBpCd != ""'>
                AND BP_CD = #{sBpCd}
            </if>
            <if test='sBpNm != null and sBpNm != ""'>
                AND BP_NM LIKE '%'||#{sBpNm}||'%'
            </if>
            <if test='sBpFullNm != null and sBpFullNm != ""'>
                AND BP_FULL_NM LIKE '%'||#{sBpFullNm}||'%'
            </if>
            <if test='sBpTp != null and sBpTp != ""'>
                AND BP_TP = #{sBpTp}
            </if>
            <if test='sBpTpLst != null and !sBpTpLst.isEmpty'>
                AND BP_TP IN
                <foreach item="item" index="index" collection="sBpTpLst"
                    open="(" separator="," close=")">
                    #{item}
            </foreach>
            </if>
            AND END_YN != 'Y'
        </where>
    </select>

    <!-- BHMC에 해당하는 거래처 정보를 조회한다. -->
    <select id="selectBHMCVenderMaster" parameterType="map"
        resultType="VenderMasterVO">
        /*
        [chn.bhmc.dms.par.pmm.service.dao.VenderMasterDAO.selectBHMCVenderMaster]
        */
        SELECT
        A.DLR_CD --딜러코드
        ,A.BP_CD --거래처코드
        ,A.BP_NM --거래처명
        ,A.CONTRACT_NO --계약서번호
        ,A.CONTRACT_START_DT --계약서유효시작일자
        ,A.CONTRACT_END_DT --계약서유효종료일자
        ,A.BP_FULL_NM --거래처전체명
        ,A.BP_EN_NM --거래처영문명
        ,A.BP_TP --거래처유형
        ,A.CNTRY_CD --국가코드
        ,A.DIST_CD --구현코드
        ,A.DIST_NM --구현명
        ,A.OWN_RGST_NM --대표자명
        ,A.CRN_NO --사업자등록번호
        ,A.DEAL_CURR_UNIT_CD --거래화폐단위코드
        ,A.COF_DT --창립기념일자
        ,A.ZIP_CD --우편번호
        ,A.ADDR --주소
        ,A.HOMEPAGE_URL --홈페이지URL
        ,A.TEL_NO --전화번호
        ,A.FAX_NO --팩스번호
        ,A.PRSN_NM --담당자명
        ,A.PRSN_TEL_NO --담당자전화번호
        ,A.PRSN_HP_NO --담당자휴대폰번호
        ,A.PRSN_EMAIL_NM --담당자이메일명
        ,A.PAY_TP --지불유형
        ,A.PAY_TERM_CD --지불조건코드
        ,A.BANK_NM --은행명
        ,A.BANK_AC_NO --은행계좌번호
        ,A.BANK_CARD_NO --은행카드번호
        ,A.AC_OWNER_NM --예금주명
        ,A.END_YN --종료여부
        ,A.REMARK --비고
        FROM PT_0211T A
        WHERE A.DLR_CD = #{dlrCd}
        AND A.BP_TP = '01'
        AND
        A.END_YN = 'N'
        AND ROWNUM = 1
    </select>

</mapper>