<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20170720" releaseVersion="9.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="sStartYyMmDd"/>
<O>
<![CDATA[20171101]]></O>
</Parameter>
<Parameter>
<Attributes name="sCarlineCd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sEndYyMmDd"/>
<O>
<![CDATA[20171116]]></O>
</Parameter>
<Parameter>
<Attributes name="sFosterTp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sStartDt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sDlrCd"/>
<O>
<![CDATA[D0119]]></O>
</Parameter>
<Parameter>
<Attributes name="sDlrRoTp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sSaNm"/>
<O>
<![CDATA[武建营]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[BHDMS]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
SELECT COLUMN_SEQ
       ,COLUMN_NM
       ,NVL(RO01, 0) AS RO01
       ,NVL(RO02, 0) AS RO02
       ,NVL(RO03, 0) AS RO03
       ,NVL(RO04, 0) AS RO04
       ,NVL(RO05, 0) AS RO05
FROM (
    SELECT RO_TP, COLUMN_SEQ, COLUMN_NM, COLUMN_VAL, VAL_TYPE
    FROM (
        WITH T1 AS (
            SELECT * FROM (
                SELECT CA.DLR_CD
                       ,CA.VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = CA.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,(SELECT SUM(NVL(PAYM_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS PAYM_AMT
                       --,(SELECT SUM(NVL(WON_UNIT_CUT_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS WON_UNIT_CUT_AMT
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL((SELECT SUM(NVL(WON_UNIT_CUT_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO),0)
                                ELSE NVL((SELECT SUM(NVL(WON_UNIT_CUT_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO),0) END AS WON_UNIT_CUT_AMT   --结算取整金额 
                       --,(SELECT SUM(NVL(DEMIC_POINT_CUT_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS DEMIC_POINT_CUT_AMT
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL((SELECT SUM(NVL(DEMIC_POINT_CUT_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO),0)
                                ELSE NVL((SELECT SUM(NVL(DEMIC_POINT_CUT_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO),0) END AS DEMIC_POINT_CUT_AMT   --结算去零金额 
                       ,CA.RO_DOC_NO
                       ,CA.RO_TP
                       ,CA.CALC_DOC_NO
                       ,CA.CALC_STAT_CD
                       ,CA.CALC_DT
                       ,CA.SER_PAR_DSTIN_CD
                       --,NVL(CA.LBR_CALC_AMT        ,0) AS LBR_CALC_AMT            --공임정산금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LBR_CALC_AMT,0)
                                ELSE NVL(CA.LBR_CALC_AMT,0) END AS LBR_CALC_AMT   --工时-结算金额
                       ,NVL(CA.LBR_DC_RATE         ,0) AS LBR_DC_RATE             --공임할인율
                       --,NVL(CA.LBR_DC_AMT          ,0) AS LBR_DC_AMT              --공임할인금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LBR_DC_AMT,0)
                                ELSE NVL(CA.LBR_DC_AMT,0) END AS LBR_DC_AMT   --工时-优惠金额 
                       --,NVL(CA.LBR_BM_POINT_USE_AMT,0) AS LBR_BM_POINT_USE_AMT    --공임BM포인트사용금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LBR_BM_POINT_USE_AMT,0)
                                ELSE NVL(CA.LBR_BM_POINT_USE_AMT,0) END AS LBR_BM_POINT_USE_AMT   --工时-蓝缤积分使用金额
                      -- ,NVL(CA.LBR_BM_CUPN_USE_AMT ,0) AS LBR_BM_CUPN_USE_AMT     --공임BM쿠폰사용금액
                        ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LBR_BM_CUPN_USE_AMT,0)
                                ELSE NVL(CA.LBR_BM_CUPN_USE_AMT,0) END AS LBR_BM_CUPN_USE_AMT   --工时-蓝缤其他优惠金额
                       --,NVL(CA.LBR_POINT_USE_AMT   ,0) AS LBR_POINT_USE_AMT       --공임포인트사용금액
                         ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LBR_POINT_USE_AMT,0)
                                ELSE NVL(CA.LBR_POINT_USE_AMT,0) END AS LBR_POINT_USE_AMT   --工时-积分使用金额 
                       --,NVL(CA.LBR_ETC_DC_AMT      ,0) AS LBR_ETC_DC_AMT          --공임기타할인금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LBR_ETC_DC_AMT,0)
                                ELSE NVL(CA.LBR_ETC_DC_AMT,0) END AS LBR_ETC_DC_AMT   --工时-其他优惠金额 
                       --,NVL(CA.LBR_CALC_SUM_AMT    ,0) AS LBR_CALC_SUM_AMT        --공임정산합계금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LBR_CALC_SUM_AMT,0)
                                ELSE NVL(CA.LBR_CALC_SUM_AMT,0) END AS LBR_CALC_SUM_AMT   --工时-最终结算金额
                       --,NVL(CA.PAR_CALC_AMT        ,0) AS PAR_CALC_AMT            --부품정산금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.PAR_CALC_AMT,0)
                                ELSE NVL(CA.PAR_CALC_AMT,0) END AS PAR_CALC_AMT   --配件-结算金额 
                       ,NVL(CA.PAR_DC_RATE         ,0) AS PAR_DC_RATE             --부품할인율
                       --,NVL(CA.PAR_DC_AMT          ,0) AS PAR_DC_AMT              --부품할인금액
                        ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.PAR_DC_AMT,0)
                                ELSE NVL(CA.PAR_DC_AMT,0) END AS PAR_DC_AMT   --配件-优惠金额 
                       --,NVL(CA.PAR_BM_POINT_USE_AMT,0) AS PAR_BM_POINT_USE_AMT    --부품BM포인트사용금액
                        ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.PAR_BM_POINT_USE_AMT,0)
                                ELSE NVL(CA.PAR_BM_POINT_USE_AMT,0) END AS PAR_BM_POINT_USE_AMT   --配件-蓝缤积分使用金额 
                       --,NVL(CA.PAR_BM_CUPN_USE_AMT ,0) AS PAR_BM_CUPN_USE_AMT     --부품BM쿠폰사용금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.PAR_BM_CUPN_USE_AMT,0)
                                ELSE NVL(CA.PAR_BM_CUPN_USE_AMT,0) END AS PAR_BM_CUPN_USE_AMT   --配件-蓝缤其他优惠金额
                       --,NVL(CA.PAR_POINT_USE_AMT   ,0) AS PAR_POINT_USE_AMT       --부품포인트사용금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.PAR_POINT_USE_AMT,0)
                                ELSE NVL(CA.PAR_POINT_USE_AMT,0) END AS PAR_POINT_USE_AMT   --配件-积分使用金额
                       --,NVL(CA.PAR_ETC_DC_AMT      ,0) AS PAR_ETC_DC_AMT          --부품기타할인금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.PAR_ETC_DC_AMT,0)
                                ELSE NVL(CA.PAR_ETC_DC_AMT,0) END AS PAR_ETC_DC_AMT   --配件-其他优惠金额
                       --,NVL(CA.PAR_CALC_SUM_AMT    ,0) AS PAR_CALC_SUM_AMT        --부품정산합계금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.PAR_CALC_SUM_AMT,0)
                                ELSE NVL(CA.PAR_CALC_SUM_AMT,0) END AS PAR_CALC_SUM_AMT   --配件-最终结算金额
                       ,NVL(CA.ETC_CALC_AMT        ,0) AS ETC_CALC_AMT            --기타정산금액
                       ,NVL(CA.ETC_DC_RATE         ,0) AS ETC_DC_RATE             --기타할인율
                       ,NVL(CA.ETC_DC_AMT          ,0) AS ETC_DC_AMT              --기타할인금액
                       ,NVL(CA.ETC_BM_POINT_USE_AMT,0) AS ETC_BM_POINT_USE_AMT    --기타BM포인트사용금액
                       ,NVL(CA.ETC_BM_CUPN_USE_AMT ,0) AS ETC_BM_CUPN_USE_AMT     --기타BM쿠폰사용금액
                       ,NVL(CA.ETC_POINT_USE_AMT   ,0) AS ETC_POINT_USE_AMT       --기타포인트사용금액
                       ,NVL(CA.ETC_OTHER_DC_AMT    ,0) AS ETC_OTHER_DC_AMT        --기타다른할인금액
                       --,NVL(CA.ETC_CALC_SUM_AMT    ,0) AS ETC_CALC_SUM_AMT        --기타정산합계금액
                       ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.ETC_CALC_SUM_AMT,0)
                                ELSE NVL(CA.ETC_CALC_SUM_AMT,0) END AS ETC_CALC_SUM_AMT   --其它-最终结算金额 
                       ,NVL(CA.CALC_TOT_AMT        ,0) AS CALC_TOT_AMT            --정산총금액
                       ,NVL(CA.DC_TOT_RATE         ,0) AS DC_TOT_RATE             --할인총율
                       ,NVL(CA.DC_TOT_AMT          ,0) AS DC_TOT_AMT              --할인총금액
                       ,CASE WHEN (PAR_BM_POINT_USE_AMT <=0 AND LBR_BM_POINT_USE_AMT <=0)
                             THEN BM_POINT_TOT_AMT ELSE 0 END AS BM_POINT_TOT_AMT       --BM포인트총금액
                       ,CASE WHEN (PAR_BM_CUPN_USE_AMT <=0 AND LBR_BM_CUPN_USE_AMT <=0)
                             THEN BM_CUPN_TOT_AMT ELSE 0 END AS BM_CUPN_TOT_AMT         --BM쿠폰총금액
                       ,CASE WHEN (PAR_POINT_USE_AMT <=0 AND LBR_POINT_USE_AMT <=0)
                             THEN POINT_TOT_AMT ELSE 0 END AS POINT_TOT_AMT             --포인트총금액
                       ,CASE WHEN (PAR_ETC_DC_AMT <=0 AND LBR_ETC_DC_AMT <=0)
                             THEN ETC_TOT_AMT ELSE 0 END AS ETC_TOT_AMT                 --포인트총금액
                       --,NVL(CA.LAST_CALC_TOT_AMT   ,0) AS LAST_CALC_TOT_AMT       --최종정산총금액
                        ,CASE WHEN CA.CALC_STAT_CD = '07'
                                THEN -1 * NVL(CA.LAST_CALC_TOT_AMT,0)
                                ELSE NVL(CA.LAST_CALC_TOT_AMT,0) END AS LAST_CALC_TOT_AMT --最终结算金额
                       ,TO_CHAR(CALC_DT,'MM') AS MM
                       ,CASE WHEN TO_CHAR(CALC_DT,'MM') = TO_CHAR(SYSDATE, 'MM')
                             THEN TO_NUMBER(TO_CHAR(SYSDATE, 'DD'))
                             ELSE TO_NUMBER(TO_CHAR(LAST_DAY(CALC_DT), 'DD')) END AS LDATE
                       ,(SELECT DLR_RO_TP FROM SE_0300T WHERE DLR_CD = CA.DLR_CD AND RO_DOC_NO = CA.RO_DOC_NO) AS DLR_RO_TP
                 /** FROM SE_0500T CA
                WHERE CA.DLR_CD = '${sDlrCd}'
                AND CA.CALC_CANC_YN = 'N'
                AND CA.CALC_STAT_CD = '00'
                 **/
                  FROM SE_0500T CA, SE_0300T B
                              WHERE CA.DLR_CD    = B.DLR_CD
                                AND CA.RO_DOC_NO = B.RO_DOC_NO
                                AND CA.RO_TP     = B.RO_TP
                                AND CA.DLR_CD    =  '${sDlrCd}'
                                 -- AND A.CALC_DT  >=  '2018-10-05'
                                -- AND A.CALC_DT  <  '2018-10-13'
                            AND CA.VIN_NO IS NOT NULL
                                    AND CA.CALC_STAT_CD NOT IN ('03', '04')
                AND TO_CHAR(CA.CALC_DT,'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(CA.RO_TP, 'NONE')='" + sFosterTp + "'")}    --위탁유형
                ${IF(LEN(sSaNm) <= 0,""," AND NVL(CA.CALC_COMP_USR_NM, 'NONE')='" + sSaNm + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
        )
        SELECT 1 AS COLUMN_SEQ, '接车检查台数' AS COLUMN_NM, COUNT(DISTINCT(VIN_NO)) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT *
            FROM (
                SELECT PRE.DLR_CD
                       ,PRE.DIAG_DOC_NO
                       ,PRE.VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = PRE.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                      ,PRE.REG_USR_ID AS SA_ID
                      ,TO_CHAR(PRE_CHK_DT, 'MM') AS MM
                      ,'01' AS RO_TP
                      ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = PRE.REG_USR_ID AND USR_ID = PRE.REG_USR_ID) AS SA_NM
                FROM SE_0200T PRE
                WHERE DLR_CD = '${sDlrCd}'
                AND DIAG_STAT_CD != 'C'
                AND TO_CHAR(PRE_CHK_DT, 'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
            )
             WHERE 1=1
             ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
             ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --사전점검대수(사전점검문서 발행 차량수량(취소한 사전점검문서 미포함))
        UNION ALL
        SELECT 1 AS COLUMN_SEQ , '接车检查台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 2 AS COLUMN_SEQ, '接车检查台次' AS COLUMN_NM, COUNT(DIAG_DOC_NO) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT *
            FROM (
                SELECT PRE.DLR_CD
                        ,PRE.DIAG_DOC_NO
                        ,PRE.VIN_NO
                        ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = PRE.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                        ,TO_CHAR(PRE_CHK_DT, 'MM') AS MM
                        ,'01' AS RO_TP
                        ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = PRE.REG_USR_ID AND USR_ID = PRE.REG_USR_ID) AS SA_NM
                FROM SE_0200T PRE
                WHERE DLR_CD = '${sDlrCd}'
                AND DIAG_STAT_CD != 'C'
                AND TO_CHAR(PRE_CHK_DT, 'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
            )
             WHERE 1=1
             ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
             ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --사전점검대차(사전점검문서 발행 수량(취소한 사전점검문서 미포함))
        UNION ALL
        SELECT 2 AS COLUMN_SEQ , '接车检查台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 3 AS COLUMN_SEQ, '维修委托台数' AS COLUMN_NM, COUNT(DISTINCT(VIN_NO)) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT DLR_CD
                       ,RO_DOC_NO
                       ,VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                AND RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --정비위탁대수(RO 발행 차량수량(취소한 RO 미포함))
        UNION ALL
        SELECT 3 AS COLUMN_SEQ , '维修委托台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 4 AS COLUMN_SEQ, '维修委托台次' AS COLUMN_NM, COUNT(RO_DOC_NO) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT DLR_CD
                       ,RO_DOC_NO
                       ,VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                AND RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --정비위탁대차(RO 발행 수량(취소한 RO 미포함))
        UNION ALL
        SELECT 4 AS COLUMN_SEQ , '维修委托台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 5 AS COLUMN_SEQ, '取消委托台数' AS COLUMN_NM, COUNT(DISTINCT(VIN_NO)) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT DLR_CD
                       ,RO_DOC_NO
                       ,VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                AND RO_STAT_CD = '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --위탁취소대수(RO 취소 차량수량)
        UNION ALL
        SELECT 5 AS COLUMN_SEQ , '取消委托台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 6 AS COLUMN_SEQ, '取消委托台次' AS COLUMN_NM, COUNT(RO_DOC_NO) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT DLR_CD
                       ,RO_DOC_NO
                       ,VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                AND RO_STAT_CD = '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --위탁취소대수(RO 취소 수량)
        UNION ALL
        SELECT 6 AS COLUMN_SEQ , '取消委托台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL
        /** 结算完成台数、结算完成台次、付款完成台数、付款完成台次列隐藏
        UNION ALL

        SELECT 7 AS COLUMN_SEQ, '    结算完成台数' AS COLUMN_NM, COUNT(DISTINCT(VIN_NO)) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT *
            FROM (
                SELECT VIN_NO
                       ,TO_CHAR(RO_DT, 'MM') AS MM
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND RO_STAT_CD = '00'
                AND TO_CHAR(RO_DT,'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}   --위탁유형
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --정산완료대수(정비위탁대수 중, 정산완료 상태의 RO 차량수량)
        UNION ALL
        SELECT 7 AS COLUMN_SEQ , '    结算完成台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 8 AS COLUMN_SEQ, '    结算完成台次' AS COLUMN_NM, COUNT(RO_DOC_NO) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT *
            FROM (
                SELECT VIN_NO
                       ,RO_DOC_NO
                       ,TO_CHAR(RO_DT, 'MM') AS MM
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND RO_STAT_CD = '00'
                AND TO_CHAR(RO_DT,'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}   --위탁유형
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --정산완료대차(정비위탁대차 중, 정산완료 상태의 RO 수량)
        UNION ALL
        SELECT 8 AS COLUMN_SEQ , '    结算完成台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 9 AS COLUMN_SEQ, '    付款完成台数' AS COLUMN_NM, COUNT(DISTINCT(VIN_NO)) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT *
            FROM (
                SELECT RO.VIN_NO
                       ,TO_CHAR(RO.RO_DT, 'MM') AS MM
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,RO.RO_TP
                       ,RO.DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO INNER JOIN SE_0550T RCV
                ON RO.DLR_CD = RCV.DLR_CD
                AND RO.RO_DOC_NO = RCV.RO_DOC_NO
                WHERE RO.DLR_CD = '${sDlrCd}'
                AND RO.RO_STAT_CD != '06'
                AND RCV.RCV_STAT_CD = 'F'
                AND TO_CHAR(RO.RO_DT,'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO.RO_TP, 'NONE')='" + sFosterTp + "'")}   --위탁유형
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --지불완료대수(정비위탁대수 중, 지불완료 상태의 RO 차량수량)
        UNION ALL
        SELECT 9 AS COLUMN_SEQ , '    付款完成台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 10 AS COLUMN_SEQ, '    付款完成台次' AS COLUMN_NM, COUNT(RO_DOC_NO) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT *
            FROM (
                SELECT RO.VIN_NO
                       ,RO.RO_DOC_NO
                       ,TO_CHAR(RO_DT, 'MM') AS MM
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,RO.RO_TP
                       ,RO.DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO INNER JOIN SE_0550T RCV
                ON RO.DLR_CD = RCV.DLR_CD
                AND RO.RO_DOC_NO = RCV.RO_DOC_NO
                WHERE RO.DLR_CD = '${sDlrCd}'
                AND RO.RO_STAT_CD != '06'
                AND RCV.RCV_STAT_CD = 'F'
                AND TO_CHAR(RO.RO_DT, 'YYYYMMDD') BETWEEN '${sStartYyMmDd}' AND '${sEndYyMmDd}'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}   --위탁유형
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --지불완료대차(정비위탁대차 중, 지불완료 상태의 RO 수량)
        UNION ALL
        SELECT 10 AS COLUMN_SEQ , '    付款完成台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL
         **/
        UNION ALL

        SELECT 11 AS COLUMN_SEQ, '服务结算台数' AS COLUMN_NM, COUNT(DISTINCT(VIN_NO)) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP     --정비정산대수(서비스정산문서 발행 및 정산완료 차량수량)
        UNION ALL
        SELECT 11 AS COLUMN_SEQ , '服务结算台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 12 AS COLUMN_SEQ, '服务结算台次' AS COLUMN_NM, COUNT(CALC_DOC_NO) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP     --정비정산대차(서비스정산문서 발행 및 정산완료 수량)
        UNION ALL
        SELECT 12 AS COLUMN_SEQ , '服务结算台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 13 AS COLUMN_SEQ , '    工时-最终结算金额' AS COLUMN_NM , SUM(NVL(LBR_CALC_SUM_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --공임-최종정산금액(정산금액-할인금액-포인트사용금액-BM포인트사용금액-기타할인금액)
        UNION ALL
        SELECT 13 AS COLUMN_SEQ , '    工时-最终结算金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 14 AS COLUMN_SEQ , '        工时-结算金额' AS COLUMN_NM , SUM(NVL(LBR_CALC_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --공임-정산금액(수리생산액 중의 공임의 정산금액)
        UNION ALL
        SELECT 14 AS COLUMN_SEQ , '        工时-结算金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 15 AS COLUMN_SEQ , '        工时-优惠金额' AS COLUMN_NM , SUM(NVL(LBR_DC_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --공임-할인금액(수리생산액 중의 공임의 할인금액)
        UNION ALL
        SELECT 15 AS COLUMN_SEQ , '        工时-优惠金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 16 AS COLUMN_SEQ , '        工时-积分使用金额' AS COLUMN_NM , SUM(NVL(LBR_POINT_USE_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --공임-포인트사용금액(수리생산액 중의 공임의 포인트사용금액)
        UNION ALL
        SELECT 16 AS COLUMN_SEQ , '        工时-积分使用金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 17 AS COLUMN_SEQ , '        工时-蓝缤积分使用金额' AS COLUMN_NM , SUM(NVL(LBR_BM_POINT_USE_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --공임-BM포인트사용금액(수리생산액 중의 공임의 BM포인트사용금액)
        UNION ALL
        SELECT 17 AS COLUMN_SEQ , '        工时-蓝缤积分使用金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 18 AS COLUMN_SEQ , '        工时-蓝缤其他优惠金额' AS COLUMN_NM , SUM(NVL(LBR_BM_CUPN_USE_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --공임-BM쿠폰사용금액(수리생산액 중의 공임의 BM쿠폰사용금액)
        UNION ALL
        SELECT 18 AS COLUMN_SEQ , '        工时-蓝缤其他优惠金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 19 AS COLUMN_SEQ , '        工时-其他优惠金额' AS COLUMN_NM , SUM(NVL(LBR_ETC_DC_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --공임-기타할인금액(수리생산액 중의 공임의 기타할인금액)
        UNION ALL
        SELECT 19 AS COLUMN_SEQ , '        工时-其他优惠金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 20 AS COLUMN_SEQ , '    配件-最终结算金额' AS COLUMN_NM , SUM(NVL(PAR_CALC_SUM_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --부품-최종정산금액(정산금액-할인금액-포인트사용금액-BM포인트사용금액-기타할인금액)
        UNION ALL
        SELECT 20 AS COLUMN_SEQ , '    配件-最终结算金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 21 AS COLUMN_SEQ , '        配件-结算金额' AS COLUMN_NM , SUM(NVL(PAR_CALC_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --부품-정산금액(수리생산액 중의 부품의 정산금액)
        UNION ALL
        SELECT 21 AS COLUMN_SEQ , '        配件-结算金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 22 AS COLUMN_SEQ , '        配件-优惠金额' AS COLUMN_NM , SUM(NVL(PAR_DC_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --부품-할인금액(수리생산액 중의 부품의 할인금액)
        UNION ALL
        SELECT 22 AS COLUMN_SEQ , '        配件-优惠金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 23 AS COLUMN_SEQ , '        配件-积分使用金额' AS COLUMN_NM , SUM(NVL(PAR_POINT_USE_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --부품-포인트사용금액(수리생산액 중의 부품의 포인트사용금액)
        UNION ALL
        SELECT 23 AS COLUMN_SEQ , '        配件-积分使用金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 24 AS COLUMN_SEQ , '        配件-蓝缤积分使用金额' AS COLUMN_NM , SUM(NVL(PAR_BM_POINT_USE_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --부품-BM포인트사용금액   (수리생산액 중의 부품의 BM포인트사용금액)
        UNION ALL
        SELECT 24 AS COLUMN_SEQ , '        配件-蓝缤积分使用金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 25 AS COLUMN_SEQ , '        配件-蓝缤其他优惠金额' AS COLUMN_NM , SUM(NVL(PAR_BM_CUPN_USE_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --부품-BM쿠폰사용금액(수리생산액 중의 부품의 BM쿠폰사용금액)
        UNION ALL
        SELECT 25 AS COLUMN_SEQ , '        配件-蓝缤其他优惠金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 26 AS COLUMN_SEQ , '        配件-其他优惠金额' AS COLUMN_NM , SUM(NVL(PAR_ETC_DC_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --부품-기타할인금액(수리생산액 중의 부품의 기타할인금액)
        UNION ALL
        SELECT 26 AS COLUMN_SEQ , '        配件-其他优惠金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 27 AS COLUMN_SEQ , '    其它-最终结算金额' AS COLUMN_NM , SUM(NVL(ETC_CALC_SUM_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --기타-최종정산금액(수리생산액 중의 기타사항의 정산금액)
        UNION ALL
        SELECT 27 AS COLUMN_SEQ , '    其它-最终结算金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 28 AS COLUMN_SEQ , '    维修费优惠金额-最终结算金额' AS COLUMN_NM , SUM(NVL(POINT_TOT_AMT + BM_POINT_TOT_AMT + ETC_TOT_AMT + BM_CUPN_TOT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --수리할인금액-최종정산금액
        UNION ALL
        SELECT 28 AS COLUMN_SEQ , '    维修费优惠金额-最终结算金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 29 AS COLUMN_SEQ , '        维修费优惠金额-积分使用' AS COLUMN_NM , SUM(NVL(POINT_TOT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --수리비 할인금액-포인트사용
        UNION ALL
        SELECT 29 AS COLUMN_SEQ , '        维修费优惠金额-积分使用' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 30 AS COLUMN_SEQ , '        维修费优惠金额-蓝缤积分使用' AS COLUMN_NM , SUM(NVL(BM_POINT_TOT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --수리비 할인금액-BM포인트사용
        UNION ALL
        SELECT 30 AS COLUMN_SEQ , '        维修费优惠金额-蓝缤积分使用' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 31 AS COLUMN_SEQ , '        维修费优惠金额-其他优惠' AS COLUMN_NM , SUM(NVL(ETC_TOT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --수리비 할인금액-기타할인
        UNION ALL
        SELECT 31 AS COLUMN_SEQ , '        维修费优惠金额-其他优惠' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 32 AS COLUMN_SEQ , '        维修费优惠金额-蓝缤其他优惠' AS COLUMN_NM , SUM(NVL(BM_CUPN_TOT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --수리비 할인금액-BM기타할인
        UNION ALL
        SELECT 32 AS COLUMN_SEQ , '        维修费优惠金额-蓝缤其他优惠' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 33 AS COLUMN_SEQ , '最终结算金额' AS COLUMN_NM , SUM(NVL(LAST_CALC_TOT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --최종정산금액
        UNION ALL
        SELECT 33 AS COLUMN_SEQ , '最终结算金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 34 AS COLUMN_SEQ , '结算取整金额' AS COLUMN_NM , SUM(NVL(WON_UNIT_CUT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP  --정산절사금액
        UNION ALL
        SELECT 34 AS COLUMN_SEQ , '结算取整金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 35 AS COLUMN_SEQ , '结算去零金额' AS COLUMN_NM , SUM(NVL(DEMIC_POINT_CUT_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP    --정산제로금액
        UNION ALL
        SELECT 35 AS COLUMN_SEQ , '结算去零金额' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 36 AS COLUMN_SEQ , '维修产值（合计）' AS COLUMN_NM , SUM(NVL(PAYM_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT CA.DLR_CD
                       ,CA.CALC_DOC_NO
                       ,CA.VIN_NO
                       ,CA.RO_TP
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = CA.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,(SELECT CASE WHEN CA.CALC_STAT_CD = '07'  THEN SUM(-1*NVL(PAYM_AMT, 0)) ELSE SUM(NVL(PAYM_AMT, 0)) END  FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS PAYM_AMT
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                       ,TO_CHAR(CA.CALC_DT,'MM') AS MM
                FROM SE_0500T CA
				INNER JOIN SE_0300T RO
				ON CA.DLR_CD = RO.DLR_CD
				AND CA.RO_DOC_NO = RO.RO_DOC_NO
				WHERE CA.DLR_CD = '${sDlrCd}'
				AND (CA.CALC_STAT_CD = '00' OR  CA.CALC_STAT_CD = '07')
				AND TO_CHAR(CA.CALC_DT,'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
				AND CA.SER_PAR_DSTIN_CD = 'SER'
				AND RO.RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO.RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(RO.DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP    --수리생산액(합계)
        UNION ALL
        SELECT 36 AS COLUMN_SEQ , '维修产值（合计）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 37 AS COLUMN_SEQ , '维修产值（非保修）' AS COLUMN_NM , SUM(NVL(PAYM_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT CA.DLR_CD
                       ,CA.CALC_DOC_NO
                       ,CA.VIN_NO
                       ,CA.RO_TP
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = CA.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,(SELECT SUM(NVL(PAYM_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS PAYM_AMT
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                       ,TO_CHAR(CA.CALC_DT,'MM') AS MM
                FROM SE_0500T CA
				INNER JOIN SE_0300T RO
				ON CA.DLR_CD = RO.DLR_CD
				AND CA.RO_DOC_NO = RO.RO_DOC_NO
				WHERE CA.DLR_CD = '${sDlrCd}'
				AND CA.CALC_CANC_YN = 'N'
				AND CA.CALC_STAT_CD = '00'
				AND TO_CHAR(CA.CALC_DT,'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
				AND CA.SER_PAR_DSTIN_CD = 'SER'
				AND RO.RO_STAT_CD != '06'
				AND RO.RO_TP != '02'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO.RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(RO.DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP    --수리생산액(비보증)
        UNION ALL
        SELECT 37 AS COLUMN_SEQ , '维修产值（非保修）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 38 AS COLUMN_SEQ , '维修产值（保修）' AS COLUMN_NM , SUM(NVL(PAYM_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT CA.DLR_CD
                       ,CA.CALC_DOC_NO
                       ,CA.VIN_NO
                       ,CA.RO_TP
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = CA.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,(SELECT SUM(NVL(PAYM_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS PAYM_AMT
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                       ,TO_CHAR(CA.CALC_DT,'MM') AS MM
                FROM SE_0500T CA
				INNER JOIN SE_0300T RO
				ON CA.DLR_CD = RO.DLR_CD
				AND CA.RO_DOC_NO = RO.RO_DOC_NO
				WHERE CA.DLR_CD = '${sDlrCd}'
				AND CA.CALC_CANC_YN = 'N'
				AND CA.CALC_STAT_CD = '00'
				AND TO_CHAR(CA.CALC_DT,'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
				AND CA.SER_PAR_DSTIN_CD = 'SER'
				AND RO.RO_STAT_CD != '06'
				AND RO.RO_TP = '02'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO.RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(RO.DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP    --수리생산액(보증)
        UNION ALL
        SELECT 38 AS COLUMN_SEQ , '维修产值（保修）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 39 AS COLUMN_SEQ , '配件成本（合计）' AS COLUMN_NM , SUM(NVL(MOVING_AVG_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT MOVING_AVG_AMT, A.RO_TP, A.DLR_CD, A.RO_DOC_NO
            FROM T1 A LEFT OUTER JOIN
            (SELECT (POS_AMT - NEG_AMT) AS MOVING_AVG_AMT, DLR_CD, RO_DOC_NO
               FROM (
                   SELECT NVL(SUM(DECODE(PAR_REQ_STAT_CD, 02, T2.MOVING_AVG_AMT)), 0) AS POS_AMT
                          , NVL(SUM(DECODE(PAR_REQ_STAT_CD, 03, ABS(T2.MOVING_AVG_AMT))), 0) AS NEG_AMT
                          , T2.DLR_CD, T2.RO_DOC_NO
                     FROM SE_0160T T1
                    INNER JOIN PT_0502T T2
                       ON T1.DLR_CD = T2.DLR_CD
                      AND T1.DOC_NO = T2.RO_DOC_NO
                      AND T1.LINE_NO = T2.RO_LINE_NO
                      AND T1.ITEM_CD = T2.ITEM_CD
                    WHERE T1.DLR_CD = '${sDlrCd}'
                      AND PREFIX_ID = 'RO'
                      AND PAR_GI_TP = 'RO'
                      GROUP BY T2.DLR_CD, T2.RO_DOC_NO
                   )
            ) F2
            ON A.DLR_CD = F2.DLR_CD
            AND A.RO_DOC_NO = F2.RO_DOC_NO
            WHERE A.SER_PAR_DSTIN_CD = 'SER'
        )
        GROUP BY RO_TP    --부품원가(합계)
        UNION ALL
        SELECT 39 AS COLUMN_SEQ , '配件成本（合计）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 40 AS COLUMN_SEQ , '维修毛利（合计）' AS COLUMN_NM , SUM(PAYM_AMT) - SUM(NVL(MOVING_AVG_AMT, 0)) COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT PAYM_AMT, 0 AS MOVING_AVG_AMT, RO_TP
            FROM T1
            WHERE SER_PAR_DSTIN_CD = 'SER'

            UNION ALL

            SELECT 0 AS PAYM_AMT, MOVING_AVG_AMT, RO_TP
            FROM (
                SELECT MOVING_AVG_AMT, A.RO_TP, A.DLR_CD, A.RO_DOC_NO
                FROM T1 A LEFT OUTER JOIN
                (SELECT (POS_AMT - NEG_AMT) AS MOVING_AVG_AMT, DLR_CD, RO_DOC_NO
                   FROM (
                       SELECT NVL(SUM(DECODE(PAR_REQ_STAT_CD, 02, T2.MOVING_AVG_AMT)), 0) AS POS_AMT
                              , NVL(SUM(DECODE(PAR_REQ_STAT_CD, 03, ABS(T2.MOVING_AVG_AMT))), 0) AS NEG_AMT
                              , T2.DLR_CD, T2.RO_DOC_NO
                         FROM SE_0160T T1
                        INNER JOIN PT_0502T T2
                           ON T1.DLR_CD = T2.DLR_CD
                          AND T1.DOC_NO = T2.RO_DOC_NO
                          AND T1.LINE_NO = T2.RO_LINE_NO
                          AND T1.ITEM_CD = T2.ITEM_CD
                        WHERE T1.DLR_CD = '${sDlrCd}'
                          AND PREFIX_ID = 'RO'
                          AND PAR_GI_TP = 'RO'
                          GROUP BY T2.DLR_CD, T2.RO_DOC_NO
                       )
                ) F2
                ON A.DLR_CD = F2.DLR_CD
                AND A.RO_DOC_NO = F2.RO_DOC_NO
                WHERE SER_PAR_DSTIN_CD = 'SER'
            )
        )
        GROUP BY RO_TP    --수리총이윤(합계)
        UNION ALL
        SELECT 40 AS COLUMN_SEQ , '维修毛利（合计）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 41 AS COLUMN_SEQ , '维修毛利率（合计）' AS COLUMN_NM
               ,ROUND(((SUM(PAYM_AMT) - SUM(NVL(MOVING_AVG_AMT, 0)))/SUM(NULLIF(PAYM_AMT, 0))), 2) COLUMN_VAL
               ,RO_TP
               ,'P' AS VAL_TYPE
        FROM (
            SELECT PAYM_AMT, 0 AS MOVING_AVG_AMT, RO_TP
            FROM T1
            WHERE SER_PAR_DSTIN_CD = 'SER'

            UNION ALL

            SELECT 0 AS PAYM_AMT, MOVING_AVG_AMT, RO_TP
            FROM (
                SELECT MOVING_AVG_AMT, A.RO_TP, A.DLR_CD, A.RO_DOC_NO
                FROM T1 A LEFT OUTER JOIN
                (SELECT (POS_AMT - NEG_AMT) AS MOVING_AVG_AMT, DLR_CD, RO_DOC_NO
                   FROM (
                       SELECT NVL(SUM(DECODE(PAR_REQ_STAT_CD, 02, T2.MOVING_AVG_AMT)), 0) AS POS_AMT
                              , NVL(SUM(DECODE(PAR_REQ_STAT_CD, 03, ABS(T2.MOVING_AVG_AMT))), 0) AS NEG_AMT
                              , T2.DLR_CD, T2.RO_DOC_NO
                         FROM SE_0160T T1
                        INNER JOIN PT_0502T T2
                           ON T1.DLR_CD = T2.DLR_CD
                          AND T1.DOC_NO = T2.RO_DOC_NO
                          AND T1.LINE_NO = T2.RO_LINE_NO
                          AND T1.ITEM_CD = T2.ITEM_CD
                        WHERE T1.DLR_CD = '${sDlrCd}'
                          AND PREFIX_ID = 'RO'
                          AND PAR_GI_TP = 'RO'
                          GROUP BY T2.DLR_CD, T2.RO_DOC_NO
                       )
                ) F2
                ON A.DLR_CD = F2.DLR_CD
                AND A.RO_DOC_NO = F2.RO_DOC_NO
                WHERE SER_PAR_DSTIN_CD = 'SER'
            )
        )
        GROUP BY RO_TP    --수리총이윤율(합계)
        UNION ALL
        SELECT 41 AS COLUMN_SEQ , '维修毛利率（合计）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'P' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 42 AS COLUMN_SEQ, '单台数维修产值（合计）' AS COLUMN_NM
               ,ROUND(CASE WHEN COUNT(DISTINCT(VIN_NO))  > 0
                           THEN SUM(PAYM_AMT)/COUNT(DISTINCT(VIN_NO))
                           ELSE 0 END,2)  COLUMN_VAL
               ,RO_TP
               ,'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT CA.DLR_CD
                       ,CA.CALC_DOC_NO
                       ,CA.VIN_NO
                       ,CA.RO_TP
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = CA.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,(SELECT SUM(NVL(PAYM_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS PAYM_AMT
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                       ,TO_CHAR(CA.CALC_DT,'MM') AS MM
                FROM SE_0500T CA
				INNER JOIN SE_0300T RO
				ON CA.DLR_CD = RO.DLR_CD
				AND CA.RO_DOC_NO = RO.RO_DOC_NO
				WHERE CA.DLR_CD = '${sDlrCd}'
				AND CA.CALC_CANC_YN = 'N'
				AND CA.CALC_STAT_CD = '00'
				AND TO_CHAR(CA.CALC_DT,'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
				AND CA.SER_PAR_DSTIN_CD = 'SER'
				AND RO.RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO.RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(RO.DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP    --한대수수리생산액(합계) : 수리생산액/정비정산대수 (합계)
        UNION ALL
        SELECT 42 AS COLUMN_SEQ , '单台数维修产值（合计）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 43 AS COLUMN_SEQ, '单台次维修产值（合计）' AS COLUMN_NM
               ,ROUND(CASE WHEN COUNT(CALC_DOC_NO )  > 0
                           THEN SUM(PAYM_AMT)/COUNT(CALC_DOC_NO)
                           ELSE 0 END,2)  COLUMN_VAL
               ,RO_TP
               ,'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT CA.DLR_CD
                       ,CA.CALC_DOC_NO
                       ,CA.VIN_NO
                       ,CA.RO_TP
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = CA.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,(SELECT SUM(NVL(PAYM_AMT, 0)) FROM SE_0530T WHERE DLR_CD = CA.DLR_CD AND CALC_DOC_NO = CA.CALC_DOC_NO) AS PAYM_AMT
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                       ,TO_CHAR(CA.CALC_DT,'MM') AS MM
                FROM SE_0500T CA
				INNER JOIN SE_0300T RO
				ON CA.DLR_CD = RO.DLR_CD
				AND CA.RO_DOC_NO = RO.RO_DOC_NO
				WHERE CA.DLR_CD = '${sDlrCd}'
				AND CA.CALC_CANC_YN = 'N'
				AND CA.CALC_STAT_CD = '00'
				AND TO_CHAR(CA.CALC_DT,'YYYYMMDD') BETWEEN  '${sStartYyMmDd}' AND '${sEndYyMmDd}'
				AND CA.SER_PAR_DSTIN_CD = 'SER'
				AND RO.RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO.RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(RO.DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP    --한대차수리생산액(합계) : 수리생산액/정비정산대차 (합계)
        UNION ALL
        SELECT 43 AS COLUMN_SEQ , '单台次维修产值（合计）' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL
       
        /** 配件销售产值、配件销售成本、配件销售毛利、配件销售毛利率列隐藏 OK
        UNION ALL

        SELECT 44 AS COLUMN_SEQ , '配件销售产值' AS COLUMN_NM , SUM(NVL(PAYM_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'PAR'
        GROUP BY RO_TP    --부품판매생산액
        UNION ALL
        SELECT 44 AS COLUMN_SEQ , '配件销售产值' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 45 AS COLUMN_SEQ, '配件销售成本' AS COLUMN_NM, SUM(NVL(MOVING_AVG_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT C.MOVING_AVG_AMT, A.RO_TP
            FROM T1 A
            INNER JOIN PT_0522T B
            ON A.DLR_CD = B.DLR_CD
            AND A.RO_DOC_NO = B.PAR_SALE_ORD_NO
            INNER JOIN PT_0312T C
            ON B.DLR_CD = C.DLR_CD
            AND B.MVT_DOC_NO = C.MVT_DOC_NO
            AND B.MVT_DOC_LINE_NO = C.MVT_DOC_LINE_NO
            WHERE SER_PAR_DSTIN_CD = 'PAR'
        )
        GROUP BY RO_TP    --부품판매원가 : 정산완료한 부품정산서의 합계 부품원가금액
        UNION ALL
        SELECT 45 AS COLUMN_SEQ , '配件销售成本' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 46 AS COLUMN_SEQ, '配件销售毛利' AS COLUMN_NM, SUM(NVL(PAYM_AMT, 0)) - SUM(NVL(MOVING_AVG_AMT,0)) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT PAYM_AMT, 0 AS MOVING_AVG_AMT, RO_TP
            FROM T1
            WHERE SER_PAR_DSTIN_CD = 'PAR'

            UNION ALL

            SELECT 0 AS PAYM_AMT, C.MOVING_AVG_AMT, A.RO_TP
            FROM T1 A
            INNER JOIN PT_0522T B
            ON A.DLR_CD = B.DLR_CD
            AND A.RO_DOC_NO = B.PAR_SALE_ORD_NO
            INNER JOIN PT_0312T C
            ON B.DLR_CD = C.DLR_CD
            AND B.MVT_DOC_NO = C.MVT_DOC_NO
            AND B.MVT_DOC_LINE_NO = C.MVT_DOC_LINE_NO
            WHERE SER_PAR_DSTIN_CD = 'PAR'
        )
        GROUP BY RO_TP    --부품판매총이윤 : 부품판매생산액 - 부품판매원가
        UNION ALL
        SELECT 46 AS COLUMN_SEQ , '配件销售毛利' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 47 AS COLUMN_SEQ
               ,'配件销售毛利率' AS COLUMN_NM
               ,ROUND(((SUM(PAYM_AMT) - SUM(NVL(MOVING_AVG_AMT, 0)))/SUM(NULLIF(PAYM_AMT, 0))), 2) COLUMN_VAL
               ,RO_TP
               ,'P' AS VAL_TYPE
        FROM (
            SELECT PAYM_AMT, 0 AS MOVING_AVG_AMT, RO_TP
            FROM T1
            WHERE SER_PAR_DSTIN_CD = 'PAR'

            UNION ALL

            SELECT 0 AS PAYM_AMT, C.MOVING_AVG_AMT, A.RO_TP
            FROM T1 A
            INNER JOIN PT_0522T B
            ON A.DLR_CD = B.DLR_CD
            AND A.RO_DOC_NO = B.PAR_SALE_ORD_NO
            INNER JOIN PT_0312T C
            ON B.DLR_CD = C.DLR_CD
            AND B.MVT_DOC_NO = C.MVT_DOC_NO
            AND B.MVT_DOC_LINE_NO = C.MVT_DOC_LINE_NO
            WHERE SER_PAR_DSTIN_CD = 'PAR'
        )
        GROUP BY RO_TP    --부품판매총이윤율 : 부품판매총이윤/부품판매수입
        UNION ALL
        SELECT 47 AS COLUMN_SEQ , '配件销售毛利率' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'P' AS VAL_TYPE
        FROM DUAL
        **/
        UNION ALL

        SELECT 48 AS COLUMN_SEQ, '日均接车台数' AS COLUMN_NM, ROUND(COUNT(DISTINCT(VIN_NO))/LDATE, 2) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE FROM (
            SELECT * FROM (
                SELECT DLR_CD
                    ,DIAG_DOC_NO
                    ,VIN_NO
                    ,REG_USR_ID
                    ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = PRE.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                    ,TO_CHAR(PRE_CHK_DT,'MM') AS MM
                    ,'01' AS RO_TP
                    ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = PRE.DLR_CD AND USR_ID = PRE.REG_USR_ID) AS SA_NM
                    ,CASE WHEN TO_CHAR(PRE_CHK_DT,'MM') = TO_CHAR(SYSDATE, 'MM')
                          THEN TO_NUMBER(TO_CHAR(SYSDATE, 'DD'))
                          ELSE TO_NUMBER(TO_CHAR(LAST_DAY(PRE_CHK_DT), 'DD')) END AS LDATE
                FROM SE_0200T PRE
                WHERE DLR_CD = '${sDlrCd}'
                 AND DIAG_STAT_CD != 'C'
                 AND TO_CHAR(PRE_CHK_DT,'YYYY') = '${sStartDt}'
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}   --차종
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP, LDATE     --일평균사전점검대수(사전점검대수/시간구간의 일수)
        UNION ALL
        SELECT 48 AS COLUMN_SEQ , '日均接车台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 49 AS COLUMN_SEQ, '日均接车台次' AS COLUMN_NM, ROUND(COUNT(DIAG_DOC_NO)/LDATE, 2) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE FROM (
            SELECT * FROM (
                SELECT DLR_CD
                    ,DIAG_DOC_NO
                    ,VIN_NO
                    ,REG_USR_ID
                    ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = PRE.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                    ,TO_CHAR(PRE_CHK_DT,'MM') AS MM
                    ,'01' AS RO_TP
                    ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = PRE.DLR_CD AND USR_ID = PRE.REG_USR_ID) AS SA_NM
                    ,CASE WHEN TO_CHAR(PRE_CHK_DT,'MM') = TO_CHAR(SYSDATE, 'MM')
                          THEN TO_NUMBER(TO_CHAR(SYSDATE, 'DD'))
                          ELSE TO_NUMBER(TO_CHAR(LAST_DAY(PRE_CHK_DT), 'DD')) END AS LDATE
                FROM SE_0200T PRE
                WHERE DLR_CD = '${sDlrCd}'
                 AND DIAG_STAT_CD != 'C'
                 AND TO_CHAR(PRE_CHK_DT,'YYYY') = '${sStartDt}'
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}   --차종
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP, LDATE     --일평균사전점검대차(사전점검대차/시간구간의 일수)
        UNION ALL
        SELECT 49 AS COLUMN_SEQ , '日均接车台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 50 AS COLUMN_SEQ, '日均委托台数' AS COLUMN_NM, ROUND(COUNT(DISTINCT(VIN_NO))/LDATE, 2) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT DLR_CD
                       ,RO_DOC_NO
                       ,VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,CASE WHEN TO_CHAR(RO_DT,'MM') = TO_CHAR(SYSDATE, 'MM')
                             THEN TO_NUMBER(TO_CHAR(SYSDATE, 'DD'))
                             ELSE TO_NUMBER(TO_CHAR(LAST_DAY(RO_DT), 'DD')) END AS LDATE
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYY') = '${sStartDt}'
                AND RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP, LDATE     --일평균위탁대수(RO대수/시간구간의 일수)
        UNION ALL
        SELECT 50 AS COLUMN_SEQ , '日均委托台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 51 AS COLUMN_SEQ, '日均委托台次' AS COLUMN_NM, ROUND(COUNT(RO_DOC_NO)/LDATE, 2) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM (
            SELECT * FROM (
                SELECT DLR_CD
                       ,RO_DOC_NO
                       ,VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,CASE WHEN TO_CHAR(RO_DT,'MM') = TO_CHAR(SYSDATE, 'MM')
                             THEN TO_NUMBER(TO_CHAR(SYSDATE, 'DD'))
                             ELSE TO_NUMBER(TO_CHAR(LAST_DAY(RO_DT), 'DD')) END AS LDATE
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYY') = '${sStartDt}'
                AND RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP, LDATE     --일평균위탁대차(RO대차/시간구간의 일수)
        UNION ALL
        SELECT 51 AS COLUMN_SEQ , '日均委托台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 52 AS COLUMN_SEQ, '日均结算台数' AS COLUMN_NM, ROUND(COUNT(DISTINCT(VIN_NO))/LDATE, 2) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP, LDATE     --일평균정산대수(정비정산대수/시간구간의 일수)
        UNION ALL
        SELECT 52 AS COLUMN_SEQ , '日均结算台数' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS MM, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 53 AS COLUMN_SEQ, '日均结算台次' AS COLUMN_NM, ROUND(COUNT(CALC_DOC_NO)/LDATE, 2) AS COLUMN_VAL, RO_TP, 'A' AS VAL_TYPE
        FROM T1
        WHERE SER_PAR_DSTIN_CD = 'SER'
        GROUP BY RO_TP, LDATE     --일평균정산대차(정비정산대차/시간구간의 일수)
        UNION ALL
        SELECT 53 AS COLUMN_SEQ , '日均结算台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'A' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 54 AS COLUMN_SEQ, '服务接车时间' AS COLUMN_NM, ROUND(SUM(TERM) * 24 / COUNT(1), 2) AS COLUMN_VAL, RO_TP, 'TIME' AS TYPE
        FROM (
            SELECT *
            FROM (
                SELECT PRE.DLR_CD
                       ,PRE.DIAG_DOC_NO
                       ,PRE.VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = PRE.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,PRE.REG_USR_ID AS SA_ID
                       ,PRE_CHK_DT - REG_DT AS TERM
                       ,TO_CHAR(PRE_CHK_DT, 'MM') AS MM
                       ,'01' AS RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = PRE.DLR_CD AND USR_ID = PRE.REG_USR_ID) AS SA_NM
                FROM SE_0200T PRE
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(PRE_CHK_DT,'YYYY') = '${sStartDt}'
                AND DIAG_STAT_CD != 'C'
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     --사전점검시간(차량 딜러도착 인식시간에서 사전점검 확인시간까지의 시간산출(단위:시간))
        UNION ALL
        SELECT 54 AS COLUMN_SEQ , '服务接车时间' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'TIME' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 55 AS COLUMN_SEQ, '维修委托时间' AS COLUMN_NM, ROUND(SUM(TERM) * 24 / COUNT(1), 2) AS COLUMN_VAL, RO_TP, 'TIME' AS TYPE
        FROM (
            SELECT *
            FROM (
                SELECT RO.DLR_CD
                       ,RO.RO_DOC_NO
                       ,RO.VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO.RO_DT,'MM') AS MM
                       ,RO.RO_DT - PRE.PRE_CHK_DT AS TERM
                       ,RO.RO_TP
                       ,RO.DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                INNER JOIN SE_0200T PRE
                ON RO.DLR_CD = PRE.DLR_CD
                AND RO.DIAG_DOC_NO = PRE.DIAG_DOC_NO
                WHERE PRE.DIAG_STAT_CD != 'C'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     -- 정비위탁시간(사전점검 확인시간에서 RO 확인시간까지의 시간산출(단위:시간))
        UNION ALL
        SELECT 55 AS COLUMN_SEQ , '维修委托时间' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'TIME' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 56 AS COLUMN_SEQ, '服务交车时间' AS COLUMN_NM, ROUND(SUM(TERM1) * 24 / COUNT(1), 2) + ROUND(SUM(TERM2) * 24 / COUNT(1), 2) AS COLUMN_VAL, RO_TP, 'TIME' AS TYPE
        FROM (
            SELECT RO.DLR_CD
                   ,RO.RO_TP
                   ,RO.RO_DOC_NO
                   ,RO.VIN_NO
                   ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                   ,TO_CHAR(RO.RO_DT,'MM') AS MM
                   ,(CA.CALC_DT - RO.DL_CHK_DT) AS TERM1
                   ,((SELECT MAX(RCPT_DT) FROM SE_0560T WHERE DLR_CD = RCV.DLR_CD AND RCV_DOC_NO = RCV.RCV_DOC_NO AND ROWNUM = 1) - CA.CALC_DT) AS TERM2
            FROM SE_0300T RO
            INNER JOIN T1 CA
            ON RO.DLR_CD = CA.DLR_CD
            AND RO.RO_DOC_NO = CA.RO_DOC_NO
            INNER JOIN SE_0550T RCV
            ON RO.DLR_CD = RCV.DLR_CD
            AND RO.RO_DOC_NO = RCV.RO_DOC_NO
            WHERE CA.SER_PAR_DSTIN_CD = 'SER'
            AND RCV.RCV_STAT_CD = 'F'
        )
        GROUP BY RO_TP     -- 정비인도시간(인도체크 확인시간에서 수납등록 완료시간까지 시간 산출(단위:시간))
        UNION ALL
        SELECT 56 AS COLUMN_SEQ , '服务交车时间' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'TIME' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 57 AS COLUMN_SEQ, '    服务结算时间' AS COLUMN_NM, ROUND(SUM(TERM) * 24 / COUNT(1), 2) AS COLUMN_VAL, RO_TP, 'TIME' AS TYPE
        FROM (
            SELECT RO.DLR_CD
                   ,CA.RO_TP
                   ,CA.RO_DOC_NO
                   ,CA.VIN_NO
                   ,(CA.CALC_DT - RO.DL_CHK_DT) AS TERM
                   ,CA.MM
            FROM SE_0300T RO
            INNER JOIN T1 CA
            ON RO.DLR_CD = CA.DLR_CD
            AND RO.RO_DOC_NO = CA.RO_DOC_NO
            INNER JOIN SE_0550T RCV
            ON RO.DLR_CD = RCV.DLR_CD
            AND RO.RO_DOC_NO = RCV.RO_DOC_NO
            WHERE CA.SER_PAR_DSTIN_CD = 'SER'
            AND RCV.RCV_STAT_CD = 'F'
        )
        GROUP BY RO_TP     -- 정비정산시간(인도체크 확인시간에서 정산완료시간까지 시간 산출(단위:시간))
        UNION ALL
        SELECT 57 AS COLUMN_SEQ , '    服务结算时间' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'TIME' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 58 AS COLUMN_SEQ, '    服务收款时间' AS COLUMN_NM, ROUND(SUM(TERM) * 24 / COUNT(1), 2) AS COLUMN_VAL, RO_TP, 'TIME' AS TYPE
        FROM (
            SELECT CA.DLR_CD
                   ,CA.RO_TP
                   ,((SELECT MAX(RCPT_DT) FROM SE_0560T WHERE DLR_CD = RCV.DLR_CD AND RCV_DOC_NO = RCV.RCV_DOC_NO AND ROWNUM = 1) - CA.CALC_DT) AS TERM
                   ,CA.MM
            FROM SE_0300T RO
            INNER JOIN T1 CA
            ON RO.DLR_CD = CA.DLR_CD
            AND RO.RO_DOC_NO = CA.RO_DOC_NO
            INNER JOIN SE_0550T RCV
            ON RO.DLR_CD = RCV.DLR_CD
            AND RO.RO_DOC_NO = RCV.RO_DOC_NO
            WHERE CA.SER_PAR_DSTIN_CD = 'SER'
            AND RCV.RCV_STAT_CD = 'F'
        )
        GROUP BY RO_TP     -- 정비수납시간(정산완료시간에서 수납등록완료시간까지 시간 산출(단위:시간))
        UNION ALL
        SELECT 58 AS COLUMN_SEQ , '    服务收款时间' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'TIME' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 59 AS COLUMN_SEQ, '准时交车台次' AS COLUMN_NM, COUNT(RO_DOC_NO) AS COLUMN_VAL, RO_TP, 'CNT' AS TYPE
        FROM (
            SELECT * FROM (
                SELECT DLR_CD
                       ,RO_DOC_NO
                       ,VIN_NO
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYY') = '${sStartDt}'
                AND DL_CHK_DT <= EXPC_DL_DT
                AND RO_STAT_CD != '06'
                ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
                ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            )
            WHERE 1=1
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     -- on time인도대차(인도확인시간이 예상인도시간보다 작거나 같은 RO대차)
        UNION ALL
        SELECT 59 AS COLUMN_SEQ , '准时交车台次' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'CNT' AS VAL_TYPE
        FROM DUAL

        UNION ALL

        SELECT 60 AS COLUMN_SEQ, '准时交车率' AS COLUMN_NM, ROUND((COUNT(DL_RO_DOC_NO)/COUNT(RO_DOC_NO)), 2) AS COLUMN_VAL, RO_TP, 'P' AS TYPE
        FROM(
            SELECT *
            FROM (
                SELECT '' AS RO_DOC_NO
                       ,RO_DOC_NO AS DL_RO_DOC_NO
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYY') = '${sStartDt}'
                AND RO_STAT_CD != '06'
                AND DL_CHK_DT <= EXPC_DL_DT

                UNION ALL

                SELECT RO_DOC_NO
                       ,'' AS DL_RO_DOC_NO
                       ,TO_CHAR(RO_DT,'MM') AS MM
                       ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = RO.VIN_NO AND ROWNUM = 1) AS CARLINE_CD
                       ,RO_TP
                       ,DLR_RO_TP
                       ,(SELECT USR_NM FROM CM_0801T WHERE DLR_CD = RO.DLR_CD AND USR_ID = RO.REG_USR_ID) AS SA_NM
                FROM SE_0300T RO
                WHERE DLR_CD = '${sDlrCd}'
                AND TO_CHAR(RO_DT,'YYYY') = '${sStartDt}'
                AND RO_STAT_CD != '06'
            )
            WHERE 1=1
            ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
            ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
            ${IF(LEN(sDlrRoTp) <= 0,""," AND NVL(DLR_RO_TP, 'NONE')='" + sDlrRoTp + "'")}
            ${IF(LEN(sSaNm) <= 0,""," AND NVL(SA_NM, 'NONE')='" + sSaNm + "'")}
        )
        GROUP BY RO_TP     -- on time인도율(on time인도대차/RO대차)
        UNION ALL
        SELECT 60 AS COLUMN_SEQ , '准时交车率' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'P' AS VAL_TYPE
        FROM DUAL

        --UNION ALL

        --SELECT 61 AS COLUMN_SEQ, '一次修复率' AS COLUMN_NM, ROUND((COUNT(RO_DOC_NO)/NULLIF(COUNT(RWRK_RO), 0)), 2) AS COLUMN_VAL, RO_TP, 'P' AS VAL_TYPE
        --FROM (
        --    SELECT *
        --    FROM (
        --        SELECT RO_DOC_NO AS RWRK_RO
        --               ,'' AS RO_DOC_NO
        --               ,TO_CHAR(RO_DT,'MM') AS MM
        --               ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = VIN_NO AND ROWNUM = 1) AS CARLINE_CD
        --               ,RO_TP
        --        FROM SE_0300T
        --        WHERE DLR_CD = '${sDlrCd}'
        --        AND TO_CHAR(RO_DT,'YYYY') = '${sStartDt}'
        --        AND RO_STAT_CD != '06'
        --        AND RO_TP = '05'

        --        UNION ALL

        --        SELECT '' AS RWRK_RO
        --               ,RO_DOC_NO
        --               ,TO_CHAR(RO_DT,'MM') AS MM
        --               ,(SELECT CARLINE_CD FROM SA_0121T WHERE VIN_NO = VIN_NO AND ROWNUM = 1) AS CARLINE_CD
        --               ,RO_TP
        --        FROM SE_0300T
        --        WHERE DLR_CD = '${sDlrCd}'
        --        AND TO_CHAR(RO_DT,'YYYY') = '${sStartDt}'
        --        AND RO_STAT_CD != '06'
        --    )
        --    WHERE 1=1
        --    ${IF(LEN(sFosterTp) <= 0,""," AND NVL(RO_TP, 'NONE')='" + sFosterTp + "'")}
        --    ${IF(LEN(sCarlineCd) <= 0,""," AND NVL(CARLINE_CD, 'NONE')='" + sCarlineCd + "'")}
        --)
        --GROUP BY RO_TP     --1회회복율(1-리워크수리율)
        --UNION ALL
        --SELECT 61 AS COLUMN_SEQ , '一次修复率' AS COLUMN_NM , 0 AS COLUMN_VAL, '00' AS RO_TP, 'P' AS VAL_TYPE
        --FROM DUAL
    )
)PIVOT(
    SUM(COLUMN_VAL)
    FOR RO_TP IN(
        '01' AS "RO01"
        ,'02' AS "RO02"
        ,'03' AS "RO03"
        ,'04' AS "RO04"
        ,'05' AS "RO05"
    )
)
ORDER BY COLUMN_SEQ;
]]></Query>
</TableData>
</TableDataMap>
<Report class="com.fr.report.worksheet.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="0" T="0"/>
<FR/>
<HC/>
<FC/>
<UPFCR COLUMN="false" ROW="true"/>
</ReportPageAttr>
<ColumnPrivilegeControl/>
<RowPrivilegeControl/>
<RowHeight defaultValue="723900">
<![CDATA[1152000,1152000,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,722880,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[0,7920000,4320000,4320000,4320000,4320000,4320000,4320000,4320000,2743200,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0">
<PrivilegeControl/>
<Expand/>
</C>
<C c="1" r="0" s="0">
<O>
<![CDATA[数据名称]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="2" r="0" s="1">
<O>
<![CDATA[合计]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="3" r="0" s="1">
<O>
<![CDATA[平均]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="4" r="0" s="0">
<O>
<![CDATA[普通维修]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="5" r="0" s="0">
<O>
<![CDATA[保修索赔]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="6" r="0" s="0">
<O>
<![CDATA[保险理赔]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="7" r="0" s="0">
<O>
<![CDATA[返工维修]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="8" r="0" s="0">
<O>
<![CDATA[内部维修]]></O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="0" r="1">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="COLUMN_SEQ"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="1" r="1" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="COLUMN_NM"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[조건속성1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[row() % 2 = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.BackgroundHighlightAction">
<Scope val="1"/>
<Background name="ColorBackground" color="-1"/>
</HighlightAction>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="2" r="1" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=IF(OR(A2=41,A2=47,A2=60,A2=61), "", SUM(E2:I2))]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="3" r="1" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=ROUND(AVERAGE(E2:I2), 2)]]></Attributes>
</O>
<PrivilegeControl/>
<Expand/>
</C>
<C c="4" r="1" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="RO01"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="5" r="1" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="RO02"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="6" r="1" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="RO03"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="7" r="1" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="RO04"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
<C c="8" r="1" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="RO05"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<PrivilegeControl/>
<Expand dir="0"/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting>
<PaperSize width="40320000" height="72000000"/>
<Margin top="432000" left="432000" bottom="432000" right="432000"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
<PrivilegeControl/>
</Report>
<ReportParameterAttr>
<Attributes showWindow="true" delayPlaying="true" windowPosition="1" align="0" useParamsTemplate="false"/>
<PWTitle>
<![CDATA[매개변수]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="Microsoft YaHei UI" style="0" size="72" foreground="-1"/>
<Background name="ColorBackground" color="-11561760"/>
<Border>
<Top style="1" color="-3352093"/>
<Bottom style="1" color="-3352093"/>
<Left style="1" color="-3352093"/>
<Right style="1" color="-3352093"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="Microsoft YaHei UI" style="1" size="72" foreground="-1"/>
<Background name="ColorBackground" color="-11561760"/>
<Border>
<Top style="1" color="-3352093"/>
<Bottom style="1" color="-3352093"/>
<Left style="1" color="-3352093"/>
<Right style="1" color="-3352093"/>
</Border>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[#,##0.00]]></Format>
<FRFont name="Verdana" style="0" size="72" foreground="-10855846"/>
<Background name="ColorBackground" color="-986896"/>
<Border>
<Top style="5" color="-1"/>
<Bottom style="5" color="-1"/>
<Left style="5" color="-1"/>
<Right style="5" color="-1"/>
</Border>
</Style>
</StyleList>
<DesignerVersion DesignerVersion="JAA"/>
<PreviewType PreviewType="0"/>
<TemplateID/>
<TemplateIdAttMark class="com.fr.base.iofileattr.TemplateIdAttrMark">
<TemplateIdAttMark TemplateId="9c09890a-058e-49d4-a46f-c06c3932fb89"/>
</TemplateIdAttMark>
</WorkBook>
