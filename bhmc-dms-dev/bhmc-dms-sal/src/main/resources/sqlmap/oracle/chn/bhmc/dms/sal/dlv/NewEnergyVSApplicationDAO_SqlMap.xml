<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="chn.bhmc.dms.sal.dlv.service.dao.NewEnergyVSApplicationDAO">

	<!-- 이월판매취소 목록  -->
	<select id="selectNewEnergyVSApplicationByCondition" parameterType="NewEnergyVSApplicationSearchVO" resultType="NewEnergyVSApplicationVO">
         SELECT * FROM (
            SELECT ROWNUM AS RNUMS, T1.* FROM (
                SELECT 
                  A.DLR_CD,
        A.APPLICATION_NO,
        (SELECT  DLR_NM
                 FROM CM_0101T B
                 WHERE B.DLR_CD = A.DLR_CD)DLR_CD_STR,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'CRM024'    
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.MATH_DOC_TP)MATH_DOC_TP_STR,
        
        A.ADDR_DETL_CONT,
        A.OFFICE_NM,
        A.PERNAME,
        A.PERPHON,
        A.REG_NO,
        A.OFFICE_ADS,
        A.OWN_RGST_NM,
        A.OWN_RGST_TEL_NO,
        A.MODEL_CD,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'COM083'    
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.MODEL_CD)MODEL_CD_STR,
        A.VIN_NO,
        A.WEHICLE_USE, 
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = (
                   decode(A.CUST_TP,'01','COM077','02','COM076')
                   )   
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.WEHICLE_USE)WEHICLE_USE_STR,
        A.CAR_REG_NO,
        A.CAR_REG_COLOR,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'COM080'   
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.CAR_REG_COLOR)CAR_REG_COLOR_STR,
        A.MAKER_CD,
        A.DRIVE_PERMIT_NO,
        A.CAR_REG_CITY,
        A.SUNG_NM,
        A.CITY_NM,
        A.DIST_NM,
        A.DRIV_LICENSE_DT,
        TO_CHAR(A.DRIV_LICENSE_DT,'YYYY-MM-DD') DRIV_LICENSE_DT_STR,
        A.PURC_PAY_NO,
        A.INSUR_NO,
        A.CAR_REGI_NO,
        A.CAR_REGI_DT,
        TO_CHAR(A.CAR_REGI_DT,'YYYY-MM-DD') CAR_REGI_DT_STR,
        A.INVO_CO,
        A.INVO_NO,
        A.INVO_MN,
        A.INVO_DT,
        TO_CHAR(A.INVO_DT,'YYYY-MM-DD') INVO_DT_STR,
        A.ENCL,
        A.REMAREK,
        A.REASON,
        A.APPL_DT,
        A.STATUS_NO,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'COM079'    /*차량상태*/
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.STATUS_NO)STATUS_NO_STR,
        A.AUDIT_DT,
        A.CAR_BUY_AREA,
        --(select CMM_CD_NM from CM_0303t where CMM_GRP_CD='COM081'  and CMM_CD = CAR_BUY_AREA)CAR_BUY_AREA_STR,
       (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'CRM001'    /*차량상태*/
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.CAR_BUY_AREA)CAR_BUY_AREA_STR,
        A.HEAD_FILE_DOCID,
        A.NEW_ENTER_FILE_NO,
        A.CUST_TP,
        A.ADDRESS_CHARGING_CAR,
        A.HUMAN_PROPERTY_TYPE,
        (SELECT   B.CMM_CD_NM AS CMM_CD_NM
              FROM CM_0303T B
               LEFT OUTER JOIN CM_0304T C
                   ON B.CMM_GRP_CD = C.CMM_GRP_CD
                   AND B.CMM_CD = C.CMM_CD
                   AND C.LANG_CD = #{sLangCd}
                   WHERE B.CMM_GRP_CD = 'COM082'    /*차량상태*/
                   AND B.USE_YN = 'Y'
                   AND B.CMM_CD = A.HUMAN_PROPERTY_TYPE)HUMAN_PROPERTY_TYPE_STR,
         A.CUST_CD,
         TO_CHAR(A.APPL_DT,'YYYY-MM-DD') APPL_DT_STR,
         TO_CHAR(A.AUDIT_DT,'YYYY-MM-DD') AUDIT_DT_STR,
         B.CUST_NM,
         B.SSN_CRN_NO,
         B.HP_NO,
         B.PURC_MNG_NM,
         B.MATH_DOC_TP,
         A.EIGHT_FIELDS,                                                               <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015 -->
         FN_CMM_CD_NM('SAL015',A.EIGHT_FIELDS,#{sLangCd},'N') AS  EIGHT_FIELDZ,        <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015 -->
         A.WH_EIGHT_FIELDS,                                                            <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 是否八大领域 Y 是，N 否 -->
         FN_CMM_CD_NM('COM020',A.WH_EIGHT_FIELDS,#{sLangCd},'N') AS  WH_EIGHT_FIELDZ   <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 是否八大领域 Y 是，N 否 -->
                 FROM SA_0506T A LEFT OUTER JOIN CR_0101T B ON B.CUST_NO = A.CUST_CD
                 WHERE 1=1 
                 AND A.DLR_CD = #{sDlrCd}
                 <if test='sApplicationNo != null and sApplicationNo != ""'>
                  AND A.APPLICATION_NO = #{sApplicationNo}
                 </if>
                 <if test='custTp != null and custTp != ""'>
                  AND A.CUST_TP = #{custTp}
                 </if>
                 <if test='custNm != null and custNm != ""'>
                   AND (A.CUST_NM  LIKE  '%' || #{custNm} || '%' OR  A.PERNAME LIKE  '%' || #{custNm} || '%')
                 </if>
                 <if test='hpNo != null and hpNo != ""'>
                   AND (A.HP_NO LIKE '%' || #{hpNo} || '%' OR A.PERPHON LIKE '%' || #{hpNo} || '%')
                 </if>
                 <if test='applStartDt != null and applEndDt != null'>
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{applStartDt},'DD')
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{applEndDt},'DD')+1
                 </if>
                 <if test='applStartDt != null and applEndDt == null'>
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{applStartDt},'DD')
                 </if>
                 <if test='applStartDt == null and applEndDt != null'>
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{applEndDt},'DD')+1
                 </if>
                 <if test='invoStartDt != null and invoEndDt != null'>
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{invoStartDt},'DD')
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{invoEndDt},'DD')+1
                 </if>
                 <if test='invoStartDt != null and invoEndDt == null'>
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{invoStartDt},'DD')
                 </if>
                 <if test='invoStartDt == null and invoEndDt != null'>
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{invoEndDt},'DD')+1
                 </if>
                 <if test='statusNo != null and statusNo != ""'>
                   AND A.STATUS_NO = #{statusNo}
                 </if>
                 <if test='vinNo != null and vinNo != ""'>
                   AND A.VIN_NO LIKE '%'|| #{vinNo}||'%'   <!-- R19081401902 张伟丽老师反馈新能源车辆补贴申请界面车架号不支持车架号后六位查询，如车辆LBELFEKC9JY006508  = #{vinNo} 贾明 2019-8-15  -->
                 </if>
                 <!-- 退车业务查询判断 不查作废状态的数据-->
                 <if test='carReturn != null and carReturn != ""'>
                   AND A.STATUS_NO != #{carReturn}
                 </if>
        ORDER BY
        <choose>
            <when test='sort != null'>
                <foreach item="item" index="index" collection="sort" open="" separator="," close="">
                    <choose>
                        <when test='item.field == "applicationNo"'>A.APPLICATION_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "applDt"'>A.APPL_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "auditDt"'>A.AUDIT_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "modelCd"'>A.MODEL_CD <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "vinNo"'>A.VIN_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "carBuyArea"'>A.CAR_BUY_AREA <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "wehicleUse"'>A.WEHICLE_USE <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "carRegNo"'>A.CAR_REG_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "carRegCity"'>A.CAR_REG_CITY <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "custNm"'>A.CUST_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "hpNo"'>A.HP_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "officeNm"'>A.OFFICE_NM <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "pername"'>A.PERNAME <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "perphon"'>A.PERPHON <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "invoDt"'>A.INVO_DT <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <when test='item.field == "statusNo"'>A.STATUS_NO <choose><when test='item.dir == "asc"'>ASC</when><otherwise>DESC</otherwise></choose></when>
                        <otherwise>
                            A.APPLICATION_NO DESC NULLS LAST
                        </otherwise>
                    </choose>
                </foreach>
            </when>
            <otherwise>
                A.APPLICATION_NO DESC
            </otherwise>
        </choose>
             ) T1
            <where>
                <if test='firstIndex != -1 and lastIndex != -1'>
                    ROWNUM <![CDATA[<=]]> #{lastIndex}
                </if>
            </where>
        )
        <where>
            <if test='firstIndex != -1 and lastIndex != -1'>
                RNUMS > #{firstIndex}
            </if>
        </where>
	</select>

	<!-- 이월판매취소 목록 갯수  -->
	<select id="selectNewEnergyVSApplicationByConditionCnt" parameterType="NewEnergyVSApplicationSearchVO" resultType="int">
        SELECT COUNT(*) AS VALUE
          FROM SA_0506T A
         WHERE 1=1
         AND A.DLR_CD = #{sDlrCd}
         <if test='sApplicationNo != null and sApplicationNo != ""'>
                  AND A.APPLICATION_NO = #{sApplicationNo}
                 </if>
                 <if test='custTp != null and custTp != ""'>
                  AND A.CUST_TP = #{custTp}
                 </if>
                 <if test='custNm != null and custNm != ""'>
                   AND (A.CUST_NM  LIKE  '%' || #{custNm} || '%' OR  A.PERNAME LIKE  '%' || #{custNm} || '%')
                 </if>
                 <if test='hpNo != null and hpNo != ""'>
                   AND (A.HP_NO LIKE '%' || #{hpNo} || '%' OR A.PERPHON LIKE '%' || #{hpNo} || '%')
                 </if>
                 <if test='applStartDt != null and applEndDt != null'>
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{applStartDt},'DD')
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{applEndDt},'DD')+1
                 </if>
                 <if test='applStartDt != null and applEndDt == null'>
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{applStartDt},'DD')
                 </if>
                 <if test='applStartDt == null and applEndDt != null'>
                   AND TO_CHAR(A.APPL_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{applEndDt},'DD')+1
                 </if>
                 <if test='invoStartDt != null and invoEndDt != null'>
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{invoStartDt},'DD')
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{invoEndDt},'DD')+1
                 </if>
                 <if test='invoStartDt != null and invoEndDt == null'>
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[>=]]> TRUNC(#{invoStartDt},'DD')
                 </if>
                 <if test='invoStartDt == null and invoEndDt != null'>
                   AND TO_CHAR(A.INVO_DT,'YYYY-MM-DD') <![CDATA[<]]> TRUNC(#{invoEndDt},'DD')+1
                 </if>
                 <if test='statusNo != null and statusNo != ""'>
                   AND A.STATUS_NO = #{statusNo}
                 </if>
                 <if test='vinNo != null and vinNo != ""'>
                   AND A.VIN_NO LIKE '%'|| #{vinNo}||'%'   <!-- R19081401902 张伟丽老师反馈新能源车辆补贴申请界面车架号不支持车架号后六位查询，如车辆LBELFEKC9JY006508  = #{vinNo} 贾明 2019-8-15  -->
                 </if>
                 <!-- 退车业务查询判断 不查作废状态的数据-->
                 <if test='carReturn != null and carReturn != ""'>
                   AND A.STATUS_NO != #{carReturn}
                 </if>
    </select>

    
    <insert id="insertNewEnVSApplication" parameterType="NewEnergyVSApplicationVO">
        /* [chn.bhmc.dms.crm.cif.service.dao.CustomerInfoDAO.insertCustomer] */
        insert into SA_0506T (
        DLR_CD,
        APPLICATION_NO,
        CUST_NM,HP_NO,
        MATH_DOC_TP,
        SSN_CRN_NO,
        ADDR_DETL_CONT,
        OFFICE_NM,
        PERNAME,
        PERPHON,
        REG_NO,
        OFFICE_ADS,
        OWN_RGST_NM,
        OWN_RGST_TEL_NO,MODEL_CD,VIN_NO,WEHICLE_USE, CAR_REG_NO,CAR_REG_COLOR,
        MAKER_CD,
        DRIVE_PERMIT_NO,
        CAR_REG_CITY,
        SUNG_NM,
        CITY_NM,
        DIST_NM,
        DRIV_LICENSE_DT,
        PURC_PAY_NO,
        INSUR_NO,
        CAR_REGI_NO,
        CAR_REGI_DT,
        INVO_CO,
        INVO_NO,
        INVO_MN,
        INVO_DT,
        ENCL,
        REMAREK,
        REASON,
        APPL_DT,
        STATUS_NO,
        AUDIT_DT,
        CAR_BUY_AREA,
        HEAD_FILE_DOCID,
        NEW_ENTER_FILE_NO,
        CUST_TP,
        ADDRESS_CHARGING_CAR,
        HUMAN_PROPERTY_TYPE,
        CUST_CD,
        EIGHT_FIELDS,      <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19  八大领域，共同编码 SAL015 -->
        WH_EIGHT_FIELDS    <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19   是否八大领域 Y 是，N 否   -->
        )
 values( #{dlrCd}
         , #{applicationNo}
         , #{custNm}
         , #{hpNo}
         , #{mathDocTp}
         , #{ssnCrnNo}
         , #{addrDetlCont}
         , #{officeNm}
         , #{pername}
         , #{perphon}
         , #{regNo}
         , #{officeAds}
         , #{ownRgstNm}
         , #{ownRgstTelNo}
         , #{modelCd}
         , #{vinNo}
         , #{wehicleUse}
         , #{carRegNo}  
         , #{carRegColor}
         , #{makerCd}
         , #{drivePermitNo}
         , #{carRegCity}
         , #{sungNm}
         , #{cityNm}
         , #{distNm}
         , #{drivLicenseDt}
         , #{purcPayNo}
         , #{insurNo}
         , #{carRegiNo}
         , #{carRegiDt}
         , #{invoCo}
         , #{invoNo}
         , #{invoMn}
         , #{invoDt}
         , #{encl}
         , #{remarek}
         , #{reason}
         , #{applDt}
         , #{statusNo}
         , #{auditDt}
         ,#{carBuyArea}
         ,#{headFileDocId}
         ,#{newEnterFileNo}
         ,#{custTp}
         ,#{addressChargingCar}
         ,#{humanPropertyType}
         ,#{custCd}
         ,#{eightFields}    <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015 -->
         ,#{whEightFields}  <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 是否八大领域 Y 是，N 否   -->
         
         )
    </insert>
    
    <insert id="insertNewEnVSApplicationIs" parameterType="NewEnergyVSApplicationVO">
        /* [chn.bhmc.dms.crm.cif.service.dao.CustomerInfoDAO.insertCustomer] */
       <!--  insert into SA_0506IS (
        DLR_CD,
        APPLICATION_NO,
        CUST_NM,HP_NO,
        MATH_DOC_TP,
        SSN_CRN_NO,
        ADDR_DETL_CONT,
        OFFICE_NM,
        PERNAME,
        PERPHON,
        REG_NO,
        OFFICE_ADS,
        OWN_RGST_NM,
        OWN_RGST_TEL_NO,MODEL_CD,VIN_NO,WEHICLE_USE, CAR_REG_NO,CAR_REG_COLOR,
        MAKER_CD,
        DRIVE_PERMIT_NO,
        CAR_REG_CITY,
        DRIV_LICENSE_DT,
        PURC_PAY_NO,
        INSUR_NO,
        CAR_REGI_NO,
        CAR_REGI_DT,
        INVO_CO,
        INVO_NO,
        INVO_MN,
        INVO_DT,
        ENCL,
        REMAREK,
        REASON,
        APPL_DT,
        STATUS_NO,
        AUDIT_DT,
        CAR_BUY_AREA,
        HEAD_FILE_DOCID,
        NEW_ENTER_FILE_NO,
        CUST_TP,
        ADDRESS_CHARGING_CAR,
        HUMAN_PROPERTY_TYPE,
        IFRESULT,
        CUST_CD)
 values( #{dlrCd}
         , #{applicationNo}
         , #{custNm}
         , #{hpNo}
         , #{mathDocTp}
         , #{ssnCrnNo}
         , #{addrDetlCont}
         , #{officeNm}
         , #{pername}
         , #{perphon}
         , #{regNo}
         , #{officeAds}
         , #{ownRgstNm}
         , #{ownRgstTelNo}
         , #{modelCd}
         , #{vinNo}
         , #{wehicleUse}
         , #{carRegNo}  
         , #{carRegColor}
         , #{makerCd}
         , #{drivePermitNo}
         , #{carRegCity}
         , #{drivLicenseDt}
         , #{purcPayNo}
         , #{insurNo}
         , #{carRegiNo}
         , #{carRegiDt}
         , #{invoCo}
         , #{invoNo}
         , #{invoMn}
         , #{invoDt}
         , #{encl}
         , #{remarek}
         , #{reason}
         , #{applDt}
         , #{statusNo}
         , #{auditDt}
         ,#{carBuyArea}
         ,#{headFileDocId}
         ,#{newEnterFileNo}
         ,#{custTp}
         ,#{addressChargingCar}
         ,#{humanPropertyType}
         ,'N'
         ,#{custCd}
         ) -->
         
         {CALL SP_SAL_DMS_SA_0506IS(
              #{dlrCd, mode=IN, jdbcType=VARCHAR}
            , #{applicationNo, mode=IN, jdbcType=VARCHAR}
        )}
    </insert>
    
    <update id="updateNewEnVSApplication" parameterType="NewEnergyVSApplicationVO">
    /* [chn.bhmc.dms.sal.cnt.service.dao.ContractMntDAO.updateContract] */
        UPDATE SA_0506T    --계약헤더
           SET 
        CUST_NM = #{custNm},
        HP_NO = #{hpNo},
        MATH_DOC_TP = #{mathDocTp},
        SSN_CRN_NO = #{ssnCrnNo},
        ADDR_DETL_CONT = #{addrDetlCont},
        OFFICE_NM = #{officeNm},
        PERNAME = #{pername},
        PERPHON = #{perphon},
        REG_NO = #{regNo},
        OFFICE_ADS = #{officeAds},
        OWN_RGST_NM = #{ownRgstNm},
        OWN_RGST_TEL_NO = #{ownRgstTelNo},
        MODEL_CD = #{modelCd},
        VIN_NO = #{vinNo},
        WEHICLE_USE = #{wehicleUse},
        CAR_REG_NO = #{carRegNo},
        CAR_REG_COLOR = #{carRegColor},
        MAKER_CD = #{makerCd},
        DRIVE_PERMIT_NO = #{drivePermitNo},
        CAR_REG_CITY = #{carRegCity},
        SUNG_NM = #{sungNm},
        CITY_NM = #{cityNm},
        DIST_NM = #{distNm},
        DRIV_LICENSE_DT = #{drivLicenseDt},
        PURC_PAY_NO = #{purcPayNo},
        INSUR_NO = #{insurNo},
        CAR_REGI_NO = #{carRegiNo},
        CAR_REGI_DT = #{carRegiDt},
        INVO_CO = #{invoCo},
        INVO_NO = #{invoNo},
        INVO_MN = #{invoMn},
        INVO_DT = #{invoDt},
        ENCL = #{encl},
        REMAREK = #{remarek},
        REASON = #{reason},
        APPL_DT = #{applDt},
        STATUS_NO = #{statusNo},
        AUDIT_DT = #{auditDt},
        CAR_BUY_AREA = #{carBuyArea},
        HEAD_FILE_DOCID = #{headFileDocId},
        NEW_ENTER_FILE_NO = #{newEnterFileNo},
        CUST_TP = #{custTp},
        ADDRESS_CHARGING_CAR = #{addressChargingCar},
        HUMAN_PROPERTY_TYPE = #{humanPropertyType},
        CUST_CD = #{custCd},
        EIGHT_FIELDS = #{eightFields},      <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 八大领域，共同编码 SAL015 -->
        WH_EIGHT_FIELDS = #{whEightFields}  <!-- CSR 111新能源申请流程增加八大领域功能选择项 贾明 2020-6-19 是否八大领域 Y 是，N 否 -->
         WHERE 1 = 1
           AND DLR_CD              = #{dlrCd}                     --딜러코드
           AND APPLICATION_NO         = #{applicationNo}                --계약번호
    </update>
    
    <update id="updateNewEnVSApplicationIs" parameterType="NewEnergyVSApplicationVO">
    /* [chn.bhmc.dms.sal.cnt.service.dao.ContractMntDAO.updateContract] */
        UPDATE SA_0506IS    --계약헤더
           SET 
        CUST_NM = #{custNm},
        HP_NO = #{hpNo},
        MATH_DOC_TP = #{mathDocTp},
        SSN_CRN_NO = #{ssnCrnNo},
        ADDR_DETL_CONT = #{addrDetlCont},
        OFFICE_NM = #{officeNm},
        PERNAME = #{pername},
        PERPHON = #{perphon},
        REG_NO = #{regNo},
        OFFICE_ADS = #{officeAds},
        OWN_RGST_NM = #{ownRgstNm},
        OWN_RGST_TEL_NO = #{ownRgstTelNo},
        MODEL_CD = #{modelCd},
        VIN_NO = #{vinNo},
        WEHICLE_USE = #{wehicleUse},
        CAR_REG_NO = #{carRegNo},
        CAR_REG_COLOR = #{carRegColor},
        MAKER_CD = #{makerCd},
        DRIVE_PERMIT_NO = #{drivePermitNo},
        CAR_REG_CITY = #{carRegCity},
        DRIV_LICENSE_DT = #{drivLicenseDt},
        PURC_PAY_NO = #{purcPayNo},
        INSUR_NO = #{insurNo},
        CAR_REGI_NO = #{carRegiNo},
        CAR_REGI_DT = #{carRegiDt},
        INVO_CO = #{invoCo},
        INVO_NO = #{invoNo},
        INVO_MN = #{invoMn},
        INVO_DT = #{invoDt},
        ENCL = #{encl},
        REMAREK = #{remarek},
        REASON = #{reason},
        APPL_DT = #{applDt},
        STATUS_NO = #{statusNo},
        AUDIT_DT = #{auditDt},
        CAR_BUY_AREA = #{carBuyArea},
        HEAD_FILE_DOCID = #{headFileDocId},
        NEW_ENTER_FILE_NO = #{newEnterFileNo},
        CUST_TP = #{custTp},
        ADDRESS_CHARGING_CAR = #{addressChargingCar},
        HUMAN_PROPERTY_TYPE = #{humanPropertyType},
        IFRESULT = 'N',
        IF_REG_DT = #{ifRegDt},
        CUST_CD = #{custCd}
         WHERE 1 = 1
           AND DLR_CD              = #{dlrCd}                     --딜러코드
           AND APPLICATION_NO         = #{applicationNo}                --계약번호 
           
        <!-- MERGE INTO SA_0506IS A
              USING(
        SELECT 
        #{applicationNo} AS APPLICATION_NO, 
        #{custNm} AS CUST_NM, 
        #{hpNo} AS HP_NO,
        #{mathDocTp} AS MATH_DOC_TP,
        #{ssnCrnNo} AS SSN_CRN_NO ,
        #{addrDetlCont} AS ADDR_DETL_CONT,
        #{officeNm} AS OFFICE_NM,
        #{pername} AS PERNAME,
        #{perphon} AS PERPHON,
        #{regNo} AS REG_NO,
        #{officeAds} AS OFFICE_ADS,
        #{ownRgstNm} AS OWN_RGST_NM,
        #{ownRgstTelNo} AS OWN_RGST_TEL_NO,
        #{modelCd} AS MODEL_CD,
        #{vinNo} AS VIN_NO,
        #{wehicleUse} AS WEHICLE_USE,
        #{carRegNo}  AS CAR_REG_NO,
        #{carRegColor} AS CAR_REG_COLOR,
        #{makerCd} AS MAKER_CD,
        #{drivePermitNo} AS DRIVE_PERMIT_NO,
        #{carRegCity} AS CAR_REG_CITY,
        #{drivLicenseDt} AS DRIV_LICENSE_DT,
        #{purcPayNo} AS PURC_PAY_NO,
        #{insurNo} AS INSUR_NO,
        #{carRegiNo} AS CAR_REGI_NO,
        #{carRegiDt} AS CAR_REGI_DT,
        #{invoCo} AS INVO_CO,
        #{invoNo} AS INVO_NO,
        #{invoMn} AS INVO_MN,
        #{invoDt} AS INVO_DT,
        #{encl} AS ENCL,
        #{remarek} AS REMAREK,
        #{reason} AS REASON,
        #{applDt} AS APPL_DT,
        #{statusNo} AS STATUS_NO,
        #{auditDt} AS AUDIT_DT,
        #{carBuyArea} AS CAR_BUY_AREA,
        #{headFileDocId} AS HEAD_FILE_DOCID,
        #{newEnterFileNo} AS NEW_ENTER_FILE_NO,
        #{custTp} AS CUST_TP,
        #{addressChargingCar} AS ADDRESS_CHARGING_CAR,
        #{humanPropertyType} AS HUMAN_PROPERTY_TYPE,
        #{ifRegDt} AS IF_REG_DT,
        #{custCd} AS CUST_CD,
        #{dlrCd} AS DLR_CD
                      FROM DUAL) B
                    ON(A.APPLICATION_NO  = B.APPLICATION_NO)
      WHEN MATCHED THEN
          UPDATE SET 
      A.DLR_CD = B.DLR_CD,
      A.CUST_NM = B.CUST_NM,
      A.HP_NO = B.HP_NO,
      A.MATH_DOC_TP = B.MATH_DOC_TP,
      A.SSN_CRN_NO = B.SSN_CRN_NO,
      A.ADDR_DETL_CONT = B.ADDR_DETL_CONT,
      A.OFFICE_NM = B.OFFICE_NM,
      A.PERNAME = B.PERNAME,
      A.PERPHON = B.PERPHON,
      A.REG_NO = B.REG_NO,
      A.OFFICE_ADS = B.OFFICE_ADS,
      A.OWN_RGST_NM = B.OWN_RGST_NM,
      A.OWN_RGST_TEL_NO = B.OWN_RGST_TEL_NO,
      A.MODEL_CD = B.MODEL_CD,
      A.VIN_NO =B.VIN_NO,
      A.WEHICLE_USE = B.WEHICLE_USE,
      A.CAR_REG_NO = B.CAR_REG_NO,
      A.CAR_REG_COLOR = B.CAR_REG_COLOR,
      A.MAKER_CD = B.MAKER_CD,
      A.DRIVE_PERMIT_NO =B.DRIVE_PERMIT_NO,
      A.CAR_REG_CITY = B.CAR_REG_CITY,
      A.DRIV_LICENSE_DT = B.DRIV_LICENSE_DT,
      A.PURC_PAY_NO = B.PURC_PAY_NO,
      A.INSUR_NO = B.INSUR_NO,
      A.CAR_REGI_NO = B.CAR_REGI_NO,
      A.CAR_REGI_DT = B.CAR_REGI_DT,
      A.INVO_CO = B.INVO_CO,
      A.INVO_NO = B.INVO_NO,
      A.INVO_MN = B.INVO_MN,
      A.INVO_DT = B.INVO_DT,
      A.ENCL = B.ENCL,
      A.REMAREK = B.REMAREK,
      A.REASON = B.REASON,
      A.APPL_DT = B.APPL_DT,
      A.STATUS_NO = B.STATUS_NO,
      A.AUDIT_DT = B.AUDIT_DT,
      A.CAR_BUY_AREA = B.CAR_BUY_AREA,
      A.HEAD_FILE_DOCID = B.HEAD_FILE_DOCID,
      A.NEW_ENTER_FILE_NO = B.NEW_ENTER_FILE_NO,
      A.CUST_TP = B.CUST_TP,
      A.ADDRESS_CHARGING_CAR = B.ADDRESS_CHARGING_CAR,
      A.HUMAN_PROPERTY_TYPE =B.HUMAN_PROPERTY_TYPE,
      A.CUST_CD = B.CUST_CD,
      A.IF_REG_DT = B.IF_REG_DT,
      A.IFRESULT = 'N'
          
      WHEN NOT MATCHED THEN
          INSERT(
       A.DLR_CD,
       A.APPLICATION_NO,
       A.CUST_NM,
       A.HP_NO,
       A.MATH_DOC_TP,
       A.SSN_CRN_NO,
       A.ADDR_DETL_CONT,
       A.OFFICE_NM,
       A.PERNAME,
       A.PERPHON,
       A.REG_NO,
       A.OFFICE_ADS,
       A.OWN_RGST_NM,
       A.OWN_RGST_TEL_NO,
       A.MODEL_CD,
       A.VIN_NO,
       A.WEHICLE_USE,
       A.CAR_REG_NO,
       A.CAR_REG_COLOR,
       A.MAKER_CD,
       A.DRIVE_PERMIT_NO,
       A.CAR_REG_CITY,
       A.DRIV_LICENSE_DT,
       A.PURC_PAY_NO,
       A.INSUR_NO,
       A.CAR_REGI_NO,
       A.CAR_REGI_DT,
       A.INVO_CO,
       A.INVO_NO,
       A.INVO_MN,
       A.INVO_DT,
       A.ENCL,
       A.REMAREK,
       A.REASON,
       A.APPL_DT,
       A.STATUS_NO,
       A.AUDIT_DT,
       A.CAR_BUY_AREA,
       A.HEAD_FILE_DOCID,
       A.NEW_ENTER_FILE_NO,
       A.CUST_TP,
       A.ADDRESS_CHARGING_CAR,
       A.HUMAN_PROPERTY_TYPE,
       A.IFRESULT,
       A.CUST_CD
                )VALUES(
       B.DLR_CD,
       B.APPLICATION_NO,
       B.CUST_NM,
       B.HP_NO,
       B.MATH_DOC_TP,
       B.SSN_CRN_NO,
       B.ADDR_DETL_CONT,
       B.OFFICE_NM,
       B.PERNAME,
       B.PERPHON,
       B.REG_NO,
       B.OFFICE_ADS,
       B.OWN_RGST_NM,
       B.OWN_RGST_TEL_NO,
       B.MODEL_CD,
       B.VIN_NO,
       B.WEHICLE_USE, 
       B.CAR_REG_NO,
       B.CAR_REG_COLOR,
       B.MAKER_CD,
       B.DRIVE_PERMIT_NO,
       B.CAR_REG_CITY,
       B.DRIV_LICENSE_DT,
       B.PURC_PAY_NO,
       B.INSUR_NO,
       B.CAR_REGI_NO,
       B.CAR_REGI_DT,
       B.INVO_CO,
       B.INVO_NO,
       B.INVO_MN,
       B.INVO_DT,
       B.ENCL,
       B.REMAREK,
       B.REASON,
       B.APPL_DT,
       B.STATUS_NO,
       B.AUDIT_DT,
       B.CAR_BUY_AREA,
       B.HEAD_FILE_DOCID,
       B.NEW_ENTER_FILE_NO,
       B.CUST_TP,
       B.ADDRESS_CHARGING_CAR,
       B.HUMAN_PROPERTY_TYPE,
       'N',
       B.CUST_CD
                ) -->
    </update>
    
    <select id="checkVinNoIfContainCnt" parameterType="NewEnergyVSApplicationSearchVO" resultType="int">
         SELECT count(*) AS VALUE
   FROM ( SELECT 1,
                 CASE WHEN A.BLOCK_SALE_ADV_NO IS NOT NULL THEN 'Y' WHEN NVL(A.OWN_STAT_CD,
                 'O') = 'A' THEN 'Y' WHEN NVL(A.DAMAGE_CD,
                 '02') = '01' THEN 'Y' /* ELSE NVL(A.BLOCK_YN, 'N')  */ ELSE 'N' END AS BLOCK_YN,
                 VIN_NO
            FROM SA_0121T A
           WHERE A.NCAR_DSTIN_CD = 'N' -- 신차
             AND A.ORD_DLR_CD = #{sDlrCd} -- 딜러코드
             AND A.CAR_STAT_CD = '60'
             AND A.VIN_NO = #{vinNo} 
             <if test='custNm != null and custNm != ""'>
                   AND (A.ZFNEWSUB = 'X')
                 </if>
             ) X1 
             
  WHERE 1 = 1
    </select>
    
    
    <select id="checkVinNoContInT" parameterType="NewEnergyVSApplicationSearchVO" resultType="int">
           SELECT COUNT(*) FROM SA_0506T A 
           WHERE 1=1
             AND A.VIN_NO = #{vinNo} 
             AND A.STATUS_NO != '05'
             AND A.DLR_CD = #{sDlrCd}
    </select>
    
    
    <select id="checkAppNoContInIS" parameterType="NewEnergyVSApplicationSearchVO" resultType="int">
           SELECT COUNT(*) FROM SA_0506IS A 
           WHERE 1=1
             AND A.APPLICATION_NO = #{sApplicationNo} 
             AND A.DLR_CD = #{sDlrCd}
    </select>
    
    
    
    <insert id="insertNewEnVSApplicationOutOfStock" parameterType="NewEnerVSApplicationOutOfStockVO">
        MERGE INTO SA_0509IS A
              USING(
        SELECT 
        #{vinNo} AS VIN_NO, 
        #{licensePlate} AS LICENSE_PLATE, 
        #{vehTypeName} AS VEH_TYPE_NAME,
        #{saleTime} AS SALE_TIME,
        #{saleArea} AS SALE_AREA ,
        #{ownerName} AS OWNER_NAME,
        #{idnum} AS IDNUM,
        #{epname} AS EPNAME,
        #{epaddress} AS EPADDRESS,
        #{epcode} AS EPCODE,
        #{ifresult} AS IFRESULT,
        #{ifRegDt} AS IF_REG_DT
                      FROM DUAL) B
                    ON(A.VIN_NO  = B.VIN_NO)
      WHEN MATCHED THEN
          UPDATE SET 
      A.LICENSE_PLATE = B.LICENSE_PLATE,
      A.VEH_TYPE_NAME = B.VEH_TYPE_NAME,
      A.SALE_TIME = B.SALE_TIME,
      A.SALE_AREA = B.SALE_AREA,
      A.OWNER_NAME = B.OWNER_NAME,
      A.IDNUM = B.IDNUM,
      A.EPNAME = B.EPNAME,
      A.EPADDRESS = B.EPADDRESS,
      A.IFRESULT = B.IFRESULT,
      A.IF_REG_DT = B.IF_REG_DT
          
      WHEN NOT MATCHED THEN
          INSERT(
       A.VIN_NO,
       A.LICENSE_PLATE,
       A.VEH_TYPE_NAME,
       A.SALE_TIME,
       A.SALE_AREA,
       A.OWNER_NAME,
       A.IDNUM,
       A.EPNAME,
       A.EPADDRESS,
       A.EPCODE,
       A.IFRESULT,
       A.IF_REG_DT
                )VALUES(
       B.VIN_NO,
       B.LICENSE_PLATE,
       B.VEH_TYPE_NAME,
       B.SALE_TIME,
       B.SALE_AREA,
       B.OWNER_NAME,
       B.IDNUM,
       B.EPNAME,
       B.EPADDRESS,
       B.EPCODE,
       B.IFRESULT,
       B.IF_REG_DT
       )
    </insert>
    
    <select id="selectSaleDateFrCarMain" parameterType="NewEnergyVSApplicationSearchVO" resultType="String">
           SELECT TO_CHAR(A.CUST_SALE_DT,'YYYY-MM-DD') CUST_SALE_DT_STR
           FROM SA_0121T A 
           WHERE 1=1
           AND A.VIN_NO = #{vinNo}
    </select>
    
    <insert id="insertNewEnVSApplicationVehicleNetworkingSystem" parameterType="NewEnVSApplicationVehicleNetworkingSystemVo">
         MERGE INTO SA_0506_1IS A USING ( SELECT #{vinNo} AS VIN_NO,
                                         #{sellTime} AS SELL_TIME,
                                         #{sellCity} AS SELL_CITY,
                                         #{dealerName} AS DEALER_NAME,
                                         #{dlrCd} AS DLR_CD,
                                         #{carLicense} AS CAR_LICENSE,
                                         #{carLicenseColor} AS CAR_LICENSE_COLOR,
                                         #{saveCity} AS SAVE_CITY,
                                         #{saveAddress} AS SAVE_ADDRESS,
                                         #{driveLicenseno} AS DRIVE_LICENSENO,
                                         #{licenseRegisterDate} AS LICENSE_REGISTER_DATE,
                                         #{licenseGrantDate} AS LICENSE_GRANT_DATE,
                                         #{customerType} AS CUSTOMER_TYPE,
                                         #{privateOwnerName} AS PRIVATE_OWNER_NAME,
                                         #{privateOwnerIdentity} AS PRIVATE_OWNER_IDENTITY,
                                         #{privateOwnerPhone} AS PRIVATE_OWNER_PHONE,
                                         #{privateOwnerAddress} AS PRIVATE_OWNER_ADDRESS,
                                         #{unitName} AS UNIT_NAME,
                                         #{vehUseFor} AS VEH_USE_FOR,
                                         #{organizationCode} AS ORGANIZATION_CODE,
                                         #{legalPersonName} AS LEGAL_PERSON_NAME,
                                         #{legalPersonPhone} AS LEGAL_PERSON_PHONE,
                                         #{legalPersonAddress} AS LEGAL_PERSON_ADDRESS,
                                         #{ifresult} AS IFRESULT,
                                         #{ifRegDt} AS IF_REG_DT
                                    FROM DUAL) B ON (A.VIN_NO = B.VIN_NO) WHEN MATCHED THEN UPDATE SET A.SELL_TIME = B.SELL_TIME,
                                         A.SELL_CITY = B.SELL_CITY,
                                         A.DEALER_NAME = B.DEALER_NAME,
                                         A.DLR_CD = B.DLR_CD,
                                         A.CAR_LICENSE = B.CAR_LICENSE,
                                         A.CAR_LICENSE_COLOR = B.CAR_LICENSE_COLOR,
                                         A.SAVE_CITY = B.SAVE_CITY,
                                         A.SAVE_ADDRESS = B.SAVE_ADDRESS,
                                         A.DRIVE_LICENSENO = B.DRIVE_LICENSENO,
                                         A.LICENSE_REGISTER_DATE = B.LICENSE_REGISTER_DATE,
                                         A.LICENSE_GRANT_DATE = B.LICENSE_GRANT_DATE,
                                         A.CUSTOMER_TYPE = B.CUSTOMER_TYPE,
                                         A.PRIVATE_OWNER_NAME = B.PRIVATE_OWNER_NAME,
                                         A.PRIVATE_OWNER_IDENTITY = B.PRIVATE_OWNER_IDENTITY,
                                         A.PRIVATE_OWNER_PHONE = B.PRIVATE_OWNER_PHONE,
                                         A.PRIVATE_OWNER_ADDRESS = B.PRIVATE_OWNER_ADDRESS,
                                         A.UNIT_NAME = B.UNIT_NAME,
                                         A.VEH_USE_FOR = B.VEH_USE_FOR,
                                         A.ORGANIZATION_CODE = B.ORGANIZATION_CODE,
                                         A.LEGAL_PERSON_NAME = B.LEGAL_PERSON_NAME,
                                         A.LEGAL_PERSON_PHONE = B.LEGAL_PERSON_PHONE,
                                         A.LEGAL_PERSON_ADDRESS = B.LEGAL_PERSON_ADDRESS,
                                         A.IFRESULT = B.IFRESULT,
                                         A.IF_REG_DT = B.IF_REG_DT WHEN NOT MATCHED THEN INSERT (A.VIN_NO,
                                                                                                 A.SELL_TIME,
                                                                                                 A.SELL_CITY,
                                                                                                 A.DEALER_NAME,
                                                                                                 A.DLR_CD,
                                                                                                 A.CAR_LICENSE,
                                                                                                 A.CAR_LICENSE_COLOR,
                                                                                                 A.SAVE_CITY,
                                                                                                 A.SAVE_ADDRESS,
                                                                                                 A.DRIVE_LICENSENO,
                                                                                                 A.LICENSE_REGISTER_DATE,
                                                                                                 A.LICENSE_GRANT_DATE,
                                                                                                 A.CUSTOMER_TYPE,
                                                                                                 A.PRIVATE_OWNER_NAME,
                                                                                                 A.PRIVATE_OWNER_IDENTITY,
                                                                                                 A.PRIVATE_OWNER_PHONE,
                                                                                                 A.PRIVATE_OWNER_ADDRESS,
                                                                                                 A.UNIT_NAME,
                                                                                                 A.VEH_USE_FOR,
                                                                                                 A.ORGANIZATION_CODE,
                                                                                                 A.LEGAL_PERSON_NAME,
                                                                                                 A.LEGAL_PERSON_PHONE,
                                                                                                 A.LEGAL_PERSON_ADDRESS,
                                                                                                 A.IFRESULT,
                                                                                                 A.IF_REG_DT)
                                                                                          VALUES(B.VIN_NO,
                                                                                                 B.SELL_TIME,
                                                                                                 B.SELL_CITY,
                                                                                                 B.DEALER_NAME,
                                                                                                 B.DLR_CD,
                                                                                                 B.CAR_LICENSE,
                                                                                                 B.CAR_LICENSE_COLOR,
                                                                                                 B.SAVE_CITY,
                                                                                                 B.SAVE_ADDRESS,
                                                                                                 B.DRIVE_LICENSENO,
                                                                                                 B.LICENSE_REGISTER_DATE,
                                                                                                 B.LICENSE_GRANT_DATE,
                                                                                                 B.CUSTOMER_TYPE,
                                                                                                 B.PRIVATE_OWNER_NAME,
                                                                                                 B.PRIVATE_OWNER_IDENTITY,
                                                                                                 B.PRIVATE_OWNER_PHONE,
                                                                                                 B.PRIVATE_OWNER_ADDRESS,
                                                                                                 B.UNIT_NAME,
                                                                                                 B.VEH_USE_FOR,
                                                                                                 B.ORGANIZATION_CODE,
                                                                                                 B.LEGAL_PERSON_NAME,
                                                                                                 B.LEGAL_PERSON_PHONE,
                                                                                                 B.LEGAL_PERSON_ADDRESS,
                                                                                                 B.IFRESULT,
                                                                                                 B.IF_REG_DT);
    </insert>
    <update id="callIfMergeCommit" parameterType="String" statementType="CALLABLE" >
         {call SP_IF_MERGE_COMMIT()}
    </update>
</mapper>